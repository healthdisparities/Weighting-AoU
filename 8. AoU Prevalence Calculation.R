library(weights)
library(readr)
library(tidyverse)

# Blindness and Vision Loss
icd10_vector <- c("H25", "H25.0", "H25.1", "H25.2", "H25.8", "H25.9",
                  "H26", "H26.0", "H26.1", "H26.2", "H26.3", "H26.4", "H26.8", "H26.9",
                  "H27", "H27.0", "H27.1", "H27.8", "H27.9",
                  "H28", "H28.0", "H28.1", "H28.2", "H28.3", "H28.8",
                  "H31", "H31.0", "H31.1", "H31.2", "H31.3", "H31.4", "H31.8", "H31.9",
                  "H32",
                  "H33", "H33.0", "H33.1", "H33.2", "H33.3", "H33.4", "H33.5", "H33.8", "H33.9",
                  "H34", "H34.0", "H34.1", "H34.2", "H34.3", "H34.8", "H34.9",
                  "H35", "H35.0", "H35.1", "H35.2", "H35.3", "H35.4", "H35.5", "H35.6", "H35.8", "H35.9",
                  "H36",
                  "H40", "H40.0", "H40.1", "H40.2", "H40.3", "H40.4", "H40.5", "H40.6", "H40.8", "H40.9",
                  "H42", "H42.0", "H42.1", "H42.2", "H42.3", "H42.4", "H42.5", "H42.6", "H42.7", "H42.8",
                  "H46",
                  "H47", "H47.0", "H47.1", "H47.2", "H47.3", "H47.4", "H47.5", "H47.6", "H47.8", "H47.9",
                  "H48",
                  "H49", "H49.0", "H49.1", "H49.2", "H49.3", "H49.4", "H49.8", "H49.9",
                  "H50", "H50.0", "H50.1", "H50.2", "H50.3", "H50.4", "H50.5", "H50.6", "H50.8", "H50.9",
                  "H51", "H51.0", "H51.1", "H51.2", "H51.3", "H51.4", "H51.8", "H51.9",
                  "H52", "H52.0", "H52.1", "H52.2", "H52.3", "H52.4", "H52.5", "H52.6", "H52.7", "H52.8", "H52.9",
                  "H53", "H53.0", "H53.1", "H53.2", "H53.3", "H53.4", "H53.5", "H53.6", "H53.8", "H53.9",
                  "H54", "H54.0", "H54.1", "H54.2", "H54.3", "H54.4", "H54.5", "H54.6", "H54.7", "H54.8", "H54.9")
icd10_vector <- paste(icd10_vector,collapse="|")
icd9_vector <- c("360.8", "360.81", "360.82", "360.83", "360.84", "360.89",
                 "361", "361.0", "361.1", "361.2", "361.3", "361.4", "361.5", "361.6", "361.7", "361.8", "361.9",
                 "362", "362.0", "362.01", "362.02", "362.03", "362.04", "362.05", "362.06", "362.07", "362.08", "362.09",
                 "362.1", "362.10", "362.11", "362.12", "362.13", "362.14", "362.15", "362.16", "362.17", "362.18", "362.19",
                 "362.2", "362.20", "362.21", "362.22", "362.23", "362.24", "362.25", "362.26", "362.27", "362.28", "362.29",
                 "362.3", "362.30", "362.31", "362.32", "362.33", "362.34", "362.35", "362.36", "362.37", "362.38", "362.39",
                 "362.4", "362.40", "362.41", "362.42", "362.43", "362.44", "362.45", "362.46", "362.47", "362.48", "362.49",
                 "362.5", "362.50", "362.51", "362.52", "362.53", "362.54", "362.55", "362.56", "362.57", "362.58", "362.59",
                 "362.6", "362.60", "362.61", "362.62", "362.63", "362.64", "362.65", "362.66", "362.67", "362.68", "362.69",
                 "362.7", "362.70", "362.71", "362.72", "362.73", "362.74", "362.75", "362.76", "362.77", "362.78", "362.79",
                 "362.8", "362.80", "362.81", "362.82", "362.83", "362.84", "362.85", "362.86", "362.87", "362.88", "362.89",
                 "362.9", "362.90", "362.91", "362.92", "362.93", "362.94", "362.95", "362.96", "362.97", "362.98", "362.99",
                 "363", "363.0", "363.1", "363.2", "363.3", "363.4", "363.5", "363.6", "363.7", "363.8", "363.9",
                 "365", "365.0", "365.1", "365.2", "365.3", "365.4", "365.5", "365.6", "365.7", "365.8", "365.9",
                 "366", "366.0", "366.1", "366.2", "366.3", "366.4", "366.5", "366.6", "366.7", "366.8", "366.9",
                 "367", "367.0", "367.1", "367.2", "367.3", "367.4", "367.5", "367.6", "367.7", "367.8", "367.9",
                 "368", "368.0", "368.1", "368.2", "368.3", "368.4", "368.5", "368.6", "368.7", "368.8", "368.9",
                 "369", "369.0", "369.1", "369.2", "369.3", "369.4", "369.5", "369.6", "369.7", "369.8", "369.9",
                 "377", "377.0", "377.1", "377.2", "377.3", "377.4", "377.5", "377.6", "377.7", "377.8", "377.9",
                 "378", "378.0", "378.1", "378.2", "378.3", "378.4", "378.5", "378.6", "378.7", "378.8", "378.9")
icd9_vector <- paste(icd9_vector,collapse="|")
# Look for ICD 10 prevalence
full_icd10_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD10CM" | full_icd_df$source_vocabulary == "ICD10PCS",]
individuals <- c()
matching_rows <- full_icd10_df[grep(icd10_vector,full_icd10_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(individuals)
# Look for ICD 9 prevalence
full_icd9_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD9CM",]
matching_rows <- full_icd9_df[grep(icd9_vector,full_icd9_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(unique(individuals))
individuals <- unique(individuals)
paste0("Cohort specific cases: ",nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,]))
paste0("Cohort specific prev: ",(nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,])/nrow(final_aou_data_complete))*100 )
aou_individuals <- final_aou_data_complete[final_aou_data_complete$id %in% individuals,]$id
weighted_case_df <- data.frame(id = aou_individuals,case=1)
weighted_control_df <- data.frame(id = setdiff(final_aou_data_complete$id,aou_individuals),case=0)
weighted_prev_df <- rbind(weighted_case_df,weighted_control_df)
weighted_prev_df <- left_join(weighted_prev_df,aou_weights_int_propensity,by="id")
paste0("Weighted cohort specific cases: ",sum(weighted_prev_df[weighted_prev_df$case==1,]$weight))
paste0("Weighted cohort specific prevalence: ",(sum(weighted_prev_df[weighted_prev_df$case==1,]$weight)/sum(weighted_prev_df$weight))*100)

# Cardiovascular diseases
icd10_vector <- c(
  "B33.2", "B33.20", "B33.21", "B33.22", "B33.23", "B33.24",
  "D86.85",
  "G45", "G45.0", "G45.1", "G45.2", "G45.3", "G45.4", "G45.8", 
  "G46", "G46.0", "G46.1", "G46.2", "G46.3", "G46.8",
  "I01", "I01.0", "I01.1", "I01.2", "I01.3", "I01.4", "I01.5", "I01.6", "I01.7", "I01.8", "I01.9",
  "I02.0",
  "I05", "I05.0", "I05.1", "I05.2", "I05.3", "I05.4", "I05.5", "I05.6", "I05.7", "I05.8", "I05.9",
  "I06", "I06.0", "I06.1", "I06.2", "I06.3", "I06.4", "I06.5", "I06.6", "I06.7", "I06.8", "I06.9",
  "I07", "I07.0", "I07.1", "I07.2", "I07.3", "I07.4", "I07.5", "I07.6", "I07.7", "I07.8", "I07.9",
  "I08", "I08.0", "I08.1", "I08.2", "I08.3", "I08.4", "I08.5", "I08.6", "I08.7", "I08.8", "I08.9",
  "I09", "I09.0", "I09.1", "I09.2", "I09.3", "I09.4", "I09.5", "I09.6", "I09.7", "I09.8", "I09.9",
  "I11", "I11.0", "I11.1", "I11.2", "I11.9",
  "I20", "I20.0", "I20.1", "I20.8", "I20.9",
  "I21", "I21.0", "I21.1", "I21.2", "I21.3", "I21.4", "I21.6", "I21.9",
  "I22", "I22.0", "I22.1", "I22.8", "I22.9",
  "I23", "I23.0", "I23.1", "I23.2", "I23.3", "I23.4", "I23.5", "I23.6", "I23.7", "I23.8", "I23.9",
  "I24", "I24.0", "I24.1", "I24.8", "I24.9",
  "I25", "I25.0", "I25.1", "I25.2", "I25.3", "I25.4", "I25.5", "I25.6", "I25.7", "I25.8", "I25.9",
  "I26", "I26.0", "I26.1", "I26.2", "I26.3", "I26.4", "I26.5", "I26.6", "I26.7", "I26.8", "I26.9",
  "I27", "I27.0", "I27.1", "I27.2", "I27.3", "I27.4", "I27.5", "I27.6", "I27.7", "I27.8", "I27.9",
  "I28", "I28.0", "I28.1", "I28.2", "I28.3", "I28.8", "I28.9",
  "I30", "I30.0", "I30.1", "I30.8", "I30.9",
  "I31", "I31.0", "I31.1", "I31.8",
  "I32", "I32.0", "I32.1", "I32.2", "I32.3", "I32.4", "I32.5", "I32.6", "I32.7", "I32.8", "I32.9",
  "I33", "I33.0", "I33.1", "I33.2", "I33.3", "I33.4", "I33.5", "I33.6", "I33.7", "I33.8", "I33.9",
  "I34", "I34.0", "I34.1", "I34.2", "I34.3", "I34.4", "I34.5", "I34.6", "I34.7", "I34.8", "I34.9",
  "I35", "I35.0", "I35.1", "I35.2", "I35.3", "I35.4", "I35.5", "I35.6", "I35.7", "I35.8", "I35.9",
  "I36", "I36.0", "I36.1", "I36.2", "I36.3", "I36.4", "I36.5", "I36.6", "I36.7", "I36.8", "I36.9",
  "I37", "I37.0", "I37.1", "I37.2", "I37.3", "I37.4", "I37.5", "I37.6", "I37.7", "I37.8", "I37.9",
  "I38", "I39", "I39.0", "I39.1", "I39.2", "I39.3", "I39.4", "I39.5", "I39.6", "I39.7", "I39.8", "I39.9",
  "I40", "I40.0", "I40.1", "I40.2", "I40.3", "I40.4", "I40.5", "I40.6", "I40.7", "I40.8", "I40.9",
  "I41", "I41.0", "I41.1", "I41.2", "I41.3", "I41.4", "I41.5", "I41.6", "I41.7", "I41.8", "I41.9",
  "I42", "I42.0", "I42.1", "I42.2", "I42.3", "I42.4", "I42.5", "I42.6", "I42.7", "I42.8",
  "I43", "I43.0", "I43.1", "I43.2", "I43.3", "I43.4", "I43.5", "I43.6", "I43.7", "I43.8",
  "I44", "I44.0", "I44.1", "I44.2", "I44.3", "I44.4", "I44.5", "I44.6", "I44.7", "I44.8",
  "I45", "I45.0", "I45.1", "I45.2", "I45.3", "I45.4", "I45.5", "I45.6", "I45.7", "I45.8",
  "I46", "I46.0", "I46.1", "I46.2", "I46.3", "I46.4", "I46.5", "I46.6", "I46.7", "I46.8", "I46.9",
  "I47", "I47.0", "I47.1", "I47.2", "I47.9",
  "I48", "I48.0", "I48.1", "I48.2", "I48.3", "I48.4", "I48.9",
  "I49", "I49.0", "I49.1", "I49.2", "I49.3", "I49.4", "I49.5", "I49.6", "I49.7", "I49.8", "I49.9",
  "I50", "I50.0", "I50.1", "I50.2", "I50.3", "I50.4", "I50.5", "I50.6", "I50.7", "I50.8", "I50.9",
  "I51", "I51.0", "I51.1", "I51.2", "I51.3", "I51.4", "I51.5", "I51.6", "I51.7", "I51.8", "I51.9",
  "I52", "I52.0", "I52.1", "I52.2", "I52.3", "I52.4", "I52.5", "I52.6", "I52.7", "I52.8", "I52.9",
  "I60", "I60.0", "I60.1", "I60.2", "I60.3", "I60.4", "I60.5", "I60.6", "I60.7", "I60.8", "I60.9",
  "I61", "I61.0", "I61.1", "I61.2", "I61.3", "I61.4", "I61.5", "I61.6", "I61.7", "I61.8", "I61.9",
  "I62", "I62.0", "I62.1", "I62.2", "I62.3", "I62.4", "I62.5", "I62.6", "I62.7", "I62.8", "I62.9",
  "I63", "I63.0", "I63.1", "I63.2", "I63.3", "I63.4", "I63.5", "I63.6", "I63.7", "I63.8", "I63.9",
  "I64", "I64.0", "I64.1",
  "I65", "I65.0", "I65.1", "I65.2", "I65.3", "I65.4", "I65.5", "I65.6", "I65.7", "I65.8", "I65.9",
  "I66", "I66.0", "I66.1", "I66.2", "I66.3", "I66.4", "I66.5", "I66.6", "I66.7", "I66.8", "I66.9",
  "I67", "I67.0", "I67.1", "I67.2", "I67.3", "I67.4", "I67.5", "I67.6", "I67.7", "I67.8", "I67.9",
  "I68", "I68.0", "I68.1", "I68.2", "I68.3", "I68.4", "I68.5", "I68.6", "I68.7", "I68.8", "I68.9",
  "I69", "I69.0", "I69.1", "I69.2", "I69.3",
  "I70", "I70.0", "I70.1", "I70.2", "I70.3", "I70.4", "I70.5", "I70.6", "I70.7", "I70.8", "I70.9",
  "I71", "I71.0", "I71.1", "I71.2", "I71.3", "I71.4", "I71.5", "I71.6", "I71.7", "I71.8", "I71.9",
  "I72", "I72.0", "I72.1", "I72.2", "I72.3", "I72.4", "I72.5", "I72.6", "I72.7", "I72.8", "I72.9",
  "I73", "I73.0", "I73.1", "I73.2", "I73.3", "I73.4", "I73.5", "I73.6", "I73.7", "I73.8", "I73.9",
  "I77", "I77.0", "I77.1", "I77.2", "I77.3", "I77.4", "I77.5", "I77.6", "I77.7", "I77.8", "I77.9",
  "I78", "I78.0", "I78.1", "I78.2", "I78.3", "I78.4", "I78.5", "I78.6", "I78.7", "I78.8", "I78.9",
  "I79", "I79.0", "I79.1", "I79.2", "I79.3", "I79.4", "I79.5", "I79.6", "I79.7", "I79.8", "I79.9",
  "I80", "I80.0", "I80.1", "I80.2", "I80.3", "I80.4", "I80.5", "I80.6", "I80.7", "I80.8", "I80.9",
  "I81", "I81.0", "I81.1", "I81.2", "I81.3", "I81.4", "I81.5", "I81.6", "I81.7", "I81.8", "I81.9",
  "I82", "I82.0", "I82.1", "I82.2", "I82.3", "I82.4", "I82.5", "I82.6", "I82.7", "I82.8", "I82.9",
  "I83", "I83.0", "I83.1", "I83.2", "I83.3", "I83.4", "I83.5", "I83.6", "I83.7", "I83.8", "I83.9",
  "I86", "I86.0", "I86.1", "I86.2", "I86.3", "I86.4", "I86.5", "I86.6", "I86.7", "I86.8", "I86.9",
  "I89", "I89.0", "I89.1", "I89.2", "I89.3", "I89.4", "I89.5", "I89.6", "I89.7", "I89.8", "I89.9",
  "I95", "I95.0", "I95.1",
  "I98", "I98.8", "I98.9",
  "K75.1",
  "R00", "R00.0", "R00.1", "R00.2",
  "R01", "R01.0", "R01.1", "R01.2",
  "Z01.3", "Z01.30", "Z01.31",
  "Z03.4", "Z03.40", "Z03.41", "Z03.42", "Z03.43", "Z03.44", "Z03.45", "Z03.46", "Z03.47", "Z03.48", "Z03.49", "Z03.5", "Z03.50", "Z03.51", "Z03.52", "Z03.53", "Z03.54", "Z03.55", "Z03.56", "Z03.57", "Z03.58", "Z03.59",
  "Z13.6",
  "Z52.7",
  "Z82.3", "Z82.30", "Z82.31", "Z82.32", "Z82.33", "Z82.34", "Z82.35", "Z82.36", "Z82.37", "Z82.38", "Z82.39", "Z82.4", "Z82.40", "Z82.41", "Z82.42", "Z82.43", "Z82.44", "Z82.45", "Z82.46", "Z82.47", "Z82.48", "Z82.49",
  "Z86.7", "Z86.70", "Z86.71", "Z86.72", "Z86.73", "Z86.74", "Z86.75", "Z86.76", "Z86.77", "Z86.78", "Z86.79",
  "Z94.1", "Z94.10", "Z94.11", "Z94.12", "Z94.13", "Z94.2", "Z94.20", "Z94.21", "Z94.22", "Z94.23", "Z94.3", "Z94.30", "Z94.31", "Z94.32", "Z94.33",
  "Z95", "Z95.0", "Z95.1", "Z95.2", "Z95.3", "Z95.4", "Z95.5", "Z95.6", "Z95.7", "Z95.8", "Z95.9"
)
icd10_vector <- paste(icd10_vector,collapse="|")
icd9_vector <- c(
  "036.4",
  "391", "391.0", "391.1", "391.2", "391.3", "391.8", "391.9",
  "392.0",
  "393", "394", "394.0", "394.1", "394.2", "394.9", "395", "395.0", "395.1", "395.2", "395.9", "396", "396.0", "396.1", "396.2", "396.3", "396.8", "396.9", "397", "397.0", "397.1", "397.9", "398", "398.0", "398.1", "398.2", "398.8", "398.9",
  "402", "402.0", "402.1", "402.9",
  "410", "410.0", "410.1", "410.2", "410.3", "410.4", "410.5", "410.6", "410.7", "410.8", "410.9",
  "411", "411.0", "411.1", "411.8",
  "412",
  "413", "413.0", "413.1", "413.9",
  "414", "414.0", "414.1", "414.2", "414.3", "414.4", "414.8", "414.9",
  "416.0",
  "417", "417.0", "417.1", "417.8", "417.9",
  "420", "420.0", "420.1", "420.9",
  "421", "421.0", "421.1", "421.9",
  "422", "422.0", "422.9",
  "423", "423.0",
  "423.1", "423.2", "423.3", "423.8", "423.9",
  "424.0", "424.1", "424.2", "424.3", "424.8",
  "425.0", "425.1", "425.2", "425.3", "425.5", "425.7", "425.8",
  "427.0", "427.1", "427.2", "427.3", "427.6", "427.8",
  "429.0",
  "430", "431", "432", "432.0", "432.1", "432.9", "433", "433.0", "433.1", "433.2", "433.3", "433.8", "433.9", "434", "434.0", "434.1", "434.9", "435", "435.0", "435.1", "435.2", "435.3", "435.8", "435.9",
  "437.0", "437.1", "437.2", "437.5", "437.6", "437.7", "437.8",
  "440.2", "440.4",
  "441", "441.0", "441.1", "441.2", "441.3", "441.4", "441.5", "441.6", "441.7", "441.9",
  "442", "442.0", "442.1", "442.2", "442.3", "442.8", "442.9",
  "443", "443.0", "443.1", "443.2", "443.8", "443.9",
  "447", "447.0", "447.1", "447.2", "447.3", "447.4", "447.5", "447.6", "447.8", "447.9",
  "448", "448.0", "448.1", "448.2", "448.8", "448.9",
  "449", "450", "451", "451.0", "451.1", "451.2", "451.8", "451.9",
  "452", "453", "453.0", "453.1", "453.2", "453.3", "453.4", "453.8", "453.9",
  "454", "454.0", "454.1", "454.2", "454.8", "454.9",
  "456", "456.0", "456.1", "456.2", "456.3",
  "457", "457.0", "457.1", "457.8", "457.9",
  "459", "459.0", "459.1", "459.2", "459.3",
  "074.2", "074.21", "074.22", "074.23",
  "785", "785.0", "785.1", "785.2", "785.3",
  "V12.5", "V12.50", "V12.51", "V12.52", "V12.53", "V12.54", "V12.55", "V12.56", "V12.57", "V12.58", "V12.59",
  "V15.1",
  "V17.1", "V17.10", "V17.11", "V17.12", "V17.2", "V17.20", "V17.21", "V17.22", "V17.23", "V17.24", "V17.25", "V17.26", "V17.27", "V17.28", "V17.29", "V17.3", "V17.30", "V17.31", "V17.32", "V17.33", "V17.34", "V17.35", "V17.36", "V17.37", "V17.38", "V17.39", "V17.4", "V17.40", "V17.41", "V17.42", "V17.43", "V17.44", "V17.45", "V17.46", "V17.47", "V17.48", "V17.49",
  "V42.1", "V42.2",
  "V43.2", "V43.20", "V43.21", "V43.22", "V43.23", "V43.24", "V43.25", "V43.26", "V43.27", "V43.28", "V43.29", "V43.3", "V43.30", "V43.31", "V43.32", "V43.33", "V43.34", "V43.35", "V43.36", "V43.37", "V43.38", "V43.39", "V43.4", "V43.40", "V43.41", "V43.42", "V43.43", "V43.44", "V43.45", "V43.46", "V43.47", "V43.48", "V43.49", "V43.5", "V43.50", "V43.51", "V43.52", "V43.53", "V43.54", "V43.55", "V43.56", "V43.57", "V43.58", "V43.59",
  "V45.0", "V45.00", "V45.01", "V45.02", "V45.03", "V45.04", "V45.05", "V45.06", "V45.07", "V45.08", "V45.09",
  "V45.81", "V45.82",
  "V47.2",
  "V58.61", "V58.63", "V58.66", "V58.73",
  "V81", "V81.0", "V81.1", "V81.2"
)
icd9_vector <- paste(icd9_vector,collapse="|")
# Look for ICD 10 prevalence
full_icd10_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD10CM" | full_icd_df$source_vocabulary == "ICD10PCS",]
individuals <- c()
matching_rows <- full_icd10_df[grep(icd10_vector,full_icd10_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(individuals)
# Look for ICD 9 prevalence
full_icd9_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD9CM",]
matching_rows <- full_icd9_df[grep(icd9_vector,full_icd9_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(unique(individuals))
individuals <- unique(individuals)
paste0("Cohort specific cases: ",nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,]))
paste0("Cohort specific prev: ",(nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,])/nrow(final_aou_data_complete))*100 )
aou_individuals <- final_aou_data_complete[final_aou_data_complete$id %in% individuals,]$id
weighted_case_df <- data.frame(id = aou_individuals,case=1)
weighted_control_df <- data.frame(id = setdiff(final_aou_data_complete$id,aou_individuals),case=0)
weighted_prev_df <- rbind(weighted_case_df,weighted_control_df)
weighted_prev_df <- left_join(weighted_prev_df,aou_weights_int_propensity,by="id")
paste0("Weighted cohort specific cases: ",sum(weighted_prev_df[weighted_prev_df$case==1,]$weight))
paste0("Weighted cohort specific prevalence: ",(sum(weighted_prev_df[weighted_prev_df$case==1,]$weight)/sum(weighted_prev_df$weight))*100)

# Chronic Kidney Disease
icd10_vector <- c(
  "D63.1", "E10.2", "E11.2", "I12", "I12.0", "I12.9", "I13", "I13.0", "I13.1", "I13.2", "I13.8", "I13.9", 
  "N02", "N02.0", "N02.1", "N02.2", "N02.3", "N02.4", "N02.5", "N02.6", "N02.7", "N02.8", "N03", "N03.0", 
  "N03.1", "N03.2", "N03.3", "N03.4", "N03.5", "N03.6", "N03.7", "N03.8", "N04", "N04.0", "N04.1", "N04.2", 
  "N04.3", "N04.4", "N04.5", "N04.6", "N04.7", "N04.8", "N05", "N05.0", "N05.1", "N05.2", "N05.3", "N05.4", 
  "N05.5", "N05.6", "N05.7", "N05.8", "N06", "N06.0", "N06.1", "N06.2", "N06.3", "N06.4", "N06.5", "N06.6", 
  "N06.7", "N06.8", "N07", "N07.0", "N07.1", "N07.2", "N07.3", "N07.4", "N07.5", "N07.6", "N07.7", "N07.8", 
  "N08", "N08.0", "N08.1", "N08.2", "N08.3", "N08.4", "N08.5", "N08.6", "N08.7", "N08.8", "N15.0", 
  "N18", "N18.0", "N18.1", "N18.2", "N18.3", "N18.4", "N18.5", "N18.6", "N18.7", "N18.8", "N18.9", 
  "Q61", "Q61.0", "Q61.1", "Q61.2", "Q61.3", "Q61.4", "Q61.5", "Q61.8", "Q61.9", "Q62", "Q62.0", "Q62.1", 
  "Q62.2", "Q62.3", "Q62.4", "Q62.5", "Q62.6", "Q62.7", "Q62.8", "E08.2", "E08.20", "E08.21", "E08.22", 
  "E08.23", "E08.24", "E08.25", "E08.26", "E08.27", "E08.28", "E08.29", "E10.2", "E10.20", "E10.21", "E10.22", 
  "E10.23", "E10.24", "E10.25", "E10.26", "E10.27", "E10.28", "E10.29", "E11.2", "E11.20", "E11.21", "E11.22", 
  "E11.23", "E11.24", "E11.25", "E11.26", "E11.27", "E11.28", "E11.29", "E12.2", "E13.2", "E13.20", "E13.21", 
  "E13.22", "E13.23", "E13.24", "E13.25", "E13.26", "E13.27", "E13.28", "E13.29", "E14.2", "N17", "N17.0", 
  "N17.1", "N17.2", "N17.8", "N17.9", "N18", "N18.0", "N18.1", "N18.2", "N18.3", "N18.4", "N18.5", "N18.6", 
  "N18.7", "N18.8", "N18.9", "N19", "Q60", "Q60.0", "Q60.1", "Q60.2", "Q60.3", "Q61", "Q61.0", "Q61.1", 
  "Q61.2", "Q61.3", "Q61.4", "Q61.5", "Q61.8", "Q61.9", "Q62", "Q62.0", "Q62.1", "Q62.2", "Q62.3", "Q62.4", 
  "Q62.5", "Q62.6", "Q62.7", "Q62.8", "Q63", "Q63.0", "Q63.1", "Q63.2", "Q63.8", "Q63.9", "Q64", "Q64.2", 
  "Q64.3", "Q64.4", "Q64.5", "Q64.8", "Q64.9", "Z49", "Z49.0", "Z49.01", "Z49.02", "Z49.1", "Z49.11", "Z49.12", 
  "Z49.2", "Z49.31", "Z49.32", "Z52.4", "Z99.2"
)
icd10_vector <- paste(icd10_vector,collapse="|")
icd9_vector <- c(
  "403", "403.0", "403.1", "403.9", "404", "404.0", "404.1", "404.2", "404.3", "404.9",
  "581", "581.0", "581.1", "581.2", "581.3", "581.81", "581.89", "581.9", "582", "582.0", "582.1", "582.2", "582.4", "582.81", "582.89", "582.9",
  "583", "583.0", "583.1", "583.2", "583.4", "583.6", "583.7", "583.81", "583.89", "583.9",
  "585", "585.0", "585.1", "585.2", "585.3", "585.4", "585.5", "585.6", "585.9",
  "589", "589.0", "589.1", "589.9",
  "753", "753.0", "753.1", "753.2", "753.3",
  "249.4", "249.40", "249.41",
  "250.4", "250.40", "250.41", "250.42", "250.43", "250.49",
  "285.21",
  "403", "403.0", "403.1", "403.9", "404", "404.0", "404.1", "404.2", "404.3", "404.9", "404.91", "404.92", "404.93",
  "581", "581.0", "581.1", "581.2", "581.3", "581.81", "581.89", "581.9", "582", "582.0", "582.1", "582.2", "582.4", "582.81", "582.89", "582.9",
  "583", "583.0", "583.1", "583.2", "583.4", "583.6", "583.7", "583.81", "583.89", "583.9",
  "584", "584.5", "584.6", "584.7", "584.8", "584.9",
  "585", "585.0", "585.1", "585.2", "585.3", "585.4", "585.5", "585.6", "585.9",
  "586",
  "587",
  "753.0", "753.00", "753.01", "753.02", "753.1", "753.10", "753.11", "753.12", "753.13", "753.14", "753.15", "753.16", "753.17", "753.2", "753.20", "753.21", "753.22", "753.23", "753.3", "753.4",
  "753.6", "753.60", "753.61", "753.62", "753.63", "753.64", "753.65", "753.69", "753.7", "753.8", "753.9",
  "V13.03", "V13.04", "V13.05", "V13.06", "V13.07", "V13.08", "V13.09",
  "V18.6", "V18.69",
  "V42.0",
  "V45.1", "V45.10", "V45.11", "V45.12",
  "V45.73",
  "V56", "V56.0", "V56.1", "V56.2", "V56.3", "V56.31", "V56.32", "V56.8",
  "V59.4",
  "V81.5", "V81.6"
)
icd9_vector <- paste(icd9_vector,collapse="|")
# Look for ICD 10 prevalence
full_icd10_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD10CM" | full_icd_df$source_vocabulary == "ICD10PCS",]
individuals <- c()
matching_rows <- full_icd10_df[grep(icd10_vector,full_icd10_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(individuals)
# Look for ICD 9 prevalence
full_icd9_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD9CM",]
matching_rows <- full_icd9_df[grep(icd9_vector,full_icd9_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(unique(individuals))
individuals <- unique(individuals)
paste0("Cohort specific cases: ",nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,]))
paste0("Cohort specific prev: ",(nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,])/nrow(final_aou_data_complete))*100 )
aou_individuals <- final_aou_data_complete[final_aou_data_complete$id %in% individuals,]$id
weighted_case_df <- data.frame(id = aou_individuals,case=1)
weighted_control_df <- data.frame(id = setdiff(final_aou_data_complete$id,aou_individuals),case=0)
weighted_prev_df <- rbind(weighted_case_df,weighted_control_df)
weighted_prev_df <- left_join(weighted_prev_df,aou_weights_int_propensity,by="id")
paste0("Weighted cohort specific cases: ",sum(weighted_prev_df[weighted_prev_df$case==1,]$weight))
paste0("Weighted cohort specific prevalence: ",(sum(weighted_prev_df[weighted_prev_df$case==1,]$weight)/sum(weighted_prev_df$weight))*100)

# Diabetes
icd10_vector <- c(
  "E10", "E10.0", "E10.1", 
  "E10.3", "E10.4", "E10.5", "E10.6", "E10.7", "E10.8", "E10.9",
  "E11.0", "E11.1",
  "E11.3", "E11.4", "E11.5", "E11.6", "E11.7", "E11.8", "E11.9",
  "P70.2",
  "E08", "E08.0", "E08.1", "E08.2", "E08.3", "E08.4", "E08.5", "E08.6", "E08.7", "E08.8", "E08.9", 
  "E08.10", "E08.11",
  "E10.2",
  "E10.10", "E10.11",
  "E11.2", 
  "E12.0", "E12.1", 
  "E12.3", "E12.4", "E12.5", "E12.6", "E12.7", "E12.8", "E12.9", "E13.0", "E13.1", "E13.2",
  "E13.3", "E13.4", "E13.5", "E13.6", "E13.7", "E13.8", "E13.9",
  "E13.10", "E13.11",
  "E14.0", "E14.1", 
  "E14.3", "E14.4", "E14.5", "E14.6", "E14.7", "E14.8", "E14.9",
  "R73", "R73.0", "R73.1", "R73.2", "R73.3", "R73.4", "R73.5", "R73.6", "R73.7", "R73.8", "R73.9",
  "Z13.1",
  "Z83.3"
)
icd10_vector <- paste(icd10_vector,collapse="|")
icd9_vector <- c(
  "775.1",
  "249", "249.0", "249.1", "249.2", "249.3", "249.00", "249.01", "249.02", "249.03", "249.10", "249.11", "249.12", "249.13", "249.20", "249.21", "249.22", "249.23", "249.30", "249.31",
  "249.5", "249.50", "249.51", "249.52", "249.53", "249.59", "249.6", "249.60", "249.61", "249.62", "249.63", "249.69", "249.7", "249.70", "249.71", "249.72", "249.73", "249.79", "249.8", "249.80", "249.81", "249.82", "249.83", "249.89", "249.9", "249.90", "249.91", "249.92", "249.93", "249.99",
  "250.0", "250.00", "250.01", "250.02", "250.03", "250.1", "250.10", "250.11", "250.12", "250.13", "250.2", "250.20", "250.21", "250.22", "250.23", "250.3", "250.30", "250.31", "250.32", "250.33", "250.4", "250.40", "250.41", "250.42", "250.43", "250.5", "250.50", "250.51", "250.52", "250.53", "250.6", "250.60", "250.61", "250.62", "250.63", "250.7", "250.70", "250.71", "250.72", "250.73", "250.8", "250.80", "250.81", "250.82", "250.83", "250.9", "250.90", "250.91", "250.92", "250.93", "250.99",
  "362.0", "362.01", "362.02", "362.03", "362.04", "362.05", "362.06", "362.07",
  "790.2", "790.21", "790.22", "790.29",
  "V18", "V18.0",
  "V42.83",
  "V45.85",
  "V58.67",
  "V77.1"
)
icd9_vector <- paste(icd9_vector,collapse="|")
# Look for ICD 10 prevalence
full_icd10_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD10CM" | full_icd_df$source_vocabulary == "ICD10PCS",]
individuals <- c()
matching_rows <- full_icd10_df[grep(icd10_vector,full_icd10_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(individuals)
# Look for ICD 9 prevalence
full_icd9_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD9CM",]
matching_rows <- full_icd9_df[grep(icd9_vector,full_icd9_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(unique(individuals))
paste0("Cohort specific cases: ",nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,]))
paste0("Cohort specific prev: ",(nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,])/nrow(final_aou_data_complete))*100 )
aou_individuals <- final_aou_data_complete[final_aou_data_complete$id %in% individuals,]$id
weighted_case_df <- data.frame(id = aou_individuals,case=1)
weighted_control_df <- data.frame(id = setdiff(final_aou_data_complete$id,aou_individuals),case=0)
weighted_prev_df <- rbind(weighted_case_df,weighted_control_df)
weighted_prev_df <- left_join(weighted_prev_df,aou_weights_int_propensity,by="id")
paste0("Weighted cohort specific cases: ",sum(weighted_prev_df[weighted_prev_df$case==1,]$weight))
paste0("Weighted cohort specific prevalence: ",(sum(weighted_prev_df[weighted_prev_df$case==1,]$weight)/sum(weighted_prev_df$weight))*100)

# Digestive Diseases
icd10_vector <- c(
  "B18", "B18.0", "B18.1", "B18.2", "B18.8", "B18.9",
  "I84", "I84.0", "I84.1", "I84.2", "I84.3", "I84.4", "I84.5", "I84.6", "I84.7", "I84.8", "I84.9", "I85", "I85.0", "I85.9",
  "I98.2",
  "K20", "K20.0", "K20.8", "K20.9",
  "K22", "K22.0", "K22.1", "K22.2", "K22.3", "K22.4", "K22.5", "K22.6", "K22.8", "K22.9",
  "K23", "K23.0", "K23.1", "K23.2", "K23.3", "K23.4", "K23.5", "K23.6", "K23.7", "K23.8",
  "K25", "K25.0", "K25.1", "K25.2", "K25.3", "K25.4", "K25.5", "K25.6", "K25.7", "K25.8", "K25.9",
  "K26", "K26.0", "K26.1", "K26.2", "K26.3", "K26.4", "K26.5", "K26.6", "K26.7", "K26.8", "K26.9",
  "K27", "K27.0", "K27.1", "K27.2", "K27.3", "K27.4", "K27.5", "K27.6", "K27.7", "K27.8", "K27.9",
  "K28", "K28.0", "K28.1", "K28.2", "K28.3", "K28.4", "K28.5", "K28.6", "K28.7", "K28.8", "K28.9",
  "K29", "K29.0", "K29.1", "K29.2", "K29.3", "K29.4", "K29.5", "K29.6", "K29.7", "K29.8", "K29.9",
  "K31", "K31.0", "K31.1", "K31.2", "K31.3", "K31.4", "K31.5", "K31.6", "K31.7", "K31.8", "K31.9",
  "K35", "K35.0", "K35.1", "K35.2", "K35.3", "K35.8", "K35.9",
  "K36", "K36.0", "K36.1", "K36.2", "K36.3", "K36.4", "K36.8", "K36.9",
  "K37",
  "K38", "K38.0", "K38.1", "K38.2", "K38.3", "K38.4", "K38.8", "K38.9",
  "K40", "K40.0", "K40.1", "K40.2", "K40.3", "K40.4", "K40.9",
  "K41", "K41.0", "K41.1", "K41.2", "K41.3", "K41.4", "K41.9",
  "K42", "K42.0", "K42.1", "K42.2", "K42.3", "K42.4", "K42.9",
  "K44", "K44.0", "K44.1", "K44.2", "K44.3", "K44.4", "K44.9",
  "K45", "K45.0", "K45.1", "K45.2", "K45.3", "K45.4", "K45.9",
  "K46", "K46.0", "K46.1", "K46.2", "K46.3", "K46.4", "K46.9",
  "K50", "K50.0", "K50.1", "K50.2", "K50.8", "K50.9",
  "K51", "K51.0", "K51.1", "K51.2", "K51.3", "K51.30", "K51.31", "K51.32", "K51.33", "K51.34", "K51.35", "K51.36", "K51.38", "K51.39", "K51.4", "K51.5", "K51.8", "K51.9",
  "K52", "K52.0", "K52.1", "K52.2", "K52.3", "K52.8", "K52.9",
  "K55", "K55.0", "K55.1", "K55.2", "K55.3", "K55.4", "K55.8", "K55.9",
  "K56", "K56.0", "K56.1", "K56.2", "K56.3", "K56.4", "K56.5", "K56.6", "K56.7", "K56.8", "K56.9",
  "K57", "K57.0", "K57.1", "K57.2", "K57.3", "K57.4", "K57.5", "K57.8", "K57.9",
  "K58", "K58.0", "K58.1", "K58.2", "K58.3", "K58.4", "K58.8", "K58.9",
  "K59", "K59.0", "K59.1", "K59.2", "K59.3", "K59.4", "K59.8", "K59.9",
  "K60", "K60.0", "K60.1", "K60.2", "K60.3", "K60.4", "K60.5", "K60.6", "K60.7", "K60.8", "K60.9",
  "K61", "K61.0", "K61.1", "K61.2", "K61.3", "K61.4", "K61.5", "K61.6", "K61.7", "K61.8", "K61.9",
  "K62", "K62.0", "K62.1", "K62.2", "K62.3", "K62.4", "K62.5", "K62.6", "K62.8", "K62.9",
  "K63", "K63.0", "K63.1", "K63.2", "K63.3", "K63.4", "K63.5", "K63.6", "K63.8", "K63.9",
  "K64", "K64.0", "K64.1", "K64.2", "K64.3", "K64.4", "K64.5", "K64.8", "K64.9",
  "K66", "K66.0", "K66.1", "K66.2", "K66.3", "K66.8", "K66.9",
  "K67", "K67.0", "K67.1", "K67.2", "K67.3", "K67.4", "K67.5", "K67.6", "K67.8", "K67.9",
  "K68", "K68.0", "K68.1", "K68.10", "K68.11", "K68.12", "K68.2", "K68.3", "K68.8", "K68.9",
  "K70", "K70.0", "K70.1", "K70.2", "K70.3",
  "K71", "K71.0", "K71.1", "K71.2", "K71.3", "K71.4", "K71.5", "K71.6", "K71.7", "K71.8", "K71.9",
  "K73", "K73.0", "K73.1", "K73.2", "K73.8", "K73.9",
  "K74", "K74.0", "K74.1", "K74.2", "K74.3", "K74.4", "K74.5", "K74.6", "K74.7",
  "K75", "K75.0", "K75.1", "K75.2", "K75.3", "K75.4", "K75.5", "K75.6", "K75.8", "K75.9",
  "K76", "K76.0", "K76.1", "K76.2", "K76.3", "K76.4", "K76.5", "K76.6", "K76.7", "K76.8", "K76.9",
  "K77", "K77.0", "K77.1", "K77.2", "K77.3", "K77.4", "K77.5", "K77.6", "K77.7", "K77.8", "K77.9",
  "K80", "K80.0", "K80.1", "K80.2", "K80.3", "K80.4", "K80.5", "K80.6", "K80.7", "K80.8", "K80.81", "K80.9",
  "K81", "K81.0", "K81.1", "K81.2", "K81.3", "K81.4", "K81.5", "K81.6", "K81.8", "K81.9",
  "K82", "K82.0", "K82.1", "K82.2", "K82.3", "K82.4", "K82.5", "K82.8", "K82.9",
  "K83", "K83.0", "K83.1", "K83.2", "K83.3", "K83.4", "K83.5", "K83.8", "K83.9",
  "K85", "K85.0", "K85.1", "K85.2", "K85.3", "K85.8", "K85.9",
  "K86", "K86.0", "K86.1", "K86.2", "K86.3", "K86.4", "K86.8", "K86.9",
  "K87", "K87.0", "K87.1",
  "K90", "K90.0", "K90.1", "K90.2", "K90.3", "K90.4", "K90.8", "K90.9",
  "K92", "K92.0", "K92.1", "K92.2", "K92.3", "K92.8", "K92.9",
  "K93", "K93.0", "K93.1", "K93.2", "K93.3", "K93.4", "K93.8", "K93.9",
  "R11", "R11.0", "R11.1", "R11.2", "R11.8", "R11.9",
  "R12", "R12.0", "R12.1", "R12.2", "R12.8", "R12.9",
  "R13", "R13.0", "R13.1", "R13.2", "R13.3", "R13.4", "R13.8", "R13.9",
  "R14", "R14.0", "R14.1", "R14.2", "R14.3", "R14.4", "R14.8", "R14.9",
  "R15", "R15.0", "R15.1", "R15.2", "R15.3", "R15.4", "R15.8", "R15.9",
  "R16", "R16.0", "R16.1", "R16.2", "R16.3", "R16.4", "R16.8", "R16.9",
  "R17", "R17.0", "R17.1", "R17.2", "R17.3", "R17.4", "R17.8", "R17.9",
  "R18", "R18.0", "R18.1", "R18.2", "R18.3", "R18.4", "R18.8", "R18.9",
  "R19", "R19.0", "R19.1", "R19.2", "R19.3", "R19.4", "R19.5", "R19.6", "R19.7", "R19.8",
  "R85", "R85.0", "R85.1", "R85.2", "R85.3", "R85.4", "R85.8", "R85.9",
  "Z13", "Z13.0", "Z13.1", "Z13.2", "Z13.3", "Z13.4", "Z13.5", "Z13.6", "Z13.7", "Z13.8", "Z13.81", "Z13.818",
  "Z43", "Z43.0", "Z43.1", "Z43.2", "Z43.3", "Z43.4",
  "Z52", "Z52.0", "Z52.1", "Z52.2", "Z52.3", "Z52.4", "Z52.5", "Z52.6",
  "Z83", "Z83.0", "Z83.1", "Z83.2", "Z83.3", "Z83.4", "Z83.5", "Z83.6", "Z83.7", "Z83.71", "Z83.72", "Z83.73", "Z83.74", "Z83.75", "Z83.76", "Z83.77", "Z83.78", "Z83.79",
  "Z87", "Z87.0", "Z87.1", "Z87.11", "Z87.12", "Z87.13", "Z87.14", "Z87.15", "Z87.16", "Z87.17", "Z87.18", "Z87.19",
  "Z94", "Z94.0", "Z94.1", "Z94.2", "Z94.3", "Z94.4"
)
icd10_vector <- paste(icd10_vector,collapse="|")
icd9_vector <- c(
  "455", "455.0", "455.1", "455.2", "455.3", "455.4", "455.5", "455.6", "455.7", "455.8", "455.9",
  "456.0", "456.1", "456.2",
  "530", "530.0",
  "530.2", "530.3", "530.4", "530.5", "530.6",
  "531", "531.0", "531.1", "531.2", "531.3", "531.4", "531.5", "531.6", "531.7", "531.8", "531.9",
  "532", "532.0", "532.1", "532.2", "532.3", "532.4", "532.5", "532.6", "532.7", "532.8", "532.9",
  "533", "533.0", "533.1", "533.2", "533.3", "533.4", "533.5", "533.6", "533.7", "533.8", "533.9",
  "534", "534.0", "534.1", "534.2", "534.3", "534.4", "534.5", "534.6", "534.7", "534.8", "534.9",
  "535", "535.0", "535.1", "535.2", "535.3", "535.4", "535.5", "535.6", "535.7", "535.8", "535.9",
  "536", "536.0", "536.1",
  "537", "537.0", "537.1", "537.2", "537.3", "537.4", "537.5", "537.6", "537.8",
  "538",
  "540", "540.0", "540.1", "540.9",
  "541",
  "542",
  "543", "543.0", "543.1", "543.2", "543.3", "543.8", "543.9",
  "550", "550.0", "550.1",
  "551", "551.0", "551.1", "551.3",
  "552", "552.0", "552.1", "552.3",
  "553", "553.0", "553.1", "553.3", "553.4", "553.5", "553.6",
  "555", "555.0", "555.1", "555.2", "555.9",
  "556", "556.0", "556.1", "556.2", "556.3", "556.4", "556.5", "556.6", "556.8", "556.9",
  "557", "557.0", "557.1", "557.9",
  "558", "558.1", "558.2", "558.3", "558.9",
  "560", "560.0", "560.1", "560.2", "560.3",
  "560.8", "560.9",
  "562", "562.0", "562.1",
  "564", "564.0", "564.1",
  "564.5", "564.6", "564.7",
  "565", "565.0", "565.1", "565.2", "565.3", "565.4", "565.5", "565.6", "565.9",
  "566",
  "569", "569.1", "569.2", "569.3", "569.4", "569.5", "569.7",
  "571", "571.0", "571.1", "571.2", "571.3", "571.4", "571.5", "571.6", "571.8", "571.9",
  "572", "572.2", "572.3", "572.4", "572.5", "572.6", "572.7", "572.8", "572.9",
  "573", "573.0", "573.4", "573.5", "573.6", "573.7", "573.8", "573.9",
  "574", "574.0", "574.1", "574.2", "574.3", "574.4", "574.5", "574.6", "574.7", "574.8", "574.9",
  "575", "575.0", "575.1", "575.2", "575.3", "575.4", "575.5", "575.6", "575.8", "575.9",
  "576", "576.0", "576.1", "576.2", "576.3", "576.4", "576.5", "576.8", "576.9",
  "577", "577.0", "577.1", "577.2", "577.8", "577.9",
  "579", "579.0", "579.1", "579.2", "579.4", "579.8", "579.9",
  "530.01", "530.02", "530.03", "530.04", "530.05", "530.06", "530.07", "530.09",
  "530.10", "530.11", "530.12", "530.13", "530.14", "530.15", "530.16", "530.17", "530.19",
  "530.20", "530.21", "530.22", "530.23", "530.24", "530.25", "530.26", "530.27", "530.29",
  "530.30", "530.31", "530.32", "530.33", "530.34", "530.35", "530.36", "530.37", "530.39",
  "530.40", "530.41", "530.42", "530.43", "530.44", "530.45", "530.46", "530.47", "530.49",
  "530.50", "530.51", "530.52", "530.53", "530.54", "530.55", "530.56", "530.57", "530.59",
  "530.60", "530.61", "530.62", "530.63", "530.64", "530.65", "530.66", "530.67", "530.69",
  "530.70", "530.71", "530.72", "530.73", "530.74", "530.75", "530.76", "530.77", "530.79",
  "530.80", "530.81", "530.82", "530.83", "530.84", "530.85",
  "530.89", "531.01", "531.02", "531.03", "531.04", "531.05", "531.06", "531.07", "531.09",
  "531.10", "531.11", "531.12", "531.13", "531.14", "531.15", "531.16", "531.17", "531.19",
  "531.20", "531.21", "531.22", "531.23", "531.24", "531.25", "531.26", "531.27", "531.29",
  "531.30", "531.31", "531.32", "531.33", "531.34", "531.35", "531.36", "531.37", "531.39",
  "531.40", "531.41", "531.42", "531.43", "531.44", "531.45", "531.46", "531.47", "531.49",
  "531.50", "531.51", "531.52", "531.53", "531.54", "531.55", "531.56", "531.57", "531.59",
  "531.60", "531.61", "531.62", "531.63", "531.64", "531.65", "531.66", "531.67", "531.69",
  "531.70", "531.71", "531.72", "531.73", "531.74", "531.75", "531.76", "531.77", "531.79",
  "531.80", "531.81", "531.82", "531.83", "531.84", "531.85", "531.86", "531.87", "531.89",
  "531.90", "531.91", "531.92", "531.93", "531.94", "531.95", "531.96", "531.97", "531.99",
  "532.01", "532.02", "532.03", "532.04", "532.05", "532.06", "532.07", "532.09",
  "532.10", "532.11", "532.12", "532.13", "532.14", "532.15", "532.16", "532.17", "532.19",
  "532.20", "532.21", "532.22", "532.23", "532.24", "532.25", "532.26", "532.27", "532.29",
  "532.30", "532.31", "532.32", "532.33", "532.34", "532.35", "532.36", "532.37", "532.39",
  "532.40", "532.41", "532.42", "532.43", "532.44", "532.45", "532.46", "532.47", "532.49",
  "532.50", "532.51", "532.52", "532.53", "532.54", "532.55", "532.56", "532.57", "532.59",
  "532.60", "532.61", "532.62", "532.63", "532.64", "532.65", "532.66", "532.67", "532.69",
  "532.70", "532.71", "532.72", "532.73", "532.74", "532.75", "532.76", "532.77", "532.79",
  "532.80", "532.81", "532.82", "532.83", "532.84", "532.85", "532.86", "532.87", "532.89",
  "532.90", "532.91", "532.92", "532.93", "532.94", "532.95", "532.96", "532.97", "532.99",
  "533.01", "533.02", "533.03", "533.04", "533.05", "533.06", "533.07", "533.09",
  "533.10", "533.11", "533.12", "533.13", "533.14", "533.15", "533.16", "533.17", "533.19",
  "533.20", "533.21", "533.22", "533.23", "533.24", "533.25", "533.26", "533.27", "533.29",
  "533.30", "533.31", "533.32", "533.33", "533.34", "533.35", "533.36", "533.37", "533.39",
  "533.40", "533.41", "533.42", "533.43", "533.44", "533.45", "533.46", "533.47", "533.49",
  "533.50", "533.51", "533.52", "533.53", "533.54", "533.55", "533.56", "533.57", "533.59",
  "533.60", "533.61", "533.62", "533.63", "533.64", "533.65", "533.66", "533.67", "533.69",
  "533.70", "533.71", "533.72", "533.73", "533.74", "533.75", "533.76", "533.77", "533.79",
  "533.80", "533.81", "533.82", "533.83", "533.84", "533.85", "533.86", "533.87", "533.89",
  "533.90", "533.91", "533.92", "533.93", "533.94", "533.95", "533.96", "533.97", "533.99",
  "534.01", "534.02", "534.03", "534.04", "534.05", "534.06", "534.07", "534.09",
  "534.10", "534.11", "534.12", "534.13", "534.14", "534.15", "534.16", "534.17", "534.19",
  "534.20", "534.21", "534.22", "534.23", "534.24", "534.25", "534.26", "534.27", "534.29",
  "534.30", "534.31", "534.32", "534.33", "534.34", "534.35", "534.36", "534.37", "534.39",
  "534.40", "534.41", "534.42", "534.43", "534.44", "534.45", "534.46", "534.47", "534.49",
  "534.50", "534.51", "534.52", "534.53", "534.54", "534.55", "534.56", "534.57", "534.59",
  "534.60", "534.61", "534.62", "534.63", "534.64", "534.65", "534.66", "534.67", "534.69",
  "534.70", "534.71", "534.72", "534.73", "534.74", "534.75", "534.76", "534.77", "534.79",
  "534.80", "534.81", "534.82", "534.83", "534.84", "534.85", "534.86", "534.87", "534.89",
  "534.90", "534.91", "534.92", "534.93", "534.94", "534.95", "534.96", "534.97", "534.99",
  "535.01", "535.02", "535.03", "535.04", "535.05", "535.06", "535.07", "535.09",
  "535.10", "535.11", "535.12", "535.13", "535.14", "535.15", "535.16", "535.17", "535.19",
  "535.20", "535.21", "535.22", "535.23", "535.24", "535.25", "535.26", "535.27", "535.29",
  "535.30", "535.31", "535.32", "535.33", "535.34", "535.35", "535.36", "535.37", "535.39",
  "535.40", "535.41", "535.42", "535.43", "535.44", "535.45", "535.46", "535.47", "535.49",
  "535.50", "535.51", "535.52", "535.53", "535.54", "535.55", "535.56", "535.57", "535.59",
  "535.60", "535.61", "535.62", "535.63", "535.64", "535.65", "535.66", "535.67", "535.69",
  "535.70", "535.71", "535.72", "535.73", "535.74", "535.75", "535.76", "535.77", "535.79",
  "535.80", "535.81", "535.82", "535.83", "535.84", "535.85", "535.86", "535.87", "535.89",
  "535.90", "535.91", "535.92", "535.93", "535.94", "535.95", "535.96", "535.97", "535.99",
  "536.8", "536.9",
  "540.0", "540.1", "540.9",
  "550.0", "550.1", "551.0", "551.1", "551.3",
  "552.0", "552.1", "552.3",
  "553.0", "553.1", "553.3", "553.4", "553.5", "553.6",
  "560.8", "560.9",
  "562.0", "562.1",
  "564.0", "564.1", "564.5", "564.6", "564.7",
  "565.0", "565.1", "565.2", "565.3", "565.4", "565.5", "565.6", "565.9",
  "566.0", "566.1", "566.2", "566.3", "566.4", "566.5", "566.6", "566.9",
  "569.1", "569.2", "569.3", "569.4", "569.5",
  "569.8", "569.81", "569.82", "569.83", "569.84", "569.85", "569.86", "569.89", "569.9",
  "571.0", "571.1", "571.2", "571.3", "571.4", "571.5", "571.6", "571.8", "571.9",
  "572.2", "572.3", "572.4", "572.5", "572.6", "572.7", "572.8", "572.9",
  "573.4", "573.5", "573.6", "573.7", "573.8", "573.9",
  "784.0", "784.1", "784.2", "784.3", "784.4", "784.5", "784.6", "784.7", "784.8", "784.9",
  "787.0", "787.1", "787.2", "787.3", "787.4", "787.5", "787.6", "787.7", "787.8", "787.9",
  "789.9",
  "792.1", "792.2", "792.3", "792.4",
  "V12.7", "V12.71", "V12.72", "V12.73", "V12.74", "V12.75", "V12.76", "V12.77", "V12.78", "V12.79",
  "V18.5", "V18.51", "V18.52", "V18.53", "V18.54", "V18.55", "V18.56", "V18.57", "V18.58", "V18.59",
  "V42.7",
  "V45.72",
  "V45.75",
  "V47.3",
  "V58.75",
  "V59.6"
)
icd9_vector <- paste(icd9_vector,collapse="|")
# Look for ICD 10 prevalence
full_icd10_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD10CM" | full_icd_df$source_vocabulary == "ICD10PCS",]
individuals <- c()
matching_rows <- full_icd10_df[grep(icd10_vector,full_icd10_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(individuals)
# Look for ICD 9 prevalence
full_icd9_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD9CM",]
matching_rows <- full_icd9_df[grep(icd9_vector,full_icd9_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(unique(individuals))
paste0("Cohort specific cases: ",nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,]))
paste0("Cohort specific prev: ",(nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,])/nrow(final_aou_data_complete))*100 )
aou_individuals <- final_aou_data_complete[final_aou_data_complete$id %in% individuals,]$id
weighted_case_df <- data.frame(id = aou_individuals,case=1)
weighted_control_df <- data.frame(id = setdiff(final_aou_data_complete$id,aou_individuals),case=0)
weighted_prev_df <- rbind(weighted_case_df,weighted_control_df)
weighted_prev_df <- left_join(weighted_prev_df,aou_weights_int_propensity,by="id")
paste0("Weighted cohort specific cases: ",sum(weighted_prev_df[weighted_prev_df$case==1,]$weight))
paste0("Weighted cohort specific prevalence: ",(sum(weighted_prev_df[weighted_prev_df$case==1,]$weight)/sum(weighted_prev_df$weight))*100)

# HIV and STI
icd10_vector <- c(
  "A50", "A51", "A52", "A53", "A54", "A55", "A56", "A57", "A58",
  "A60", "A60.0", "A60.1", "A60.2", "A60.9",
  "A63", "A63.0", "A63.8",
  "A64",
  "B20", "B20.0", "B20.1", "B20.2", "B20.3", "B20.4", "B20.5", "B20.6", "B20.7", "B20.8", "B20.9",
  "B21", "B21.0", "B21.1", "B21.2", "B21.3", "B21.7", "B21.8", "B21.9",
  "B22", "B22.0", "B22.1", "B22.2", "B22.7", "B22.8", "B22.9",
  "B23", "B23.0", "B23.1", "B23.2", "B23.8",
  "B24", "B24.0",
  "B63",
  "B97.81",
  "C46", "C46.0", "C46.1", "C46.2", "C46.3", "C46.4", "C46.5", "C46.51", "C46.52",
  "C46.7", "C46.8", "C46.9",
  "F02.4",
  "I98.0",
  "K67.0", "K67.1", "K67.2",
  "M03.1",
  "M73.0", "M73.1", "M73.2", "M73.3", "M73.4", "M73.5", "M73.6", "M73.7", "M73.8",
  "N70", "N70.0", "N70.1", "N70.9",
  "N71", "N71.0", "N71.1", "N71.9",
  "N73", "N73.0", "N73.1", "N73.2", "N73.3", "N73.4", "N73.5", "N73.6", "N73.7", "N73.8", "N73.9",
  "N74", "N74.0", "N74.1",
  "N74.2", "N74.3", "N74.4", "N74.5", "N74.6", "N74.7", "N74.8",
  "O98.7", "O98.71", "O98.72", "O98.73",
  "Z11.3", "Z11.4",
  "Z20.2", "Z20.6",
  "Z21",
  "Z22.4",
  "Z83.0"
)
icd10_vector <- paste(icd10_vector,collapse="|")
icd9_vector <- c(
  "042", "042.0", "042.1", "042.2", "042.9",
  "043", "043.0", "043.1", "043.2", "043.3", "043.8", "043.9",
  "044", "044.0", "044.1", "044.2", "044.3", "044.4", "044.5", "044.6", "044.7", "044.8", "044.9",
  "054.1", "054.11", "054.12", "054.13", "054.14", "054.19",
  "090", "090.0", "090.1", "090.2", "090.3", "090.4", "090.5", "090.6", "090.7", "090.8", "090.9",
  "091", "091.0", "091.1", "091.2", "091.3", "091.4", "091.5", "091.6", "091.7", "091.8", "091.9",
  "092", "092.0", "092.1", "092.2", "092.3", "092.4", "092.5", "092.6", "092.7", "092.8", "092.9",
  "093", "093.0", "093.1", "093.2", "093.3", "093.4", "093.5", "093.6", "093.7", "093.8", "093.9",
  "094", "094.0", "094.1", "094.2", "094.3", "094.4", "094.5", "094.6", "094.7", "094.8", "094.9",
  "095", "095.0", "095.1", "095.2", "095.3", "095.4", "095.5", "095.6", "095.7", "095.8", "095.9",
  "096", "096.0", "096.1", "096.2", "096.3", "096.4", "096.5", "096.6", "096.7", "096.8", "096.9",
  "097", "097.0", "097.1", "097.2", "097.3", "097.4", "097.5", "097.6", "097.7", "097.8", "097.9",
  "098", "098.0", "098.1", "098.2", "098.3", "098.4", "098.5", "098.6", "098.7", "098.8", "098.9",
  "099", "099.0", "099.1", "099.2", "099.3", "099.4", "099.5", "099.6", "099.7", "099.8", "099.9",
  "131", "131.0", "131.1", "131.2", "131.3", "131.4", "131.5", "131.6", "131.7", "131.8", "131.9",
  "176", "176.0", "176.1", "176.2", "176.3", "176.4", "176.5", "176.8", "176.9",
  "613", "613.0", "613.1", "613.2", "613.3", "613.4", "613.5", "613.6", "613.7", "613.8", "613.9",
  "614", "614.0", "614.1", "614.2", "614.3", "614.4", "614.5", "614.6", "614.7", "614.8", "614.9",
  "615", "615.0", "615.1", "615.2", "615.3", "615.4", "615.5", "615.6", "615.7", "615.8", "615.9",
  "V01.6",
  "V02.7", "V02.71", "V02.72", "V02.73", "V02.79", "V02.9",
  "V08",
  "V73.8", "V73.81", "V73.82", "V73.83", "V73.84", "V73.85", "V73.86", "V73.87", "V73.88",
  "V73.9", "V73.91", "V73.92", "V73.93", "V73.94", "V73.95", "V73.96", "V73.97", "V73.98",
  "V74.5", "V74.6"
)
icd9_vector <- paste(icd9_vector,collapse="|")
# Look for ICD 10 prevalence
full_icd10_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD10CM" | full_icd_df$source_vocabulary == "ICD10PCS",]
individuals <- c()
matching_rows <- full_icd10_df[grep(icd10_vector,full_icd10_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(individuals)
# Look for ICD 9 prevalence
full_icd9_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD9CM",]
matching_rows <- full_icd9_df[grep(icd9_vector,full_icd9_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(unique(individuals))
paste0("Cohort specific cases: ",nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,]))
paste0("Cohort specific prev: ",(nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,])/nrow(final_aou_data_complete))*100 )
aou_individuals <- final_aou_data_complete[final_aou_data_complete$id %in% individuals,]$id
weighted_case_df <- data.frame(id = aou_individuals,case=1)
weighted_control_df <- data.frame(id = setdiff(final_aou_data_complete$id,aou_individuals),case=0)
weighted_prev_df <- rbind(weighted_case_df,weighted_control_df)
weighted_prev_df <- left_join(weighted_prev_df,aou_weights_int_propensity,by="id")
paste0("Weighted cohort specific cases: ",sum(weighted_prev_df[weighted_prev_df$case==1,]$weight))
paste0("Weighted cohort specific prevalence: ",(sum(weighted_prev_df[weighted_prev_df$case==1,]$weight)/sum(weighted_prev_df$weight))*100)

# Maternal and neonatal
icd10_vector <- c("C58", "C58.0", "N96", "N98", "N98.0", "N98.1", "N98.2", "N98.3", "N98.8", "N98.9",
                  "O00", "O00.0", "O00.1", "O00.2", "O00.8", "O00.9", "O01", "O01.0", "O01.1", "O01.9",
                  "O02", "O02.0", "O02.1", "O02.8", "O02.9", "O03", "O03.0", "O03.1", "O03.2", "O03.3",
                  "O03.4", "O03.5", "O03.6", "O03.7", "O03.8", "O03.9", "O04", "O04.0", "O04.1", "O04.2",
                  "O04.3", "O04.4", "O04.5", "O04.6", "O04.7", "O04.8", "O04.9", "O05", "O05.0", "O05.1",
                  "O05.2", "O05.3", "O05.4", "O05.5", "O05.6", "O05.7", "O05.8", "O05.9", "O06", "O06.0",
                  "O06.1", "O06.2", "O06.3", "O06.4", "O06.5", "O06.6", "O06.7", "O06.8", "O06.9", "O07",
                  "O07.0", "O07.1", "O07.2", "O07.3", "O07.4", "O07.5", "O07.6", "O07.7", "O07.8", "O07.9",
                  "O09", "O09.0", "O09.1", "O09.2", "O09.3", "O09.4", "O09.5", "O09.6", "O09.7", "O09.8",
                  "O09.9", "O10", "O10.0", "O10.1", "O10.2", "O10.3", "O10.4", "O10.9", "O11", "O11.0",
                  "O11.1", "O11.2", "O11.3", "O11.4", "O11.9", "O12", "O12.0", "O12.1", "O12.2", "O12.3",
                  "O12.4", "O12.9", "O13", "O13.0", "O13.1", "O13.2", "O13.3", "O13.4", "O13.9", "O14",
                  "O14.0", "O14.1", "O14.2", "O14.3", "O14.4", "O14.9", "O15", "O15.0", "O15.1", "O15.2",
                  "O15.3", "O15.4", "O15.9", "O16", "O16.0", "O16.1", "O16.2", "O16.3", "O16.4", "O16.9",
                  "O20", "O20.0", "O20.1", "O20.8", "O20.9", "O21", "O21.0", "O21.1", "O21.8", "O21.9",
                  "O22", "O22.0", "O22.1", "O22.2", "O22.3", "O22.4", "O22.5", "O22.6", "O22.8", "O22.9",
                  "O23", "O23.0", "O23.1", "O23.2", "O23.3", "O23.4", "O23.5", "O23.6", "O23.8", "O23.9",
                  "O24", "O24.0", "O24.1", "O24.2", "O24.3", "O24.4", "O24.8", "O24.9", "O25", "O25.0",
                  "O25.1", "O25.2", "O25.3", "O25.4", "O25.8", "O25.9", "O26", "O26.0", "O26.1", "O26.2",
                  "O26.3", "O26.4", "O26.5", "O26.6", "O26.7", "O26.8", "O26.9", "O28", "O28.0", "O28.1",
                  "O28.2", "O28.3", "O28.4", "O28.5", "O28.6", "O28.8", "O28.9", "O29", "O29.0", "O29.1",
                  "O29.2", "O29.3", "O29.4", "O29.5", "O29.6", "O29.8", "O29.9", "O30", "O30.0", "O30.1",
                  "O30.2", "O30.3", "O30.4", "O30.8", "O30.9", "O31", "O31.0", "O31.1", "O31.2", "O31.3",
                  "O31.4", "O31.5", "O31.8", "O31.9", "O32", "O32.0", "O32.1", "O32.2", "O32.3", "O32.4",
                  "O32.5", "O32.6", "O32.7", "O32.8", "O32.9", "O33", "O33.0", "O33.1", "O33.2", "O33.3",
                  "O33.4", "O33.5", "O33.6", "O33.7", "O33.8", "O33.9", "O34", "O34.0", "O34.1", "O34.2",
                  "O34.3", "O34.4", "O34.5", "O34.6", "O34.7", "O34.8", "O34.9", "O35", "O35.0", "O35.1",
                  "O35.2", "O35.3", "O35.4", "O35.5", "O35.6", "O35.7", "O35.8", "O35.9", "O36", "O36.0",
                  "O36.1", "O36.2", "O36.3", "O36.4", "O36.5", "O36.6", "O36.7", "O36.8", "O36.9", "O40",
                  "O40.0", "O40.1", "O40.2", "O40.8", "O40.9", "O41", "O41.0", "O41.1", "O41.8", "O41.9",
                  "O42", "O42.0", "O42.1", "O42.2", "O42.3", "O42.8", "O42.9", "O43", "O43.0", "O43.1",
                  "O43.2", "O43.8", "O43.9", "O44", "O44.0", "O44.1", "O44.8", "O44.9", "O45", "O45.0",
                  "O45.1", "O45.8", "O45.9", "O46", "O46.0", "O46.8", "O46.9", "O47", "O47.0", "O47.1",
                  "O47.9", "O48", "O48.0", "O48.1", "O60", "O60.0", "O60.1", "O60.2", "O60.3", "O60.4",
                  "O60.8", "O60.9", "O61", "O61.0", "O61.1", "O61.2", "O61.8", "O61.9", "O62", "O62.0",
                  "O62.1", "O62.2", "O62.3", "O62.4", "O62.8", "O62.9", "O63", "O63.0", "O63.1", "O63.2",
                  "O63.3", "O63.4", "O63.5", "O63.8", "O63.9", "O64", "O64.0", "O64.1", "O64.2", "O64.3",
                  "O64.4", "O64.5", "O64.8", "O64.9", "O65", "O65.0", "O65.1", "O65.2", "O65.3", "O65.4",
                  "O65.5", "O65.8", "O65.9", "O66", "O66.0", "O66.1", "O66.2", "O66.3", "O66.4", "O66.8",
                  "O66.9", "O67", "O67.0", "O67.1", "O67.2", "O67.8", "O67.9", "O68", "O68.0", "O68.1",
                  "O68.2", "O68.3", "O68.8", "O68.9", "O69", "O69.0", "O69.1", "O69.2", "O69.3", "O69.4",
                  "O69.5", "O69.8", "O69.9", "O70", "O70.0", "O70.1", "O70.2", "O70.3", "O70.8", "O70.9",
                  "O71", "O71.0", "O71.1", "O71.2", "O71.3", "O71.4", "O71.5", "O71.6", "O71.7", "O71.8",
                  "O71.9", "O72", "O72.0", "O72.1", "O72.2", "O72.3", "O72.4", "O72.8", "O72.9", "O73",
                  "O73.0", "O73.1", "O73.8", "O73.9", "O74", "O74.0", "O74.1", "O74.2", "O74.3", "O74.4",
                  "O74.5", "O74.6", "O74.7", "O74.8", "O74.9", "O75", "O75.0", "O75.1", "O75.2", "O75.3",
                  "O75.4", "O75.5", "O75.6", "O75.7", "O75.8", "O75.9", "O76", "O76.0", "O76.1", "O76.8",
                  "O76.9", "O77", "O77.0", "O77.1", "O77.2", "O77.3", "O77.4", "O77.5", "O77.6", "O77.7",
                  "O77.8", "O77.9", "O80", "O80.0", "O80.1", "O80.2", "O80.3", "O80.8", "O80.9", "O81",
                  "O81.0", "O81.1", "O81.2", "O81.3", "O81.4", "O81.5", "O81.6", "O81.7", "O81.8", "O81.9",
                  "O82", "O82.0", "O82.1", "O82.2", "O82.3", "O82.4", "O82.5", "O82.6", "O82.7", "O82.8",
                  "O82.9", "O83", "O83.0", "O83.1", "O83.2", "O83.3", "O83.4", "O83.5", "O83.6", "O83.7",
                  "O83.8", "O83.9", "O84", "O84.0", "O84.1", "O84.2", "O84.3", "O84.4", "O84.5", "O84.6",
                  "O84.7", "O84.8", "O84.9", "O85", "O85.0", "O85.1", "O85.2", "O85.3", "O85.4", "O85.5",
                  "O85.6", "O85.7", "O85.8", "O85.9", "O86", "O86.0", "O86.1", "O86.2", "O86.3", "O86.4",
                  "O86.5", "O86.6", "O86.7", "O86.8", "O86.9", "O87", "O87.0", "O87.1", "O87.2", "O87.3",
                  "O87.4", "O87.5", "O87.6", "O87.7", "O87.8", "O87.9", "O88", "O88.0", "O88.1", "O88.2",
                  "O88.3", "O88.4", "O88.5", "O88.6", "O88.7", "O88.8", "O88.9", "O89", "O89.0", "O89.1",
                  "O89.2", "O89.3", "O89.4", "O89.5", "O89.6", "O89.7", "O89.8", "O89.9", "O90", "O90.0",
                  "O90.1", "O90.2", "O90.3", "O90.4", "O90.5", "O90.6", "O90.7", "O90.8", "O90.9", "O91",
                  "O91.0", "O91.1", "O91.2", "O91.3", "O91.4", "O91.5", "O91.6", "O91.7", "O91.8", "O91.9",
                  "O92", "O92.0", "O92.1", "O92.2", "O92.3", "O92.4", "O92.5", "O92.6", "O92.7", "O96",
                  "O96.0", "O96.1", "O96.2", "O96.3", "O96.4", "O96.5", "O96.6", "O96.7", "O96.8", "O96.9",
                  "O97", "O97.0", "O97.1", "O97.2", "O97.3", "O97.4", "O97.5", "O97.6", "O97.7", "O97.8",
                  "O97.9", "O98", "O98.0", "O98.1", "O98.2", "O98.3", "O98.4", "O98.5", "O98.6", "O98.8",
                  "O98.9", "P00", "P00.0", "P00.1", "P00.2", "P00.3", "P00.4", "P00.5", "P00.6", "P00.7",
                  "P00.8", "P00.9", "P01", "P01.0", "P01.1", "P01.2", "P01.3", "P01.4", "P01.5", "P01.6",
                  "P01.7", "P01.8", "P01.9", "P02", "P02.0", "P02.1", "P02.2", "P02.3", "P02.4", "P02.5",
                  "P02.6", "P02.7", "P02.8", "P02.9", "P03", "P03.0", "P03.1", "P03.2", "P03.3", "P03.4",
                  "P03.5", "P03.6", "P03.7", "P03.8", "P03.9", "P04", "P04.0", "P04.1", "P04.2", "P04.3",
                  "P04.4", "P04.5", "P04.6", "P04.7", "P04.8", "P04.9", "P05", "P05.0", "P05.1", "P05.2",
                  "P05.3", "P05.4", "P05.5", "P05.6", "P05.7", "P05.8", "P05.9", "P06", "P06.0", "P06.1",
                  "P06.2", "P06.3", "P06.4", "P06.5", "P06.6", "P06.7", "P06.8", "P06.9", "P07", "P07.0",
                  "P07.1", "P07.2", "P07.3", "P07.4", "P07.5", "P07.6", "P07.7", "P07.8", "P07.9", "P08",
                  "P08.0", "P08.1", "P08.2", "P08.3", "P08.4", "P08.5", "P08.6", "P08.7", "P08.8", "P08.9",
                  "P09", "P09.0", "P09.1", "P09.2", "P09.3", "P09.4", "P09.5", "P09.6", "P09.7", "P09.8",
                  "P09.9", "P10", "P10.0", "P10.1", "P10.2", "P10.3", "P10.4", "P10.5", "P10.6", "P10.7",
                  "P10.8", "P10.9", "P11", "P11.0", "P11.1", "P11.2", "P11.3", "P11.4", "P11.5", "P11.6",
                  "P11.7", "P11.8", "P11.9", "P12", "P12.0", "P12.1", "P12.2", "P12.3", "P12.4", "P12.5",
                  "P12.6", "P12.7", "P12.8", "P12.9", "P13", "P13.0", "P13.1", "P13.2", "P13.3", "P13.4",
                  "P13.5", "P13.6", "P13.7", "P13.8", "P13.9", "P14", "P14.0", "P14.1", "P14.2", "P14.3",
                  "P14.4", "P14.5", "P14.6", "P14.7", "P14.8", "P14.9", "P15", "P15.0", "P15.1", "P15.2",
                  "P15.3", "P15.4", "P15.5", "P15.6", "P15.7", "P15.8", "P15.9", "P19", "P19.0", "P19.1",
                  "P19.2", "P19.3", "P19.4", "P19.5", "P19.6", "P19.7", "P19.8", "P19.9", "P20", "P20.0",
                  "P20.1", "P20.2", "P20.3", "P20.4", "P20.5", "P20.6", "P20.7", "P20.8", "P20.9", "P21",
                  "P21.0", "P21.1", "P21.2", "P21.3", "P21.4", "P21.5", "P21.6", "P21.7", "P21.8", "P21.9",
                  "P22", "P22.0", "P22.1", "P22.2", "P22.3", "P22.4", "P22.5", "P22.6", "P22.7", "P22.8",
                  "P22.9", "P24", "P24.0", "P24.1", "P24.2", "P24.3", "P24.4", "P24.5", "P24.6", "P24.7",
                  "P24.8", "P24.9", "P25", "P25.0", "P25.1", "P25.2", "P25.3", "P25.4", "P25.5", "P25.6",
                  "P25.7", "P25.8", "P25.9", "P26", "P26.0", "P26.1", "P26.2", "P26.3", "P26.4", "P26.5",
                  "P26.6", "P26.7", "P26.8", "P26.9", "P27", "P27.0", "P27.1", "P27.2", "P27.3", "P27.4",
                  "P27.5", "P27.6", "P27.7", "P27.8", "P27.9", "P28", "P28.0", "P28.1", "P28.2", "P28.3",
                  "P28.4", "P28.5", "P28.6", "P28.7", "P28.8", "P28.9", "P29", "P29.0", "P29.1", "P29.2",
                  "P29.3", "P29.4", "P29.5", "P29.6", "P29.7", "P29.8", "P29.9", "P36", "P36.0", "P36.1",
                  "P36.2", "P36.3", "P36.4", "P36.5", "P36.8", "P36.9", "P38", "P38.0", "P38.1", "P38.2",
                  "P38.3", "P38.4", "P38.5", "P38.6", "P38.7", "P38.8", "P38.9", "P39", "P39.0", "P39.1",
                  "P39.2", "P39.3", "P39.4", "P39.5", "P39.6", "P39.7", "P39.8", "P39.9", "P50", "P50.0",
                  "P50.1", "P50.2", "P50.3", "P50.4", "P50.5", "P50.6", "P50.7", "P50.8", "P50.9", "P51",
                  "P51.0", "P51.1", "P51.2", "P51.3", "P51.4", "P51.5", "P51.6", "P51.7", "P51.8", "P51.9",
                  "P52", "P52.0", "P52.1", "P52.2", "P52.3", "P52.4", "P52.5", "P52.6", "P52.7", "P52.8",
                  "P52.9", "P53", "P53.0", "P53.1", "P53.2", "P53.3", "P53.4", "P53.5", "P53.6", "P53.7",
                  "P53.8", "P53.9", "P54", "P54.0", "P54.1", "P54.2", "P54.3", "P54.4", "P54.5", "P54.6",
                  "P54.7", "P54.8", "P54.9", "P55", "P55.0", "P55.1", "P55.2", "P55.3", "P55.4", "P55.5",
                  "P55.6", "P55.7", "P55.8", "P55.9", "P56", "P56.0", "P56.1", "P56.2", "P56.3", "P56.4",
                  "P56.5", "P56.6", "P56.7", "P56.8", "P56.9", "P57", "P57.0", "P57.1", "P57.2", "P57.3",
                  "P57.4", "P57.5", "P57.6", "P57.7", "P57.8", "P57.9", "P58", "P58.0", "P58.1", "P58.2",
                  "P58.3", "P58.4", "P58.5", "P58.6", "P58.7", "P58.8", "P58.9", "P59", "P59.0", "P59.1",
                  "P59.2", "P59.3", "P59.4", "P59.5", "P59.6", "P59.7", "P59.8", "P59.9", "P60", "P60.0",
                  "P60.1", "P60.2", "P60.3", "P60.4", "P60.5", "P60.6", "P60.7", "P60.8", "P60.9", "P61",
                  "P61.0", "P61.1", "P61.2", "P61.3", "P61.4", "P61.5", "P61.6", "P61.7", "P61.8", "P61.9",
                  "P70", "P70.0", "P70.1", "P70.3", "P70.4", "P70.5", "P70.6", "P70.7", "P70.8", "P70.9",
                  "P71", "P71.0", "P71.1", "P71.2", "P71.3", "P71.4", "P71.5", "P71.6", "P71.7", "P71.8",
                  "P71.9", "P72", "P72.0", "P72.1", "P72.2", "P72.3", "P72.4", "P72.5", "P72.6", "P72.7",
                  "P72.8", "P72.9", "P74", "P74.0", "P74.1", "P74.2", "P74.3", "P74.4", "P74.5", "P74.8",
                  "P74.9", "P75", "P75.0", "P75.1", "P75.2", "P75.3", "P75.4", "P75.5", "P75.6", "P75.7",
                  "P75.8", "P75.9", "P76", "P76.0", "P76.1", "P76.2", "P76.3", "P76.4", "P76.5", "P76.6",
                  "P76.7", "P76.8", "P76.9", "P77", "P77.0", "P77.1", "P77.2", "P77.3", "P77.4", "P77.5",
                  "P77.6", "P77.7", "P77.8", "P77.9", "P78", "P78.0", "P78.1", "P78.2", "P78.3", "P78.4",
                  "P78.5", "P78.6", "P78.7", "P78.8", "P78.9", "P80", "P80.0", "P80.1", "P80.2", "P80.3",
                  "P80.4", "P80.5", "P80.6", "P80.7", "P80.8", "P80.9", "P81", "P81.0", "P81.1", "P81.2",
                  "P81.3", "P81.4", "P81.5", "P81.6", "P81.7", "P81.8", "P81.9", "P83", "P83.0", "P83.1",
                  "P83.2", "P83.3", "P83.4", "P83.5", "P83.6", "P83.7", "P83.8", "P83.9", "P84", "P84.0",
                  "P84.1", "P84.2", "P84.3", "P84.4", "P84.5", "P84.6", "P84.7", "P84.8", "P84.9", "P90",
                  "P90.0", "P90.1", "P90.2", "P90.3", "P90.4", "P90.5", "P90.6", "P90.7", "P90.8", "P90.9",
                  "P91", "P91.0", "P91.1", "P91.2", "P91.3", "P91.4", "P91.5", "P91.6", "P91.7", "P91.8",
                  "P91.9", "P92", "P92.0", "P92.1", "P92.2", "P92.3", "P92.4", "P92.5", "P92.6", "P92.7",
                  "P92.8", "P92.9", "P94", "P94.0", "P94.1", "P94.2", "P94.3", "P94.4", "P94.5", "P94.6",
                  "P94.7", "P94.8", "P94.9", "P96", "P96.0", "P96.1", "P96.2", "P96.3", "P96.4", "P96.8",
                  "P96.9", "A40.1", "B95.1", "F53", "F53.0", "F53.1", "F53.8", "F53.9", "F54", "N82", "N82.0",
                  "N82.1", "N82.2", "N82.3", "N82.4", "N82.5", "N82.6", "N82.8", "N82.9", "O18.0", "O38.4",
                  "O94", "O95", "P99.9", "Z03.7", "Z03.71", "Z03.72", "Z03.73", "Z03.74", "Z03.75", "Z03.79",
                  "Z32", "Z32.0", "Z32.1", "Z32.2", "Z32.3", "Z32.8", "Z32.9", "Z33", "Z33.0", "Z33.1",
                  "Z33.2", "Z33.3", "Z33.4", "Z33.8", "Z33.9", "Z34", "Z34.0", "Z34.1", "Z34.2", "Z34.3",
                  "Z34.4", "Z34.8", "Z34.9", "Z35", "Z35.0", "Z35.1", "Z35.2", "Z35.3", "Z35.4", "Z35.5",
                  "Z35.6", "Z35.7", "Z35.8", "Z35.9", "Z36", "Z36.0", "Z36.1", "Z36.2", "Z36.3", "Z36.4",
                  "Z36.5", "Z36.6", "Z36.7", "Z36.8", "Z36.9", "Z37", "Z37.0", "Z37.1", "Z37.2", "Z37.3",
                  "Z37.4", "Z37.5", "Z37.6", "Z37.7", "Z37.8", "Z37.9", "Z39", "Z39.0", "Z39.1", "Z39.2",
                  "Z3A49", "Z64.0", "Z64.1", "Z64.2", "Z64.3", "Z87.5", "Z87.50", "Z87.51", "Z87.52",
                  "Z87.53", "Z87.54", "Z87.55", "Z87.56", "Z87.57", "Z87.58", "Z87.59", "Z87.6", "Z87.60",
                  "Z87.61", "Z87.62", "Z87.63", "Z87.64", "Z87.65", "Z87.66", "Z87.67", "Z87.68", "Z87.69")
icd10_vector <- paste(icd10_vector,collapse="|")
icd9_vector <- c("181", "181.0", "181.1", "181.2", "181.3", "181.4", "181.5", "181.6", "181.7", "181.8", "181.9",
                 "630", "630.0", "630.1", "630.2", "630.3", "630.4", "630.5", "630.6", "630.7", "630.8", "630.9",
                 "631", "631.0", "631.1", "631.2", "631.3", "631.4", "631.5", "631.6", "631.7", "631.8", "631.9",
                 "632", "632.0", "632.1", "632.2", "632.3", "632.4", "632.5", "632.6", "632.7", "632.8", "632.9",
                 "633", "633.0", "633.1", "633.2", "633.3", "633.4", "633.5", "633.6", "633.7", "633.8", "633.9",
                 "634", "634.0", "634.1", "634.2", "634.3", "634.4", "634.5", "634.6", "634.7", "634.8", "634.9",
                 "635", "635.0", "635.1", "635.2", "635.3", "635.4", "635.5", "635.6", "635.7", "635.8", "635.9",
                 "636", "636.0", "636.1", "636.2", "636.3", "636.4", "636.5", "636.6", "636.7", "636.8", "636.9",
                 "638", "638.0", "638.1", "638.2", "638.3", "638.4", "638.5", "638.6", "638.7", "638.8", "638.9",
                 "640", "640.0", "640.1", "640.2", "640.3", "640.4", "640.5", "640.6", "640.7", "640.8", "640.9",
                 "641", "641.0", "641.1", "641.2", "641.3", "641.4", "641.5", "641.6", "641.7", "641.8", "641.9",
                 "642", "642.0", "642.1", "642.2", "642.3", "642.4", "642.5", "642.6", "642.7", "642.8", "642.9",
                 "643", "643.0", "643.1", "643.2", "643.3", "643.4", "643.5", "643.6", "643.7", "643.8", "643.9",
                 "644", "644.0", "644.1", "644.2", "644.3", "644.4", "644.5", "644.6", "644.7", "644.8", "644.9",
                 "645", "645.0", "645.1", "645.2", "645.3", "645.4", "645.5", "645.6", "645.7", "645.8", "645.9",
                 "646", "646.0", "646.1", "646.2", "646.3", "646.4", "646.5", "646.6", "646.7", "646.8", "646.9",
                 "647", "647.0", "647.1", "647.2", "647.3", "647.4", "647.5", "647.6", "647.7", "647.8", "647.9",
                 "648", "648.0", "648.1", "648.2", "648.3", "648.4", "648.5", "648.6", "648.7", "648.8", "648.9",
                 "649", "649.0", "649.1", "649.2", "649.3", "649.4", "649.5", "649.6", "649.7", "649.8", "649.9",
                 "650", "650.0", "650.1", "650.2", "650.3", "650.4", "650.5", "650.6", "650.7", "650.8", "650.9",
                 "651", "651.0", "651.1", "651.2", "651.3", "651.4", "651.5", "651.6", "651.7", "651.8", "651.9",
                 "652", "652.0", "652.1", "652.2", "652.3", "652.4", "652.5", "652.6", "652.7", "652.8", "652.9",
                 "653", "653.0", "653.1", "653.2", "653.3", "653.4", "653.5", "653.6", "653.7", "653.8", "653.9",
                 "654", "654.0", "654.1", "654.2", "654.3", "654.4", "654.5", "654.6", "654.7", "654.8", "654.9",
                 "655", "655.0", "655.1", "655.2", "655.3", "655.4", "655.5", "655.6", "655.7", "655.8", "655.9",
                 "656", "656.0", "656.1", "656.2", "656.3", "656.4", "656.5", "656.6", "656.7", "656.8", "656.9",
                 "657", "657.0", "657.1", "657.2", "657.3", "657.4", "657.5", "657.6", "657.7", "657.8", "657.9",
                 "658", "658.0", "658.1", "658.2", "658.3", "658.4", "658.5", "658.6", "658.7", "658.8", "658.9",
                 "659", "659.0", "659.1", "659.2", "659.3", "659.4", "659.5", "659.6", "659.7", "659.8", "659.9",
                 "660", "660.0", "660.1", "660.2", "660.3", "660.4", "660.5", "660.6", "660.7", "660.8", "660.9",
                 "661", "661.0", "661.1", "661.2", "661.3", "661.4", "661.5", "661.6", "661.7", "661.8", "661.9",
                 "662", "662.0", "662.1", "662.2", "662.3", "662.4", "662.5", "662.6", "662.7", "662.8", "662.9",
                 "663", "663.0", "663.1", "663.2", "663.3", "663.4", "663.5", "663.6", "663.7", "663.8", "663.9",
                 "664", "664.0", "664.1", "664.2", "664.3", "664.4", "664.5", "664.6", "664.7", "664.8", "664.9",
                 "665", "665.0", "665.1", "665.2", "665.3", "665.4", "665.5", "665.6", "665.7", "665.8", "665.9",
                 "666", "666.0", "666.1", "666.2", "666.3", "666.4", "666.5", "666.6", "666.7", "666.8", "666.9",
                 "667", "667.0", "667.1", "667.2", "667.3", "667.4", "667.5", "667.6", "667.7", "667.8", "667.9",
                 "668", "668.0", "668.1", "668.2", "668.3", "668.4", "668.5", "668.6", "668.7", "668.8", "668.9",
                 "669", "669.0", "669.1", "669.2", "669.3", "669.4", "669.5", "669.6", "669.7", "669.8", "669.9",
                 "670", "670.0", "670.1", "670.2", "670.3", "670.4", "670.5", "670.6", "670.7", "670.8", "670.9",
                 "671", "671.0", "671.1", "671.2", "671.3", "671.4", "671.5", "671.6", "671.7", "671.8", "671.9",
                 "672", "672.0", "672.1", "672.2", "672.3", "672.4", "672.5", "672.6", "672.7", "672.8", "672.9",
                 "673", "673.0", "673.1", "673.2", "673.3", "673.4", "673.5", "673.6", "673.7", "673.8", "673.9",
                 "674", "674.0", "674.1", "674.2", "674.3", "674.4", "674.5", "674.6", "674.7", "674.8", "674.9",
                 "675", "675.0", "675.1", "675.2", "675.3", "675.4", "675.5", "675.6", "675.7", "675.8", "675.9",
                 "676", "676.0", "676.1", "676.2", "676.3", "676.4", "676.5", "676.6", "676.7", "676.8", "676.9",
                 "677", "677.0", "677.1", "677.2", "677.3", "677.4", "677.5", "677.6", "677.7", "677.8", "677.9",
                 "678", "678.0", "678.1", "678.2", "678.3", "678.4", "678.5", "678.6", "678.7", "678.8", "678.9",
                 "679", "679.0", "679.1",
                 "760", "760.0", "760.1", "760.2", "760.3", "760.4", "760.5", "760.6",
                 "760.8", "760.81", "760.82", "760.83", "760.84", "760.85", "760.86", "760.87", "760.88", "760.89",
                 "760.9", "761", "761.0", "761.1", "761.2", "761.3", "761.4", "761.5", "761.6", "761.7", "761.8",
                 "761.9", "762", "762.0", "762.1", "762.2", "762.3", "762.4", "762.5", "762.6", "762.7", "762.8",
                 "762.9", "763", "763.0", "763.1", "763.2", "763.3", "763.4", "763.5", "763.6", "763.7", "763.8",
                 "763.9", "764", "764.0", "764.1", "764.2", "764.3", "764.4", "764.5", "764.6", "764.7", "764.8",
                 "764.9", "765", "765.0", "765.1", "765.2", "765.3", "765.4", "765.5", "765.6", "765.7", "765.8",
                 "765.9", "766", "766.0", "766.1", "766.2", "766.3", "766.4", "766.5", "766.6", "766.7", "766.8",
                 "766.9", "767", "767.0", "767.1", "767.2", "767.3", "767.4", "767.5", "767.6", "767.7", "767.8",
                 "767.9", "768", "768.0", "768.1",
                 "768.2", "768.20", "768.21", "768.22", "768.23", "768.24", "768.25", "768.26", "768.27", "768.28", "768.29",
                 "768.3", "768.30", "768.31", "768.32", "768.33", "768.34", "768.35", "768.36", "768.37", "768.38", "768.39",
                 "768.4", "768.40", "768.41", "768.42", "768.43", "768.44", "768.45", "768.46", "768.47", "768.48", "768.49",
                 "768.5", "768.50", "768.51", "768.52", "768.53", "768.54", "768.55", "768.56", "768.57", "768.58", "768.59",
                 "768.6", "768.60", "768.61", "768.62", "768.63", "768.64", "768.65", "768.66", "768.67", "768.68", "768.69",
                 "768.7", "768.70", "768.71", "768.72", "768.73", "768.74", "768.75", "768.76", "768.77", "768.78", "768.79",
                 "768.8", "768.80", "768.81", "768.82", "768.83", "768.84", "768.85", "768.86", "768.87", "768.88", "768.89",
                 "768.9", "768.90", "768.91", "768.92", "768.93", "768.94", "768.95", "768.96", "768.97", "768.98", "768.99",
                 "770", "770.0",
                 "770.1", "770.10", "770.11", "770.12", "770.13", "770.14", "770.15", "770.16", "770.17", "770.18", "770.19",
                 "770.2", "770.20", "770.21", "770.22", "770.23", "770.24", "770.25", "770.26", "770.27", "770.28", "770.29",
                 "770.3", "770.30", "770.31", "770.32", "770.33", "770.34", "770.35", "770.36", "770.37", "770.38", "770.39",
                 "770.4", "770.40", "770.41", "770.42", "770.43", "770.44", "770.45", "770.46", "770.47", "770.48", "770.49",
                 "770.5", "770.50", "770.51", "770.52", "770.53", "770.54", "770.55", "770.56", "770.57", "770.58", "770.59",
                 "770.6", "770.60", "770.61", "770.62", "770.63", "770.64", "770.65", "770.66", "770.67", "770.68", "770.69",
                 "770.7", "770.70", "770.71", "770.72", "770.73", "770.74", "770.75", "770.76", "770.77", "770.78", "770.79",
                 "770.8", "770.80", "770.81", "770.82", "770.83", "770.84", "770.85", "770.86", "770.87", "770.88", "770.89",
                 "770.9", "770.90", "770.91", "770.92", "770.93", "770.94", "770.95", "770.96", "770.97", "770.98", "770.99",
                 "771", "771.0", "771.1", "771.2", "771.3",
                 "771.4", "771.40", "771.41", "771.42", "771.43", "771.44", "771.45", "771.46", "771.47", "771.48", "771.49",
                 "771.5", "771.50", "771.51", "771.52", "771.53", "771.54", "771.55", "771.56", "771.57", "771.58", "771.59",
                 "771.6", "771.60", "771.61", "771.62", "771.63", "771.64", "771.65", "771.66", "771.67", "771.68", "771.69",
                 "771.7", "771.70", "771.71", "771.72", "771.73", "771.74", "771.75", "771.76", "771.77", "771.78", "771.79",
                 "771.8", "771.80", "771.81", "771.82", "771.83", "771.84", "771.85", "771.86", "771.87", "771.88", "771.89",
                 "771.9", "771.90", "771.91", "771.92", "771.93", "771.94", "771.95", "771.96", "771.97", "771.98", "771.99",
                 "775", "775.0",
                 "775.4", "775.40", "775.41", "775.42", "775.43", "775.44", "775.45", "775.46", "775.47", "775.48", "775.49",
                 "775.5", "775.50", "775.51", "775.52", "775.53", "775.54", "775.55", "775.56", "775.57", "775.58", "775.59",
                 "775.6", "775.60", "775.61", "775.62", "775.63", "775.64", "775.65", "775.66", "775.67", "775.68", "775.69",
                 "775.7", "775.70", "775.71", "775.72", "775.73", "775.74", "775.75", "775.76", "775.77", "775.78", "775.79",
                 "775.8", "775.80", "775.81", "775.82", "775.83", "775.84", "775.85", "775.86", "775.87", "775.88", "775.89",
                 "775.9", "775.90", "775.91", "775.92", "775.93", "775.94", "775.95", "775.96", "775.97", "775.98", "775.99",
                 "776", "776.0", "776.1", "776.2", "776.3",
                 "776.4", "776.5", "776.6", "776.7", "776.8", "776.9", "777", "777.0", "777.1", "777.2", "777.3", "777.4",
                 "777.5", "777.6",
                 "779", "779.0", "779.1", "779.2", "779.3",
                 "779.6", "779.60", "779.61", "779.62", "779.63", "779.64", "779.65", "779.66", "779.67", "779.68", "779.69",
                 "779.7", "779.70", "779.71", "779.72", "779.73", "779.74", "779.75", "779.76", "779.77", "779.78", "779.79",
                 "779.8", "779.80", "779.81", "779.82", "779.83", "779.84", "779.85", "779.86", "779.87", "779.88", "779.89",
                 "779.9", "779.90", "779.91", "779.92", "779.93", "779.94", "779.95", "779.96", "779.97", "779.98", "779.99",
                 "041.02", "619", "619.0", "619.1", "619.2", "619.3", "619.4", "619.5", "619.6", "619.7", "619.8", "619.9",
                 "V02.51", "V13.1", "V13.21", "V13.7", "V15.21", "V15.22", "V15.87", "V22", "V22.0", "V22.1", "V22.2", "V23", "V23.0", "V23.1", "V23.2", "V23.3", "V23.4", "V23.5", "V23.6", "V23.7", "V23.8", "V23.9",
                 "V24", "V24.0", "V24.1", "V24.2", "V27", "V27.0", "V27.1", "V27.2", "V27.3", "V27.4", "V27.5", "V27.6", "V27.7", "V27.8", "V27.9", "V28", "V28.0", "V28.1", "V28.2", "V28.3", "V28.4", "V28.5", "V28.6", "V28.7", "V28.8", "V28.9", "V72.4", "V72.40", "V72.41", "V72.42", "V82.4", "V91", "V91.0", "V91.1", "V91.2", "V91.3", "V91.4", "V91.5", "V91.6", "V91.7", "V91.8", "V91.9", "V91.99")
icd9_vector <- paste(icd9_vector,collapse="|")
# Look for ICD 10 prevalence
full_icd10_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD10CM" | full_icd_df$source_vocabulary == "ICD10PCS",]
individuals <- c()
matching_rows <- full_icd10_df[grep(icd10_vector,full_icd10_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(individuals)
# Look for ICD 9 prevalence
full_icd9_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD9CM",]
matching_rows <- full_icd9_df[grep(icd9_vector,full_icd9_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(unique(individuals))
paste0("Cohort specific cases: ",nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,]))
paste0("Cohort specific prev: ",(nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,])/nrow(final_aou_data_complete))*100 )
aou_individuals <- final_aou_data_complete[final_aou_data_complete$id %in% individuals,]$id
weighted_case_df <- data.frame(id = aou_individuals,case=1)
weighted_control_df <- data.frame(id = setdiff(final_aou_data_complete$id,aou_individuals),case=0)
weighted_prev_df <- rbind(weighted_case_df,weighted_control_df)
weighted_prev_df <- left_join(weighted_prev_df,aou_weights_int_propensity,by="id")
paste0("Weighted cohort specific cases: ",sum(weighted_prev_df[weighted_prev_df$case==1,]$weight))
paste0("Weighted cohort specific prevalence: ",(sum(weighted_prev_df[weighted_prev_df$case==1,]$weight)/sum(weighted_prev_df$weight))*100)

# Mental disorders
icd10_vector <- c("F24",
                  "F50.0", "F50.1", "F50.2", "F50.3", "F50.4", "F50.5",
                  "F04", "F05", "F05.0", "F05.1", "F05.8", "F05.9", "F06", "F06.0", "F06.1", 
                  "F06.3", "F06.4", "F06.5", "F06.8", "F06.9", "F07", "F07.0",
                  "F08", "F09",
                  "F20", "F20.0", "F20.1", "F20.2", "F20.3", "F20.4", "F20.5", "F20.6", "F20.8", "F20.9",
                  "F21", "F22", "F22.0", "F22.8", "F22.9",
                  "F23", "F23.0", "F23.1", "F23.2", "F23.3", "F23.8", "F23.9",
                  "F25", "F25.0", "F25.1", "F25.2", "F25.8", "F25.9",
                  "F28", "F29",
                  "F30", "F30.0", "F30.1", "F30.2", "F30.3", "F30.4", "F30.8", "F30.9",
                  "F31", "F31.0", "F31.1", "F31.2", "F31.3", "F31.4", "F31.5", "F31.6", "F31.7", "F31.8", "F31.9",
                  "F32", "F32.0", "F32.1", "F32.2", "F32.3", "F32.4", "F32.5", "F32.8", "F32.9",
                  "F33", "F33.0", "F33.1", "F33.2", "F33.3", "F33.4", "F33.8", "F33.9",
                  "F34", "F34.0", "F34.1", "F34.8", "F34.9",
                  "F38", "F38.0", "F38.1", "F38.8", "F38.9",
                  "F39",
                  "F40", "F40.0", "F40.1", "F40.2", "F40.8", "F40.9",
                  "F41", "F41.0", "F41.1", "F41.2", "F41.3", "F41.8", "F41.9",
                  "F42", "F42.0", "F42.1", "F42.2", "F42.3", "F42.8", "F42.9",
                  "F43", "F43.0", "F43.1", "F43.2", "F43.8", "F43.9",
                  "F44", "F44.0", "F44.1", "F44.2", "F44.3", "F44.4", "F44.5", "F44.6", "F44.7", "F44.8", "F44.9",
                  "F45", "F45.0", "F45.1", "F45.2", "F45.3", "F45.4", "F45.8", "F45.9",
                  "F48", "F48.0", "F48.1", "F48.8", "F48.9",
                  "F50", "F50.0", "F50.1", "F50.2", "F50.3", "F50.4", "F50.5",
                  "F51", "F51.0", "F51.1", "F51.2", "F51.3", "F51.4", "F51.5", "F51.8", "F51.9",
                  "F52", "F52.0", "F52.1", "F52.2", "F52.3", "F52.4", "F52.5", "F52.6", "F52.7", "F52.8", "F52.9",
                  "F55", "F55.0", "F55.1", "F55.2", "F55.3", "F55.4", "F55.5", "F55.6", "F55.7", "F55.8",
                  "F56", "F57", "F58", "F59", "F60", "F60.0", "F60.1", "F60.2", "F60.3", "F60.4", "F60.5", "F60.6", "F60.7", "F60.8", "F60.9",
                  "F61", "F62", "F62.0", "F62.1", "F62.8", "F62.9",
                  "F63", "F63.0", "F63.1", "F63.2", "F63.3", "F63.8", "F63.9",
                  "F64", "F64.0", "F64.1", "F64.2", "F64.8", "F64.9",
                  "F65", "F65.0", "F65.1", "F65.2", "F65.3", "F65.4", "F65.5", "F65.6", "F65.8", "F65.9",
                  "F66", "F66.0", "F66.1", "F66.2", "F66.3", "F66.8", "F66.9",
                  "F68", "F68.0", "F68.1", "F68.8", "F68.9",
                  "F69",
                  "F70", "F71", "F72", "F73", "F74", "F75", "F78", "F79",
                  "F80", "F81", "F82", "F83", "F84", "F88", "F89",
                  "F90", "F91", "F92", "F93", "F94", "F95", "F98", "F99.0",
                  "G47", "G47.0", "G47.1", "G47.2", "G47.20", "G47.21", "G47.22", "G47.23", "G47.24", "G47.25", "G47.26", "G47.27", "G47.28", "G47.29",
                  "G47.4", "G47.40", "G47.41", "G47.42", "G47.49",
                  "G47.5", "G47.6", "G47.8", "G47.9",
                  "R40", "R40.0", "R40.1", "R40.2", "R40.3", "R40.4",
                  "R45", "R45.0", "R45.1", "R45.2", "R45.3", "R45.4", "R45.5", "R45.6", "R45.7", "R45.8", "R45.81", "R45.82", "R45.83", "R45.84", "R45.85", "R45.86", "R45.87", "R45.88", "R45.89",
                  "R46", "R46.0", "R46.1", "R46.2", "R46.3", "R46.4", "R46.5", "R46.6", "R46.7", "R46.8", "R46.81", "R46.82", "R46.83", "R46.84", "R46.85", "R46.86", "R46.87", "R46.88", "R46.89",
                  "R55", "R55.0",
                  "Z03.2",
                  "Z04.6", "Z04.61", "Z04.62", "Z04.71", "Z04.72",
                  "Z13.4",
                  "Z64",
                  "Z81", "Z81.0", "Z81.8",
                  "Z86.5", "Z86.50", "Z86.51", "Z86.52", "Z86.53", "Z86.54", "Z86.55", "Z86.56", "Z86.57", "Z86.58", "Z86.59")
icd10_vector <- paste(icd10_vector,collapse="|")
icd9_vector <- c("307.1",
                 "293", "293.0", "293.1", "293.2", "293.3", "293.4", "293.5", "293.6", "293.7", "293.8", "293.9",
                 "294", "294.0", "294.1", "294.2", "294.3", "294.4", "294.5", "294.6", "294.7", "294.8", "294.9",
                 "295", "295.0", "295.1", "295.2", "295.3", "295.4", "295.5", "295.6", "295.7", "295.8", "295.9",
                 "296", "296.0", "296.1", "296.2", "296.3", "296.4", "296.5", "296.6", "296.7", "296.8", "296.9",
                 "297", "297.0", "297.1", "297.2", "297.3", "297.4", "297.5", "297.6", "297.7", "297.8", "297.9",
                 "298", "298.0", "298.1", "298.2", "298.3", "298.4", "298.5", "298.6", "298.7", "298.8", "298.9",
                 "299", "299.0", "299.1", "299.2", "299.3", "299.4", "299.5", "299.6", "299.7", "299.8", "299.9",
                 "300", "300.0", "300.1", "300.2", "300.3", "300.4", "300.5", "300.6", "300.7", "300.8", "300.9",
                 "301", "301.0", "301.1", "301.2", "301.3", "301.4", "301.5", "301.6", "301.7", "301.8", "301.9",
                 "302", "302.0", "302.1", "302.2", "302.3", "302.4", "302.5", "302.6", "302.7", "302.8", "302.9",
                 "306", "306.0", "306.1", "306.2", "306.3", "306.4", "306.5", "306.6", "306.7",
                 "306.8", "306.9",
                 "307", "307.0", "307.2", "307.3", "307.4", "307.5", "307.6", "307.7",
                 "307.9", "308", "308.0", "308.1", "308.2", "308.3", "308.4", "308.5", "308.6", "308.7", "308.8", "308.9",
                 "309", "309.0", "309.1", "309.2", "309.3", "309.4", "309.5", "309.6", "309.7", "309.8", "309.9",
                 "310", "310.0", "310.1",
                 "311", "311.0", "311.1", "311.2", "311.3", "311.4", "311.5", "311.6", "311.7", "311.8", "311.9",
                 "312", "312.0", "312.1", "312.2", "312.3", "312.4", "312.5", "312.6", "312.7", "312.8", "312.9",
                 "313", "313.0", "313.1", "313.2", "313.3", "313.4", "313.5", "313.6", "313.7", "313.8", "313.9",
                 "314", "314.0", "314.1", "314.2", "314.3", "314.4", "314.5", "314.6", "314.7", "314.8", "314.9",
                 "316", "316.0", "316.1", "316.2", "316.3", "316.4", "316.5", "316.6", "316.7", "316.8", "316.9",
                 "317", "317.0", "317.1", "317.2", "317.3", "317.4", "317.5", "317.6", "317.7", "317.8", "317.9",
                 "318", "318.0", "318.1", "318.2", "318.3", "318.4", "318.5", "318.6", "318.7", "318.8", "318.9",
                 "319", "319.0", "319.1", "319.2", "319.3", "319.4", "319.5", "319.6", "319.7", "319.8", "319.9",
                 "327", "327.0", "327.1", "327.10", "327.11", "327.12", "327.13", "327.14", "327.15", "327.16", "327.17", "327.18", "327.19",
                 "327.3", "327.4", "327.5", "327.6", "327.7", "327.8",
                 "347", "347.0", "347.1", "347.2", "347.3", "347.4", "347.5", "347.6", "347.7", "347.8", "347.9",
                 "780", "780.0", "780.1", "780.2",
                 "780.93",
                 "780.97",
                 "797", "797.0", "797.1", "797.2", "797.3", "797.4", "797.5", "797.6", "797.7", "797.8", "797.9",
                 "799", "799.2", "799.21", "799.22", "799.23", "799.24", "799.25", "799.26", "799.27", "799.28", "799.29",
                 "V11.0", "V11.1", "V11.2",
                 "V11.4",
                 "V12.0",
                 "V17", "V17.0",
                 "V18.4",
                 "V40", "V40.0", "V40.1", "V40.2", "V40.3", "V40.4", "V40.5", "V40.6", "V40.7", "V40.8", "V40.9",
                 "V41", "V41.0", "V41.1", "V41.2", "V41.3", "V41.4", "V41.5", "V41.6", "V41.7", "V41.8", "V41.9",
                 "V79", "V79.0", "V79.1", "V79.2", "V79.3", "V79.4", "V79.5", "V79.6", "V79.7", "V79.8", "V79.9")
icd9_vector <- paste(icd9_vector,collapse="|")
# Look for ICD 10 prevalence
full_icd10_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD10CM" | full_icd_df$source_vocabulary == "ICD10PCS",]
individuals <- c()
matching_rows <- full_icd10_df[grep(icd10_vector,full_icd10_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(individuals)
# Look for ICD 9 prevalence
full_icd9_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD9CM",]
matching_rows <- full_icd9_df[grep(icd9_vector,full_icd9_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(unique(individuals))
paste0("Cohort specific cases: ",nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,]))
paste0("Cohort specific prev: ",(nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,])/nrow(final_aou_data_complete))*100 )
aou_individuals <- final_aou_data_complete[final_aou_data_complete$id %in% individuals,]$id
weighted_case_df <- data.frame(id = aou_individuals,case=1)
weighted_control_df <- data.frame(id = setdiff(final_aou_data_complete$id,aou_individuals),case=0)
weighted_prev_df <- rbind(weighted_case_df,weighted_control_df)
weighted_prev_df <- left_join(weighted_prev_df,aou_weights_int_propensity,by="id")
paste0("Weighted cohort specific cases: ",sum(weighted_prev_df[weighted_prev_df$case==1,]$weight))
paste0("Weighted cohort specific prevalence: ",(sum(weighted_prev_df[weighted_prev_df$case==1,]$weight)/sum(weighted_prev_df$weight))*100)

# Muscoloskeletal disorders
icd10_vector <- c("I27.1",
                  "I67.7",
                  "L93", "L93.0", "L93.1", "L93.2",
                  "M00", "M00.0", "M00.1", "M00.2", "M00.8", "M00.9",
                  "M01", "M01.0", "M01.1", "M01.2", "M01.3", "M01.4", "M01.5", "M01.6", "M01.8", "M01.9",
                  "M02", "M02.0", "M02.1", "M02.2", "M02.3", "M02.8", "M02.9",
                  "M03", "M03.0", "M03.2", "M03.3", "M03.4", "M03.5", "M03.6",
                  "M05", "M05.0", "M05.1", "M05.2", "M05.3", "M05.4", "M05.5", "M05.6", "M05.7", "M05.8", "M05.9",
                  "M06", "M06.0", "M06.1", "M06.2", "M06.3", "M06.4", "M06.8", "M06.9",
                  "M07", "M07.0", "M07.1", "M07.2", "M07.3", "M07.4", "M07.5", "M07.6", "M07.8", "M07.9",
                  "M08", "M08.0", "M08.1", "M08.2", "M08.3", "M08.4", "M08.8", "M08.9",
                  "M09", "M09.0", "M09.1", "M09.2", "M09.3", "M09.4", "M09.5", "M09.8",
                  "M30", "M30.0", "M30.1", "M30.2", "M30.3", "M30.8", "M30.9",
                  "M31", "M31.0", "M31.1", "M31.2", "M31.3", "M31.4", "M31.5", "M31.6", "M31.7", "M31.8", "M31.9",
                  "M32", "M32.0", "M32.1", "M32.2", "M32.8", "M32.9",
                  "M34", "M34.0", "M34.1", "M34.2", "M34.3", "M34.8", "M34.9",
                  "M35", "M35.0", "M35.1", "M35.2", "M35.3", "M35.4", "M35.5", "M35.6", "M35.7", "M35.8", "M35.9",
                  "M36", "M36.0", "M36.1", "M36.2", "M36.3", "M36.8",
                  "M40", "M40.0", "M40.1", "M40.2", "M40.3", "M40.8", "M40.9",
                  "M41", "M41.0", "M41.1", "M41.2", "M41.3", "M41.4", "M41.5", "M41.8", "M41.9",
                  "M42", "M42.0", "M42.1", "M42.2", "M42.3", "M42.8", "M42.9",
                  "M43", "M43.0", "M43.1",
                  "M45", "M45.0", "M45.1", "M45.2", "M45.3", "M45.4", "M45.5", "M45.6", "M45.7", "M45.8", "M45.9",
                  "M46", "M46.0", "M46.1", "M46.2", "M46.3", "M46.4", "M46.5", "M46.8", "M46.9",
                  "M47", "M47.0", "M47.1", "M47.2", "M47.3", "M47.8", "M47.9",
                  "M48", "M48.0", "M48.1", "M48.2", "M48.3", "M48.4", "M48.5", "M48.6", "M48.8", "M48.9",
                  "M49", "M49.0", "M49.1", "M49.2",
                  "M50", "M50.0", "M50.1", "M50.2", "M50.3", "M50.8", "M50.9",
                  "M51", "M51.0", "M51.1", "M51.2", "M51.3", "M51.4", "M51.8", "M51.9",
                  "M53", "M53.0", "M53.1", "M53.2", "M53.3", "M53.8", "M53.9",
                  "M54", "M54.0", "M54.1", "M54.2", "M54.3", "M54.4", "M54.5", "M54.6", "M54.8", "M54.9",
                  "M61", "M61.0", "M61.1", "M61.2", "M61.3", "M61.4", "M61.5", "M61.6", "M61.8", "M61.9",
                  "M62", "M62.0", "M62.1", "M62.2", "M62.3", "M62.4", "M62.5", "M62.6", "M62.8", "M62.9",
                  "M63", "M63.0", "M63.1", "M63.2", "M63.3", "M63.4", "M63.5", "M63.6", "M63.8", "M63.89",
                  "M65", "M65.0", "M65.1", "M65.2", "M65.3", "M65.4", "M65.8", "M65.9",
                  "M66", "M66.0", "M66.1", "M66.2", "M66.3", "M66.4", "M66.5", "M66.6", "M66.8", "M66.9",
                  "M67", "M67.0", "M67.1", "M67.2", "M67.3", "M67.4", "M67.8", "M67.9",
                  "M68", "M68.0", "M68.1", "M68.2", "M68.3", "M68.4", "M68.8",
                  "M70", "M70.0", "M70.1", "M70.2", "M70.3", "M70.4", "M70.5", "M70.6", "M70.7", "M70.8", "M70.9",
                  "M71", "M71.0", "M71.1",
                  "M72", "M72.0", "M72.1", "M72.2", "M72.3", "M72.4", "M72.8",
                  "M73",
                  "M75", "M75.0", "M75.1", "M75.2", "M75.3", "M75.4", "M75.5", "M75.6", "M75.7", "M75.8", "M75.9",
                  "M76", "M76.0", "M76.1", "M76.2", "M76.3", "M76.4", "M76.5", "M76.6", "M76.7", "M76.8", "M76.9",
                  "M77", "M77.0", "M77.1", "M77.2", "M77.3", "M77.4", "M77.5", "M77.8", "M77.9",
                  "M79", "M79.0", "M79.1", "M79.2", "M79.3", "M79.4", "M79.5", "M79.6", "M79.61", "M79.62", "M79.63", "M79.64", "M79.65", "M79.66", "M79.67", "M79.676",
                  "M79.8", "M79.81", "M79.82", "M79.83", "M79.89",
                  "M80", "M80.0", "M80.1", "M80.2", "M80.3", "M80.4", "M80.8", "M80.9",
                  "M81", "M81.0", "M81.1", "M81.2", "M81.3", "M81.4", "M81.8", "M81.9",
                  "M82", "M82.0", "M82.1", "M82.2", "M82.3", "M82.4", "M82.8",
                  "M86", "M86.3", "M86.4",
                  "M87", "M87.0", "M87.2", "M87.3", "M87.4", "M87.5", "M87.8", "M87.9", "M87.09",
                  "M88", "M88.0", "M88.1", "M88.2", "M88.8", "M88.9",
                  "M89", "M89.0", "M89.1", "M89.2", "M89.3", "M89.4", "M89.5", "M89.51", "M89.52", "M89.53", "M89.54", "M89.55", "M89.56", "M89.57", "M89.58", "M89.59",
                  "M89.7", "M89.8", "M89.9",
                  "M90", "M90.0", "M90.1", "M90.2", "M90.3", "M90.4", "M90.5", "M90.8", "M90.9",
                  "M91", "M91.0", "M91.1", "M91.2", "M91.3", "M91.4", "M91.5", "M91.6", "M91.8", "M91.9",
                  "M92", "M92.0", "M92.1", "M92.2", "M92.3", "M92.4", "M92.5", "M92.6", "M92.7", "M92.8", "M92.9",
                  "M93", "M93.0", "M93.1", "M93.2", "M93.3", "M93.4", "M93.5", "M93.8", "M93.9",
                  "M94", "M94.0", "M94.1", "M94.2", "M94.3", "M94.4", "M94.5", "M94.8", "M94.9",
                  "M95", "M95.0", "M95.1", "M95.2", "M95.3", "M95.4", "M95.5", "M95.8", "M95.9",
                  "M99", "M99.0", "M99.1", "M99.2", "M99.3", "M99.4", "M99.5", "M99.6", "M99.7", "M99.8", "M99.9",
                  "Z13.82", "Z13.83",
                  "Z82.6", "Z82.61", "Z82.62", "Z82.63", "Z82.64", "Z82.65", "Z82.66", "Z82.67", "Z82.68", "Z82.69",
                  "Z87.3", "Z87.30", "Z87.31", "Z87.32", "Z87.33", "Z87.34", "Z87.35", "Z87.36", "Z87.37", "Z87.38", "Z87.39")
icd10_vector <- paste(icd10_vector,collapse="|")
icd9_vector <- c("416.1",
                 "437.4",
                 "446", "446.0", "446.1", "446.2", "446.3", "446.4", "446.5", "446.6", "446.7", "446.8", "446.9",
                 "695.4", "695.5",
                 "710", "710.0", "710.1", "710.2", "710.5", "710.8", "710.9",
                 "711", "711.0", "711.1", "711.2", "711.3", "711.4", "711.5", "711.6", "711.7", "711.8", "711.9",
                 "714", "714.0", "714.1", "714.2", "714.3", "714.8", "714.9",
                 "730.1",
                 "732", "732.0", "732.1", "732.2", "732.3", "732.4", "732.5", "732.6", "732.7", "732.8", "732.9",
                 "733", "733.0", "733.1",
                 "274", "274.0", "274.1", "274.2", "274.3", "274.4", "274.5", "274.6", "274.7", "274.8", "274.9",
                 "353.1", "353.2", "353.3", "353.4",
                 "710.5", "710.8", "710.9",
                 "711.0", "711.1", "711.2", "711.3", "711.4", "711.5", "711.6", "711.7", "711.8", "711.9",
                 "712", "712.0", "712.1", "712.2", "712.3", "712.4", "712.5", "712.6", "712.7", "712.8", "712.9",
                 "713", "713.0", "713.1", "713.2", "713.3", "713.4", "713.5", "713.6", "713.7", "713.8", "713.9",
                 "714.0", "714.1", "714.2", "714.3", "714.8", "714.9",
                 "715", "715.0", "715.1", "715.2", "715.3", "715.4", "715.5", "715.6", "715.7", "715.8", "715.9",
                 "716", "716.0", "716.1", "716.2", "716.3", "716.4", "716.5", "716.6", "716.7", "716.8", "716.9",
                 "717", "717.0", "717.1", "717.2", "717.3", "717.4", "717.5", "717.6", "717.7", "717.8", "717.9",
                 "718", "718.0", "718.1", "718.2", "718.3", "718.4", "718.5", "718.6", "718.7", "718.8", "718.9",
                 "719", "719.0", "719.1", "719.2", "719.3", "719.4", "719.5", "719.6", "719.7", "719.8", "719.9",
                 "720", "720.0", "720.1", "720.2", "720.8", "720.9",
                 "721", "721.0", "721.1", "721.2", "721.3", "721.4", "721.5", "721.6", "721.7", "721.8", "721.9",
                 "722", "722.0", "722.1", "722.2", "722.3", "722.4", "722.5", "722.6", "722.7", "722.8", "722.9",
                 "723", "723.0", "723.1", "723.2", "723.3", "723.4", "723.5", "723.6", "723.7", "723.8", "723.9",
                 "724", "724.0", "724.1", "724.2", "724.3", "724.4", "724.5", "724.6", "724.7", "724.8", "724.9",
                 "726", "726.0", "726.1", "726.2", "726.3", "726.4", "726.5", "726.6", "726.7", "726.8", "726.9",
                 "727", "727.0", "727.1", "727.2", "727.3", "727.4", "727.5", "727.6", "727.7", "727.8", "727.9",
                 "729", "729.0", "729.1", "729.2", "729.3", "729.4", "729.5", "729.6", "729.7", "729.8", "729.9",
                 "730", "730.0", "730.1", "730.2", "730.3", "730.4", "730.5", "730.6", "730.7", "730.8", "730.9",
                 "V13.4", "V13.40", "V13.41", "V13.42", "V13.43", "V13.44", "V13.45", "V13.46", "V13.47", "V13.48", "V13.49",
                 "V13.5", "V13.50", "V13.51", "V13.52", "V13.53", "V13.54", "V13.55", "V13.56", "V13.57", "V13.58", "V13.59",
                 "V17.7", "V17.70", "V17.71", "V17.72", "V17.73", "V17.74", "V17.75", "V17.76", "V17.77", "V17.78", "V17.79",
                 "V17.8", "V17.80", "V17.81", "V17.82", "V17.83", "V17.84", "V17.85", "V17.86", "V17.87", "V17.88", "V17.89",
                 "V43.6", "V43.60", "V43.61", "V43.62", "V43.63", "V43.64", "V43.65", "V43.66", "V43.67", "V43.68", "V43.69",
                 "V43.7", "V43.70", "V43.71", "V43.72", "V43.73", "V43.74", "V43.75", "V43.76", "V43.77", "V43.78", "V43.79",
                 "V43.8", "V43.80", "V43.81", "V43.82", "V43.83", "V43.84", "V43.85", "V43.86", "V43.87", "V43.88", "V43.89",
                 "V58.64", "V58.65", "V58.78",
                 "V77.5",
                 "V82.1", "V82.10", "V82.11", "V82.12", "V82.13", "V82.14", "V82.15", "V82.16", "V82.17", "V82.18", "V82.19",
                 "V82.2", "V82.20", "V82.21", "V82.22", "V82.23", "V82.24", "V82.25", "V82.26", "V82.27", "V82.28", "V82.29")
icd9_vector <- paste(icd9_vector,collapse="|")
# Look for ICD 10 prevalence
full_icd10_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD10CM" | full_icd_df$source_vocabulary == "ICD10PCS",]
individuals <- c()
matching_rows <- full_icd10_df[grep(icd10_vector,full_icd10_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(individuals)
# Look for ICD 9 prevalence
full_icd9_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD9CM",]
matching_rows <- full_icd9_df[grep(icd9_vector,full_icd9_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(unique(individuals))
paste0("Cohort specific cases: ",nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,]))
paste0("Cohort specific prev: ",(nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,])/nrow(final_aou_data_complete))*100 )
aou_individuals <- final_aou_data_complete[final_aou_data_complete$id %in% individuals,]$id
weighted_case_df <- data.frame(id = aou_individuals,case=1)
weighted_control_df <- data.frame(id = setdiff(final_aou_data_complete$id,aou_individuals),case=0)
weighted_prev_df <- rbind(weighted_case_df,weighted_control_df)
weighted_prev_df <- left_join(weighted_prev_df,aou_weights_int_propensity,by="id")
paste0("Weighted cohort specific cases: ",sum(weighted_prev_df[weighted_prev_df$case==1,]$weight))
paste0("Weighted cohort specific prevalence: ",(sum(weighted_prev_df[weighted_prev_df$case==1,]$weight)/sum(weighted_prev_df$weight))*100)

# Neoplasms
icd10_vector <- c("C00", "C00.0", "C00.1", "C00.2", "C00.3", "C00.4", "C00.5", "C00.6", "C00.8", "C00.9",
                  "C01", "C02", "C02.0", "C02.1", "C02.2", "C02.3", "C02.4", "C02.8", "C02.9", "C03",
                  "C03.0", "C03.1", "C03.9", "C04", "C04.0", "C04.1", "C04.8", "C04.9", "C05", "C05.0",
                  "C05.1", "C05.2", "C05.8", "C05.9", "C06", "C06.0", "C06.1", "C06.2", "C06.8", "C06.9",
                  "C07", "C08", "C08.0", "C08.1", "C08.8", "C09", "C09.0", "C09.1", "C09.8", "C09.9",
                  "C10", "C10.0", "C10.1", "C10.2", "C10.3", "C10.4", "C10.8", "C10.9", "C11", "C11.0",
                  "C11.1", "C11.2", "C11.3", "C11.8", "C11.9", "C12", "C13", "C13.0", "C13.1", "C13.2",
                  "C13.8", "C13.9", "C15", "C15.0", "C15.1", "C15.2", "C15.3", "C15.4", "C15.5", "C15.8",
                  "C15.9", "C16", "C16.0", "C16.1", "C16.2", "C16.3", "C16.4", "C16.5", "C16.6", "C16.8",
                  "C16.9", "C17", "C17.0", "C17.1", "C17.2", "C17.3", "C17.8", "C17.9", "C18", "C18.0",
                  "C18.1", "C18.2", "C18.3", "C18.4", "C18.5", "C18.6", "C18.7", "C18.8", "C18.9", "C19",
                  "C20", "C21", "C21.0", "C21.1", "C21.2", "C21.8", "C22", "C22.0", "C22.1", "C22.2",
                  "C22.3", "C22.4", "C22.7", "C23", "C24", "C24.0", "C24.1", "C24.8", "C24.9", "C25",
                  "C25.0", "C25.1", "C25.2", "C25.3", "C25.4", "C25.7", "C25.8", "C25.9", "C26", "C26.0",
                  "C26.1", "C26.8", "C26.9", "C30", "C30.0", "C30.1", "C31", "C31.0", "C31.1", "C31.2",
                  "C31.3", "C31.4", "C31.8", "C31.9", "C32", "C32.0", "C32.1", "C32.2", "C32.3", "C32.8",
                  "C32.9", "C33", "C34", "C34.0", "C34.00", "C34.01", "C34.1", "C34.10", "C34.11", "C34.2",
                  "C34.20", "C34.21", "C34.3", "C34.30", "C34.31", "C34.8", "C34.80", "C34.81", "C34.9",
                  "C34.90", "C34.91", "C37", "C37.0", "C38", "C38.0", "C38.1", "C38.2", "C38.3", "C38.4",
                  "C38.8", "C39", "C39.0", "C39.8", "C39.9", "C40", "C40.0", "C40.1", "C40.2", "C40.3",
                  "C40.8", "C40.9", "C41", "C41.0", "C41.1", "C41.2", "C41.3", "C41.4", "C41.8", "C41.9",
                  "C43", "C43.0", "C43.1", "C43.2", "C43.3", "C43.4", "C43.5", "C43.6", "C43.7", "C43.8",
                  "C43.9", "C44", "C44.0", "C44.1", "C44.2", "C44.3", "C44.4", "C44.5", "C44.6", "C44.7",
                  "C44.8", "C44.9", "C45", "C45.0", "C45.1", "C45.2", "C45.7", "C45.9", "C46", "C47",
                  "C47.0", "C47.1", "C47.2", "C47.3", "C47.4", "C47.5", "C47.6", "C47.8", "C47.9", "C48",
                  "C48.0", "C48.1", "C48.2", "C48.8", "C49", "C49.0", "C49.1", "C49.2", "C49.3", "C49.4",
                  "C49.5", "C49.6", "C49.7", "C49.8", "C49.9", "C4A", "C4A.0", "C4A.1", "C4A.2", "C4A.3",
                  "C4A.4", "C4A.5", "C4A.6", "C4A.7", "C4A.8", "C4A.9", "C50", "C50.0", "C50.00", "C50.01",
                  "C50.1", "C50.10", "C50.11", "C50.2", "C50.20", "C50.21", "C50.3", "C50.30", "C50.31",
                  "C50.4", "C50.40", "C50.41", "C50.5", "C50.50", "C50.51", "C50.6", "C50.60", "C50.61",
                  "C50.8", "C50.9", "C50.90", "C50.91", "C51", "C51.0", "C51.1", "C51.2", "C51.8", "C51.9",
                  "C52", "C53", "C53.0", "C53.1", "C53.8", "C53.9", "C54", "C54.0", "C54.1", "C54.2",
                  "C54.3", "C54.8", "C54.9", "C55", "C56", "C56.0", "C56.1", "C56.2", "C56.9", "C57",
                  "C57.0", "C57.1", "C57.2", "C57.3", "C57.4", "C57.7", "C57.8", "C58", "C58.0", "C60",
                  "C60.0", "C60.1", "C60.2", "C60.8", "C60.9", "C61", "C62", "C62.0", "C62.1", "C62.9",
                  "C63", "C63.0", "C63.1", "C63.2", "C63.7", "C63.8", "C64", "C64.0", "C64.1", "C64.2",
                  "C64.9", "C65", "C65.0", "C65.1", "C65.2", "C65.9", "C66", "C66.0", "C66.1", "C66.2",
                  "C66.9", "C67", "C67.0", "C67.1", "C67.2", "C67.3", "C67.4", "C67.5", "C67.6", "C67.7",
                  "C67.8", "C67.9", "C68", "C68.0", "C68.1", "C68.2", "C68.8", "C69", "C69.0", "C69.1",
                  "C69.2", "C69.3", "C69.4", "C69.5", "C69.6", "C69.7", "C69.8", "C70", "C70.0", "C70.1",
                  "C70.9", "C71", "C71.0", "C71.1", "C71.2", "C71.3", "C71.4", "C71.5", "C71.6", "C71.7",
                  "C71.8", "C71.9", "C72", "C72.0", "C72.1", "C72.2", "C72.3", "C72.4", "C72.5", "C72.8",
                  "C72.9", "C73", "C74", "C74.0", "C74.1", "C74.9", "C75", "C75.0", "C75.1", "C75.2",
                  "C75.3", "C75.4", "C75.5", "C75.8", "C75.9", "C76", "C76.0", "C76.1", "C76.2", "C76.3",
                  "C76.4", "C76.5", "C76.6", "C76.7", "C76.8", "C76.9", "C77", "C77.0", "C77.1", "C77.2",
                  "C77.3", "C77.4", "C77.5", "C77.8", "C77.9", "C78", "C78.0", "C78.1", "C78.2", "C78.3",
                  "C78.4", "C78.5", "C78.6", "C78.7", "C78.8", "C78.9", "C79", "C79.0", "C79.1", "C79.2",
                  "C79.3", "C79.4", "C79.5", "C79.6", "C79.7", "C79.8", "C79.9", "C80", "C80.0", "C80.1",
                  "C80.2", "C80.3", "C80.8", "C80.9", "C81", "C81.0", "C81.00", "C81.01", "C81.02", "C81.03",
                  "C81.04", "C81.05", "C81.06", "C81.07", "C81.08", "C81.1", "C81.10", "C81.11", "C81.12",
                  "C81.13", "C81.14", "C81.15", "C81.16", "C81.17", "C81.18", "C81.2", "C81.20", "C81.21",
                  "C81.22", "C81.23", "C81.24", "C81.25", "C81.26", "C81.27", "C81.28", "C81.3", "C81.30",
                  "C81.31", "C81.32", "C81.33", "C81.34", "C81.35", "C81.36", "C81.37", "C81.38", "C81.4",
                  "C81.40", "C81.41", "C81.42", "C81.43", "C81.44", "C81.45", "C81.46", "C81.47", "C81.48",
                  "C81.49", "C81.7", "C81.70", "C81.71", "C81.72", "C81.73", "C81.74", "C81.75", "C81.76",
                  "C81.77", "C81.78", "C81.79", "C81.9", "C81.90", "C81.91", "C81.92", "C81.93", "C81.94",
                  "C81.95", "C81.96", "C81.97", "C81.98", "C82", "C82.0", "C82.00", "C82.01", "C82.02",
                  "C82.03", "C82.04", "C82.05", "C82.06", "C82.07", "C82.08", "C82.1", "C82.10", "C82.11",
                  "C82.12", "C82.13", "C82.14", "C82.15", "C82.16", "C82.17", "C82.18", "C82.2", "C82.20",
                  "C82.21", "C82.22", "C82.23", "C82.24", "C82.25", "C82.26", "C82.27", "C82.28", "C82.3",
                  "C82.30", "C82.31", "C82.32", "C82.33", "C82.34", "C82.35", "C82.36", "C82.37", "C82.38",
                  "C82.4", "C82.40", "C82.41", "C82.42", "C82.43", "C82.44", "C82.45", "C82.46", "C82.47",
                  "C82.48", "C82.5", "C82.50", "C82.51", "C82.52", "C82.53", "C82.54", "C82.55", "C82.56",
                  "C82.57", "C82.58", "C82.6", "C82.60", "C82.61", "C82.62", "C82.63", "C82.64", "C82.65",
                  "C82.66", "C82.67", "C82.68", "C82.7", "C82.70", "C82.71", "C82.72", "C82.73", "C82.74",
                  "C82.75", "C82.76", "C82.77", "C82.78", "C82.8", "C82.80", "C82.81", "C82.82", "C82.83",
                  "C82.84", "C82.85", "C82.86", "C82.87", "C82.88", "C82.9", "C82.90", "C82.91", "C82.92",
                  "C82.93", "C82.94", "C82.95", "C82.96", "C82.97", "C82.98", "C83", "C83.0", "C83.00",
                  "C83.01", "C83.02", "C83.03", "C83.04", "C83.05", "C83.06", "C83.07", "C83.08", "C83.1",
                  "C83.10", "C83.11", "C83.12", "C83.13", "C83.14", "C83.15", "C83.16", "C83.17", "C83.18",
                  "C83.2", "C83.20", "C83.21", "C83.22", "C83.23", "C83.24", "C83.25", "C83.26", "C83.27",
                  "C83.28", "C83.3", "C83.30", "C83.31", "C83.32", "C83.33", "C83.34", "C83.35", "C83.36",
                  "C83.37", "C83.38", "C83.4", "C83.40", "C83.41", "C83.42", "C83.43", "C83.44", "C83.45",
                  "C83.46", "C83.47", "C83.48", "C83.5", "C83.50", "C83.51", "C83.52", "C83.53", "C83.54",
                  "C83.55", "C83.56", "C83.57", "C83.58", "C83.6", "C83.60", "C83.61", "C83.62", "C83.63",
                  "C83.64", "C83.65", "C83.66", "C83.67", "C83.68", "C83.7", "C83.70", "C83.71", "C83.72",
                  "C83.73", "C83.74", "C83.75", "C83.76", "C83.77", "C83.78", "C83.8", "C83.80", "C83.81",
                  "C83.82", "C83.83", "C83.84", "C83.85", "C83.86", "C83.87", "C83.88", "C83.9", "C83.90",
                  "C83.91", "C83.92", "C83.93", "C83.94", "C83.95", "C83.96", "C83.97", "C83.98", "C84",
                  "C84.0", "C84.00", "C84.01", "C84.02", "C84.03", "C84.04", "C84.05", "C84.06", "C84.07",
                  "C84.08", "C84.1", "C84.10", "C84.11", "C84.12", "C84.13", "C84.14", "C84.15", "C84.16",
                  "C84.17", "C84.18", "C84.4", "C84.40", "C84.41", "C84.42", "C84.43", "C84.44", "C84.45",
                  "C84.46", "C84.47", "C84.48", "C84.6", "C84.60", "C84.61", "C84.62", "C84.63", "C84.64",
                  "C84.65", "C84.66", "C84.67", "C84.68", "C84.7", "C84.70", "C84.71", "C84.72", "C84.73",
                  "C84.74", "C84.75", "C84.76", "C84.77", "C84.78", "C84.9", "C84.90", "C84.91", "C84.92",
                  "C84.93", "C84.94", "C84.95", "C84.96", "C84.97", "C84.98", "C85", "C85.0", "C85.00",
                  "C85.01", "C85.02", "C85.03", "C85.04", "C85.05", "C85.06", "C85.07", "C85.08", "C85.1",
                  "C85.10", "C85.11", "C85.12", "C85.13", "C85.14", "C85.15", "C85.16", "C85.17", "C85.18",
                  "C85.2", "C85.20", "C85.21", "C85.22", "C85.23", "C85.24", "C85.25", "C85.26", "C85.27",
                  "C85.28", "C85.7", "C85.70", "C85.71", "C85.72", "C85.73", "C85.74", "C85.75", "C85.76",
                  "C85.77", "C85.78", "C85.9", "C85.90", "C85.91", "C85.92", "C85.93", "C85.94", "C85.95",
                  "C85.96", "C85.97", "C85.98", "C86", "C86.0", "C86.1", "C86.2", "C86.3", "C86.4", "C86.5",
                  "C86.6", "C88", "C88.0", "C88.1", "C88.2", "C88.3", "C88.4", "C88.8", "C90", "C90.0",
                  "C90.00", "C90.01", "C90.02", "C90.1", "C90.10", "C90.11", "C90.12", "C90.2", "C90.20",
                  "C90.21", "C90.22", "C90.3", "C90.30", "C90.31", "C90.32", "C91", "C91.0", "C91.00",
                  "C91.01", "C91.02", "C91.1", "C91.10", "C91.11", "C91.12", "C91.2", "C91.3", "C91.4",
                  "C91.40", "C91.41", "C91.42", "C91.5", "C91.50", "C91.51", "C91.52", "C91.6", "C91.9",
                  "C91.90", "C91.91", "C91.92", "C92", "C92.0", "C92.00", "C92.01", "C92.02", "C92.1",
                  "C92.10", "C92.11", "C92.12", "C92.2", "C92.20", "C92.21", "C92.22", "C92.3", "C92.30",
                  "C92.31", "C92.32", "C92.4", "C92.40", "C92.41", "C92.42", "C92.5", "C92.50", "C92.51",
                  "C92.52", "C92.6", "C92.60", "C92.61", "C92.62", "C92.9", "C92.90", "C92.91", "C92.92",
                  "C93", "C93.0", "C93.00", "C93.01", "C93.02", "C93.1", "C93.10", "C93.11", "C93.12",
                  "C93.3", "C93.30", "C93.31", "C93.32", "C93.8", "C93.80", "C93.81", "C93.82", "C93.9",
                  "C93.90", "C93.91", "C93.92", "C94", "C94.0", "C94.1", "C94.2", "C94.3", "C94.4", "C94.5",
                  "C94.6", "C94.80", "C94.81", "C94.82", "C94.83", "C94.84", "C94.85", "C94.86", "C94.87",
                  "C94.88", "C94.9", "C95", "C95.0", "C95.00", "C95.01", "C95.02", "C95.1", "C95.10",
                  "C95.11", "C95.12", "C95.2", "C95.20", "C95.21", "C95.22", "C95.3", "C95.30", "C95.31",
                  "C95.32", "C95.7", "C95.70", "C95.71", "C95.72", "C96", "C96.0", "C96.1", "C96.2",
                  "C96.3", "C96.4", "C96.5", "C96.6", "C96.8", "C96.9", "D00", "D00.0", "D00.1", "D00.2",
                  "D00.3", "D00.4", "D00.5", "D00.6", "D00.7", "D00.8", "D00.9", "D01", "D01.0", "D01.1",
                  "D01.2", "D01.3", "D01.4", "D01.5", "D01.6", "D01.7", "D01.8", "D01.9", "D02", "D02.0",
                  "D02.1", "D02.2", "D02.3", "D02.4", "D02.5", "D02.6", "D02.7", "D02.8", "D02.9", "D03",
                  "D03.0", "D03.1", "D03.2", "D03.3", "D03.4", "D03.5", "D03.6", "D03.7", "D03.8", "D03.9",
                  "D04", "D04.0", "D04.1", "D04.2", "D04.3", "D04.4", "D04.5", "D04.6", "D04.7", "D04.8",
                  "D04.9", "D05", "D05.0", "D05.1", "D05.2", "D05.7", "D05.9", "D06", "D06.0", "D06.1",
                  "D06.2", "D06.7", "D06.9", "D07", "D07.0", "D07.1", "D07.2", "D07.3", "D07.4", "D07.5",
                  "D07.6", "D07.7", "D07.8", "D07.9", "D09", "D09.0", "D09.1", "D09.2", "D09.3", "D09.8",
                  "D09.9", "D10", "D10.0", "D10.1", "D10.2", "D10.3", "D10.4", "D10.5", "D10.6", "D10.7",
                  "D10.8", "D10.9", "D11", "D11.0", "D11.1", "D11.2", "D11.3", "D11.4", "D11.5", "D11.6",
                  "D11.7", "D11.8", "D11.9", "D12", "D12.0", "D12.1", "D12.2", "D12.3", "D12.4", "D12.5",
                  "D12.6", "D12.7", "D12.8", "D12.9", "D13", "D13.0", "D13.1", "D13.2", "D13.3", "D13.4",
                  "D13.5", "D13.6", "D13.7", "D13.8", "D13.9", "D14", "D14.0", "D14.1", "D14.2", "D14.3",
                  "D14.4", "D14.5", "D14.6", "D14.7", "D14.8", "D14.9", "D15", "D15.0", "D15.1", "D15.2",
                  "D15.3", "D15.4", "D15.5", "D15.6", "D15.7", "D15.8", "D15.9", "D16", "D16.0", "D16.1",
                  "D16.2", "D16.3", "D16.4", "D16.5", "D16.6", "D16.7", "D16.8", "D16.9", "D17", "D17.0",
                  "D17.1", "D17.2", "D17.3", "D17.4", "D17.5", "D17.6", "D17.7", "D17.8", "D17.9", "D18",
                  "D18.0", "D18.1", "D18.2", "D18.3", "D18.4", "D18.5", "D18.6", "D18.7", "D18.8", "D18.9",
                  "D19", "D19.0", "D19.1", "D19.2", "D19.7", "D19.9", "D20", "D20.0", "D20.1", "D20.2",
                  "D20.3", "D20.4", "D20.5", "D20.6", "D20.7", "D20.8", "D20.9", "D21", "D21.0", "D21.1",
                  "D21.2", "D21.3", "D21.4", "D21.5", "D21.6", "D21.7", "D21.8", "D21.9", "D22", "D22.0",
                  "D22.1", "D22.2", "D22.3", "D22.4", "D22.5", "D22.6", "D22.7", "D22.8", "D22.9", "D23",
                  "D23.0", "D23.1", "D23.2", "D23.3", "D23.4", "D23.5", "D23.6", "D23.7", "D23.8", "D23.9",
                  "D24", "D24.0", "D24.1", "D24.2", "D24.3", "D24.4", "D24.5", "D24.6", "D24.7", "D24.8",
                  "D24.9", "D25", "D25.0", "D25.1", "D25.2", "D25.3", "D25.4", "D25.5", "D25.6", "D25.7",
                  "D25.8", "D25.9", "D26", "D26.0", "D26.1", "D26.2", "D26.3", "D26.4", "D26.5", "D26.6",
                  "D26.7", "D26.8", "D26.9", "D27", "D27.0", "D27.1", "D27.2", "D27.3", "D27.4", "D27.5",
                  "D27.6", "D27.7", "D27.8", "D27.9", "D28", "D28.0", "D28.1", "D28.2", "D28.7", "D28.9",
                  "D29", "D29.0", "D29.1", "D29.2", "D29.3", "D29.4", "D29.5", "D29.6", "D29.7", "D29.8",
                  "D29.9", "D30", "D30.0", "D30.1", "D30.2", "D30.3", "D30.4", "D30.7", "D30.8", "D30.9",
                  "D31", "D31.0", "D31.1", "D31.2", "D31.3", "D31.4", "D31.5", "D31.6", "D31.7", "D31.8",
                  "D31.9", "D32", "D32.0", "D32.1", "D32.2", "D32.3", "D32.4", "D32.5", "D32.6", "D32.7",
                  "D32.8", "D32.9", "D33", "D33.0", "D33.1", "D33.2", "D33.3", "D33.4", "D33.5", "D33.6",
                  "D33.7", "D33.8", "D33.9", "D34", "D34.0", "D34.1", "D34.2", "D34.3", "D34.4", "D34.5",
                  "D34.6", "D34.7", "D34.8", "D34.9", "D35", "D35.0", "D35.1", "D35.2", "D35.3", "D35.4",
                  "D35.5", "D35.6", "D35.7", "D35.8", "D35.9", "D36", "D36.0", "D36.1", "D36.2", "D36.3",
                  "D36.4", "D36.5", "D36.6", "D36.7", "D36.8", "D36.9", "D37", "D37.0", "D37.1", "D37.2",
                  "D37.3", "D37.4", "D37.5", "D37.7", "D37.9", "D38", "D38.0", "D38.1", "D38.2", "D38.3",
                  "D38.4", "D38.5", "D38.6", "D38.7", "D38.8", "D38.9", "D39", "D39.0", "D39.1", "D39.2",
                  "D39.3", "D39.4", "D39.5", "D39.6", "D39.7", "D39.8", "D39.9", "D40", "D40.0", "D40.1",
                  "D40.2", "D40.3", "D40.7", "D40.9", "D41", "D41.0", "D41.1", "D41.2", "D41.3", "D41.4",
                  "D41.5", "D41.6", "D41.7", "D41.8", "D41.9", "D42", "D42.0", "D42.1", "D42.2", "D42.3",
                  "D42.4", "D42.5", "D42.6", "D42.7", "D42.8", "D42.9", "D43", "D43.0", "D43.1", "D43.2",
                  "D43.3", "D43.4", "D43.5", "D43.6", "D43.7", "D43.8", "D43.9", "D44", "D44.0", "D44.1",
                  "D44.2", "D44.3", "D44.4", "D44.5", "D44.6", "D44.7", "D44.8", "D44.9", "D45", "D46",
                  "D46.0", "D46.1", "D46.2", "D46.3", "D46.4", "D46.5", "D46.6", "D46.7", "D46.8", "D46.9",
                  "D47", "D47.0", "D47.1", "D47.2", "D47.3", "D47.4", "D47.5", "D47.6", "D47.7", "D47.8",
                  "D47.9", "D48", "D48.0", "D48.1", "D48.2", "D48.3", "D48.4", "D48.5", "D48.6", "D48.7",
                  "D48.8", "D48.9", "D49", "D49.0", "D49.1", "D49.2", "D49.3", "D49.4", "D49.5", "D49.6",
                  "D49.7", "D49.8", "D49.9", "E34.0", "K51.4", "K51.40", "K51.411", "K51.412", "K51.413",
                  "K51.414", "K51.415", "K51.416", "K51.418", "K51.419", "K62.0", "K62.1", "K62.2", "K62.3",
                  "K63.5", "N60", "N60.0", "N60.01", "N60.02", "N60.09", "N60.1", "N60.11", "N60.12", "N60.19",
                  "N60.2", "N60.21", "N60.22", "N60.29", "N60.3", "N60.31", "N60.32", "N60.39", "N60.4",
                  "N60.41", "N60.42", "N60.49", "N60.8", "N60.81", "N60.82", "N60.89", "N60.9", "N60.91",
                  "N60.92", "N60.99", "N84", "N84.0", "N84.1", "N87", "N87.0", "N87.1", "N87.9", "Z03.1",
                  "Z08", "Z08.0", "Z08.1", "Z08.2", "Z08.3", "Z08.4", "Z08.5", "Z08.8", "Z08.9", "Z09",
                  "Z09.0", "Z09.1", "Z09.2", "Z09.3", "Z09.4", "Z09.5", "Z09.8", "Z09.9", "Z12", "Z12.0",
                  "Z12.1", "Z12.2", "Z12.3", "Z12.4", "Z12.5", "Z12.6", "Z12.7", "Z12.8", "Z12.9", "Z80",
                  "Z80.0", "Z80.1", "Z80.2", "Z80.3", "Z80.4", "Z80.5", "Z80.6", "Z80.8", "Z80.9", "Z85",
                  "Z85.0", "Z85.00", "Z85.01", "Z85.02", "Z85.03", "Z85.04", "Z85.06", "Z85.07", "Z85.09",
                  "Z85.1", "Z85.10", "Z85.11", "Z85.12", "Z85.20", "Z85.21", "Z85.22", "Z85.23", "Z85.24",
                  "Z85.29", "Z85.3", "Z85.30", "Z85.31", "Z85.32", "Z85.41", "Z85.42", "Z85.43", "Z85.44",
                  "Z85.46", "Z85.47", "Z85.48", "Z85.49", "Z85.5", "Z85.50", "Z85.51", "Z85.528", "Z85.53",
                  "Z85.54", "Z85.55", "Z85.6", "Z85.60", "Z85.61", "Z85.62", "Z85.63", "Z85.71", "Z85.72",
                  "Z85.73", "Z85.74", "Z85.75", "Z85.76", "Z85.79", "Z85.81", "Z85.82", "Z85.830", "Z85.831",
                  "Z85.838", "Z85.84", "Z85.85", "Z85.89", "Z85.9", "Z85.91", "Z85.92", "Z85.93", "Z85.99",
                  "Z86", "Z86.0", "Z86.00", "Z86.01", "Z86.02", "Z86.03")
icd10_vector <- paste(icd10_vector,collapse="|")
icd9_vector <- c("140", "140.0", "140.1", "140.2", "140.3", "140.4", "140.5", "140.6", "140.8", "140.9",
                 "141", "141.0", "141.1", "141.2", "141.3", "141.4", "141.5", "141.6", "141.8", "141.9",
                 "142", "142.0", "142.1", "142.2", "142.3", "142.8", "142.9",
                 "143", "143.0", "143.1", "143.8", "143.9",
                 "144", "144.0", "144.1", "144.8", "144.9",
                 "145", "145.0", "145.1", "145.2", "145.3", "145.4", "145.5", "145.6", "145.8", "145.9",
                 "146", "146.0", "146.1", "146.2", "146.3", "146.4", "146.5", "146.6", "146.7", "146.8", "146.9",
                 "147", "147.0", "147.1", "147.2", "147.3", "147.8", "147.9",
                 "148", "148.0", "148.1", "148.2", "148.3", "148.8", "148.9",
                 "150", "150.0", "150.1", "150.2", "150.3", "150.4", "150.5", "150.8", "150.9",
                 "151", "151.0", "151.1", "151.2", "151.3", "151.4", "151.5", "151.6", "151.8", "151.9",
                 "152", "152.0", "152.1", "152.2", "152.3", "152.8", "152.9",
                 "153", "153.0", "153.1", "153.2", "153.3", "153.4", "153.5", "153.6", "153.7", "153.8", "153.9",
                 "154", "154.0", "154.1", "154.2", "154.3", "154.8", "154.9",
                 "155", "155.0", "155.1", "155.3",
                 "156", "156.0", "156.1", "156.2", "156.3", "156.8", "156.9",
                 "157", "157.0", "157.1", "157.2", "157.3", "157.4", "157.8", "157.9",
                 "158", "158.0", "158.1", "158.2", "158.3", "158.4", "158.5", "158.6", "158.7", "158.8", "158.9",
                 "160", "160.0", "160.1", "160.2", "160.3", "160.4", "160.5", "160.8", "160.9",
                 "161", "161.0", "161.1", "161.2", "161.3", "161.8", "161.9",
                 "162", "162.0", "162.1", "162.2", "162.3", "162.4", "162.5", "162.8", "162.9",
                 "163", "163.0", "163.1", "163.8", "163.9",
                 "164", "164.0", "164.1", "164.2", "164.3", "164.8", "164.9",
                 "170", "170.0", "170.1", "170.2", "170.3", "170.4", "170.5", "170.6", "170.7", "170.8", "170.9",
                 "171", "171.0", "171.2", "171.3", "171.4", "171.5", "171.6", "171.7", "171.8", "171.9",
                 "172", "172.0", "172.1", "172.2", "172.3", "172.4", "172.5", "172.6", "172.7", "172.8", "172.9",
                 "173", "173.0", "173.1", "173.2", "173.3", "173.4", "173.5", "173.6", "173.7", "173.8", "173.9",
                 "174", "174.0", "174.1", "174.2", "174.3", "174.4", "174.5", "174.6", "174.8", "174.9",
                 "175", "175.0", "175.9",
                 "177", "177.0", "177.1", "177.2", "177.3", "177.4", "177.5", "177.6", "177.7", "177.8", "177.9",
                 "180", "180.0", "180.1", "180.8", "180.9",
                 "182", "182.0", "182.1", "182.8",
                 "183", "183.0", "183.2", "183.3", "183.4", "183.5", "183.8",
                 "184", "184.0", "184.1", "184.2", "184.3", "184.4", "184.8",
                 "185", "186", "186.0", "186.1", "186.2", "186.3", "186.8", "186.9",
                 "187", "187.1", "187.2", "187.3", "187.4", "187.5", "187.6", "187.7", "187.8",
                 "188", "188.0", "188.1", "188.2", "188.3", "188.4", "188.5", "188.6", "188.7", "188.8", "188.9",
                 "189", "189.0", "189.1", "189.2", "189.3", "189.4", "189.8",
                 "190", "190.0", "190.1", "190.2", "190.3", "190.4", "190.5", "190.6", "190.7", "190.8",
                 "191", "191.0", "191.1", "191.2", "191.3", "191.4", "191.5", "191.6", "191.7", "191.8", "191.9",
                 "192", "192.0", "192.1", "192.2", "192.3", "192.4", "192.5", "192.6", "192.8", "192.9",
                 "193",
                 "194", "194.1", "194.3", "194.4", "194.5", "194.8",
                 "200", "200.0", "200.1", "200.2", "200.3", "200.4", "200.5", "200.6", "200.7", "200.8",
                 "201", "201.0", "201.1", "201.2", "201.3", "201.4", "201.5", "201.6", "201.7", "201.8", "201.9",
                 "202", "202.0", "202.1", "202.2", "202.3", "202.4", "202.5", "202.6", "202.7", "202.8", "202.9",
                 "203", "203.0", "203.1", "203.8", "203.9",
                 "204", "204.0", "204.2",
                 "205", "205.0", "205.1", "205.2", "205.3",
                 "206", "206.0", "206.1",
                 "207", "207.0", "207.1", "207.2", "207.8", "207.9",
                 "208", "208.0", "208.1", "208.2", "208.8", "208.9",
                 "209", "209.0", "209.1", "209.4", "209.5",
                 "210", "210.0", "210.1", "210.2", "210.3", "210.4", "210.5", "210.6", "210.7", "210.8", "210.9",
                 "211", "211.0", "211.1", "211.2", "211.3", "211.4", "211.5", "211.6", "211.7", "211.8",
                 "212", "212.0", "212.1", "212.2", "212.3", "212.4", "212.5", "212.6", "212.7", "212.8",
                 "213", "213.0", "213.1", "213.2", "213.3", "213.4", "213.5", "213.6", "213.7", "213.8", "213.9",
                 "217", "217.0", "217.8",
                 "219", "219.0",
                 "220", "220.0", "220.1", "220.2", "220.3", "220.4", "220.5", "220.6", "220.7", "220.8", "220.9",
                 "221", "221.0", "221.1", "221.2", "221.3", "221.4", "221.5", "221.6", "221.7", "221.8",
                 "222", "222.0", "222.1", "222.2", "222.3", "222.4", "222.5", "222.6", "222.7", "222.8",
                 "223", "223.0", "223.1", "223.2", "223.3", "223.4", "223.5", "223.6", "223.7", "223.8",
                 "224", "224.0", "224.1", "224.2", "224.3", "224.4", "224.5", "224.6", "224.7", "224.8", "224.9",
                 "225", "225.0", "225.1", "225.2", "225.3", "225.4", "225.5", "225.6", "225.7", "225.8", "225.9",
                 "226",
                 "227", "227.0", "227.1", "227.2", "227.3", "227.4", "227.5", "227.6", "227.7", "227.8", "227.9",
                 "228", "228.0", "228.1", "228.2", "228.3", "228.4", "228.5", "228.6", "228.7", "228.8", "228.9",
                 "229", "229.0", "229.8",
                 "230", "230.1", "230.2", "230.3", "230.4", "230.5", "230.6", "230.7", "230.8",
                 "231", "231.0", "231.1", "231.2",
                 "232", "232.0", "232.1", "232.2", "232.3", "232.4", "232.5", "232.6", "232.7", "232.8", "232.9",
                 "233", "233.0", "233.1", "233.2", "233.4", "233.5", "233.7",
                 "234", "234.0", "234.1", "234.2", "234.3", "234.4", "234.5", "234.6", "234.7", "234.8",
                 "235", "235.0", "235.4", "235.6", "235.7", "235.8",
                 "236", "236.1", "236.2", "236.4", "236.5", "236.7",
                 "237", "237.0", "237.1", "237.2", "237.3", "237.5", "237.6", "237.70", "237.71", "237.72", "237.9",
                 "238", "238.0", "238.1", "238.2", "238.3", "238.4", "238.5", "238.6", "238.7", "238.8", "238.9",
                 "239", "239.2", "239.3", "239.4", "239.6", "239.9",
                 "569.0",
                 "610", "610.0", "610.1", "610.2", "610.3", "610.4", "610.5", "610.8", "610.9",
                 "622.1", "622.2", "622.7",
                 "V07.39",
                 "V10", "V10.0", "V10.1", "V10.2", "V10.3", "V10.4", "V10.5", "V10.6", "V10.7", "V10.8", "V10.9",
                 "V11",
                 "V13.22", "V13.23", "V13.24",
                 "V16", "V16.0", "V16.1", "V16.2", "V16.3", "V16.4", "V16.5", "V16.6", "V16.7", "V16.8", "V16.9",
                 "V42.4", "V42.81", "V42.82",
                 "V59.2", "V59.3",
                 "V72.32",
                 "V76", "V76.0", "V76.1", "V76.2", "V76.3", "V76.4", "V76.5", "V76.6", "V76.7", "V76.8", "V76.9")
icd9_vector <- paste(icd9_vector,collapse="|")
# Look for ICD 10 prevalence
full_icd10_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD10CM" | full_icd_df$source_vocabulary == "ICD10PCS",]
individuals <- c()
matching_rows <- full_icd10_df[grep(icd10_vector,full_icd10_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(individuals)
# Look for ICD 9 prevalence
full_icd9_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD9CM",]
matching_rows <- full_icd9_df[grep(icd9_vector,full_icd9_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(unique(individuals))
paste0("Cohort specific cases: ",nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,]))
paste0("Cohort specific prev: ",(nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,])/nrow(final_aou_data_complete))*100 )
aou_individuals <- final_aou_data_complete[final_aou_data_complete$id %in% individuals,]$id
weighted_case_df <- data.frame(id = aou_individuals,case=1)
weighted_control_df <- data.frame(id = setdiff(final_aou_data_complete$id,aou_individuals),case=0)
weighted_prev_df <- rbind(weighted_case_df,weighted_control_df)
weighted_prev_df <- left_join(weighted_prev_df,aou_weights_int_propensity,by="id")
paste0("Weighted cohort specific cases: ",sum(weighted_prev_df[weighted_prev_df$case==1,]$weight))
paste0("Weighted cohort specific prevalence: ",(sum(weighted_prev_df[weighted_prev_df$case==1,]$weight)/sum(weighted_prev_df$weight))*100)
Nutritional deficiencies
icd10_vector <- c("D50", "D50.1", "D50.2", "D50.3", "D50.8", "D51", "D51.0", "D51.1", "D51.2", "D51.3", "D51.8", "D51.9",
                  "D52", "D52.0", "D52.8", "D52.9", "D53", "D53.0", "D53.1", "D53.2", "D53.8", "D53.9",
                  "E00", "E00.0", "E00.1", "E00.2", "E00.9", "E01", "E01.0", "E01.1", "E01.2", "E01.8", "E01.9",
                  "E02", "E40", "E40.0", "E40.1", "E40.2", "E40.3", "E40.4", "E40.5", "E40.6", "E40.7", "E40.8", "E40.9",
                  "E41", "E41.0", "E41.1", "E41.2", "E41.3", "E41.4", "E41.5", "E41.6", "E41.7", "E41.8", "E41.9",
                  "E42", "E42.0", "E42.1", "E42.2", "E42.3", "E42.4", "E42.5", "E42.6", "E42.7", "E42.8", "E42.9",
                  "E43", "E43.0", "E43.1", "E43.2", "E43.3", "E43.4", "E43.5", "E43.6", "E43.7", "E43.8", "E43.9",
                  "E44", "E44.0", "E44.1", "E44.2", "E44.3", "E44.4", "E44.5", "E44.6", "E44.7", "E44.8", "E44.9",
                  "E45", "E45.0", "E45.1", "E45.2", "E45.3", "E45.4", "E45.5", "E45.6", "E45.7", "E45.8", "E45.9",
                  "E46", "E46.0", "E46.1", "E46.2", "E46.3", "E46.4", "E46.5", "E46.6", "E46.7", "E46.8", "E46.9",
                  "E50", "E50.0", "E50.1", "E50.2", "E50.3", "E50.4", "E50.5", "E50.6", "E50.7", "E50.8", "E50.9",
                  "E51", "E51.0", "E51.1", "E51.2", "E51.3", "E51.4", "E51.5", "E51.6", "E51.7", "E51.8", "E51.9",
                  "E52", "E52.0", "E52.1", "E52.2", "E52.3", "E52.4", "E52.5", "E52.6", "E52.7", "E52.8", "E52.9",
                  "E53", "E53.0", "E53.1", "E53.2", "E53.3", "E53.4", "E53.5", "E53.6", "E53.7", "E53.8", "E53.9",
                  "E54", "E54.0", "E54.1", "E54.2", "E54.3", "E54.4", "E54.5", "E54.6", "E54.7", "E54.8", "E54.9",
                  "E55", "E55.0", "E55.1", "E55.2", "E55.3", "E55.4", "E55.5", "E55.6", "E55.7", "E55.8", "E55.9",
                  "E56", "E56.0", "E56.1", "E56.2", "E56.3", "E56.4", "E56.5", "E56.6", "E56.7", "E56.8", "E56.9",
                  "E57", "E57.0", "E57.1", "E57.2", "E57.3", "E57.4", "E57.5", "E57.6", "E57.7", "E57.8", "E57.9",
                  "E58", "E58.0", "E58.1", "E58.2", "E58.3", "E58.4", "E58.5", "E58.6", "E58.7", "E58.8", "E58.9",
                  "E59", "E59.0", "E59.1", "E59.2", "E59.3", "E59.4", "E59.5", "E59.6", "E59.7", "E59.8", "E59.9",
                  "E60", "E60.0", "E60.1", "E60.2", "E60.3", "E60.4", "E60.5", "E60.6", "E60.7", "E60.8", "E60.9",
                  "E61", "E61.0", "E61.1", "E61.2", "E61.3", "E61.4", "E61.5", "E61.6", "E61.7", "E61.8", "E61.9",
                  "E63", "E63.0", "E63.1", "E63.2", "E63.3", "E63.4", "E63.5", "E63.6", "E63.7", "E63.8", "E63.9",
                  "E64", "E64.0", "E64.2", "E64.3", "E64.4", "E64.5", "E64.6", "E64.7", "E64.8", "E64.9",
                  "Z13.2", "Z13.3", "M12.1")
icd10_vector <- paste(icd10_vector,collapse="|")
icd9_vector <- c("244.2",
                 "260", "261", "262", "263", "263.0", "263.1", "263.2", "263.8", "263.9",
                 "265", "265.0", "265.1", "265.2", "265.3", "265.8", "265.9",
                 "266", "266.0", "266.1", "266.2", "266.9",
                 "267", "268", "268.0", "268.1", "268.2", "268.9",
                 "269", "269.0", "269.1", "269.2", "269.8", "269.9",
                 "280", "280.0", "280.1", "280.2", "280.3", "280.4", "280.8", "280.9",
                 "281", "281.0", "281.1", "281.2", "281.3", "281.4", "281.8", "281.9",
                 "716.0",
                 "V12.1",
                 "V18.2", "V18.3",
                 "V77.2",
                 "V78.0", "V78.1")
icd9_vector <- paste(icd9_vector,collapse="|")
# Look for ICD 10 prevalence
full_icd10_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD10CM" | full_icd_df$source_vocabulary == "ICD10PCS",]
individuals <- c()
matching_rows <- full_icd10_df[grep(icd10_vector,full_icd10_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(individuals)
# Look for ICD 9 prevalence
full_icd9_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD9CM",]
matching_rows <- full_icd9_df[grep(icd9_vector,full_icd9_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(unique(individuals))
paste0("Cohort specific cases: ",nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,]))
paste0("Cohort specific prev: ",(nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,])/nrow(final_aou_data_complete))*100 )
aou_individuals <- final_aou_data_complete[final_aou_data_complete$id %in% individuals,]$id
weighted_case_df <- data.frame(id = aou_individuals,case=1)
weighted_control_df <- data.frame(id = setdiff(final_aou_data_complete$id,aou_individuals),case=0)
weighted_prev_df <- rbind(weighted_case_df,weighted_control_df)
weighted_prev_df <- left_join(weighted_prev_df,aou_weights_int_propensity,by="id")
paste0("Weighted cohort specific cases: ",sum(weighted_prev_df[weighted_prev_df$case==1,]$weight))
paste0("Weighted cohort specific prevalence: ",(sum(weighted_prev_df[weighted_prev_df$case==1,]$weight)/sum(weighted_prev_df$weight))*100)

# Respiratory and TB
icd10_vector <- c("A10", "A11", "A12", "A13", "A14",
                  "A15", "A15.0", "A15.1", "A15.2", "A15.3", "A15.4", "A15.5", "A15.6", "A15.7", "A15.8", "A15.9",
                  "A16", "A16.0", "A16.1", "A16.2", "A16.3", "A16.4", "A16.5", "A16.7", "A16.8", "A16.9",
                  "A17", "A17.0", "A17.1", "A17.8", "A17.9",
                  "A18", "A18.0", "A18.1", "A18.2", "A18.3", "A18.4", "A18.5", "A18.6", "A18.7", "A18.8", "A18.89", 
                  "A19", "A19.0", "A19.1", "A19.2", "A19.8", "A19.9",
                  "A48.1",
                  "A70",
                  "B90", "B90.0", "B90.1", "B90.2", "B90.8", "B90.9",
                  "B96.0", "B96.1",
                  "B97.21", "B97.4", "B97.5", "B97.6",
                  "H65", "H65.0", "H65.1", "H65.2", "H65.3", "H65.4", "H65.9",
                  "H66", "H66.0", "H66.1", "H66.2", "H66.3", "H66.4", "H66.5", "H66.9",
                  "H67", "H67.0", "H67.1", "H67.2", "H67.3", "H67.8", "H67.9",
                  "H68", "H68.0", "H68.1", "H68.2", "H68.3", "H68.8", "H68.9",
                  "H69", "H69.0", "H69.1", "H69.2", "H69.8", "H69.9",
                  "H70", "H70.0", "H70.1", "H70.2", "H70.8", "H70.9", "H70.90", "H70.91", "H70.92", "H70.93",
                  "J00",
                  "J01", "J01.0", "J01.1", "J01.2", "J01.3", "J01.4", "J01.8", "J01.9",
                  "J02", "J02.0", "J02.8", "J02.9",
                  "J03", "J03.0", "J03.8", "J03.9",
                  "J04", "J04.0", "J04.1", "J04.2", "J04.9",
                  "J05", "J05.0", "J05.1", "J05.8", "J05.9",
                  "J06", "J06.0", "J06.8", "J06.9",
                  "J09", "J09.0", "J09.1", "J09.2", "J09.3", "J09.8",
                  "J10", "J10.0", "J10.1", "J10.8", "J10.9",
                  "J11", "J11.0", "J11.1", "J11.8", "J11.9",
                  "J12", "J12.0", "J12.1", "J12.2", "J12.3", "J12.4", "J12.8", "J12.9",
                  "J13",
                  "J14",
                  "J15", "J15.0", "J15.1", "J15.2", "J15.3", "J15.4", "J15.5", "J15.6", "J15.7", "J15.8", "J15.9",
                  "J16", "J16.0", "J16.8", "J16.9",
                  "J18", "J18.0", "J18.1", "J18.2", "J18.8", "J18.9",
                  "J19", "J19.0", "J19.1", "J19.2", "J19.3", "J19.4", "J19.5", "J19.6", "J19.7", "J19.8", "J19.9",
                  "J20", "J20.0", "J20.1", "J20.2", "J20.3", "J20.4", "J20.5", "J20.6", "J20.7", "J20.8", "J20.9",
                  "J21", "J21.0", "J21.1", "J21.8", "J21.9",
                  "J22",
                  "J36", "J36.0",
                  "J85.1",
                  "J91.0",
                  "K67.3",
                  "K93.0",
                  "M49.0",
                  "N74", "N74.0", "N74.1",
                  "P23", "P23.0", "P23.1", "P23.2", "P23.3", "P23.4", "P23.5", "P23.6", "P23.8", "P23.9",
                  "P37", "P37.0",
                  "U04", "U04.0", "U04.1", "U04.2", "U04.3", "U04.4", "U04.5", "U04.6", "U04.7", "U04.8", "U04.9",
                  "U84.3",
                  "Z03.0",
                  "Z11.1",
                  "Z20.1",
                  "Z23.2",
                  "Z25.1")
icd10_vector <- paste(icd10_vector,collapse="|")
icd9_vector <- c("010", "010.0", "010.1", "010.2", "010.3", "010.4", "010.5", "010.6", "010.7", "010.8", "010.9",
                 "011", "011.0", "011.1", "011.2", "011.3", "011.4", "011.5", "011.6", "011.7", "011.8", "011.9",
                 "012", "012.0", "012.1", "012.2", "012.3", "012.4", "012.5", "012.6", "012.7", "012.8", "012.9",
                 "013", "013.0", "013.1", "013.2", "013.3", "013.4", "013.5", "013.6", "013.7", "013.8", "013.9",
                 "014", "014.0", "014.1", "014.2", "014.3", "014.4", "014.5", "014.6", "014.7", "014.8", "014.9",
                 "015", "015.0", "015.1", "015.2", "015.3", "015.4", "015.5", "015.6", "015.7", "015.8", "015.9",
                 "016", "016.0", "016.1", "016.2", "016.3", "016.4", "016.5", "016.6", "016.7", "016.8", "016.9",
                 "017", "017.0", "017.1", "017.2", "017.3", "017.4", "017.5", "017.6", "017.7", "017.8", "017.9",
                 "018", "018.0", "018.1", "018.2", "018.3", "018.4", "018.5", "018.6", "018.7", "018.8", "018.9",
                 "019", "019.0", "019.1", "019.2", "019.3", "019.4", "019.5", "019.6", "019.7", "019.8", "019.9",
                 "034.0",
                 "079.6", "079.82",
                 "137", "137.0", "137.1", "137.2", "137.3", "137.4", "137.5", "137.6", "137.7", "137.8", "137.9",
                 "138", "138.0", "138.1", "138.2", "138.3", "138.4", "138.5", "138.6", "138.7", "138.8", "138.9",
                 "320.4",
                 "381", "381.0", "381.1", "381.2", "381.3", "381.4", "381.5", "381.6", "381.7", "381.8", "381.9",
                 "382", "382.0", "382.1", "382.2", "382.3", "382.4", "382.5", "382.6", "382.7", "382.8", "382.9",
                 "383", "383.0", "383.1", "383.2", "383.3", "383.4", "383.5", "383.6", "383.7", "383.8", "383.9",
                 "460",
                 "461", "461.0", "461.1", "461.2", "461.3", "461.8", "461.9",
                 "462",
                 "463",
                 "464", "464.0", "464.1", "464.2", "464.3", "464.4", "464.8", "464.9",
                 "465", "465.0", "465.1", "465.2", "465.3", "465.4", "465.8",
                 "466",
                 "467",
                 "468",
                 "469",
                 "470", "470.0",
                 "475", "475.0", "475.1", "475.2", "475.3", "475.4", "475.5", "475.6", "475.7", "475.8", "475.9",
                 "476.9",
                 "480", "480.0", "480.1", "480.2", "480.3", "480.8", "480.9",
                 "481",
                 "482", "482.0", "482.1", "482.2", "482.3", "482.4", "482.8", "482.9",
                 "483", "483.0", "483.1", "483.8", "483.9",
                 "484", "484.1", "484.2", "484.6", "484.7",
                 "485",
                 "486",
                 "487",
                 "488",
                 "489",
                 "510", "510.0", "510.9",
                 "511", "511.0", "511.1", "511.2", "511.8", "511.9",
                 "513", "513.0", "513.1", "513.2", "513.3", "513.4", "513.5", "513.6", "513.7", "513.8", "513.9",
                 "730.4", "730.5", "730.6",
                 "770.0",
                 "V01.1",
                 "V01.82",
                 "V03.2",
                 "V04.7",
                 "V04.81",
                 "V12.01",
                 "V12.61",
                 "V74.1")
icd9_vector <- paste(icd9_vector,collapse="|")
# Look for ICD 10 prevalence
full_icd10_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD10CM" | full_icd_df$source_vocabulary == "ICD10PCS",]
individuals <- c()
matching_rows <- full_icd10_df[grep(icd10_vector,full_icd10_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(individuals)
# Look for ICD 9 prevalence
full_icd9_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD9CM",]
matching_rows <- full_icd9_df[grep(icd9_vector,full_icd9_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(unique(individuals))
paste0("Cohort specific cases: ",nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,]))
paste0("Cohort specific prev: ",(nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,])/nrow(final_aou_data_complete))*100 )
aou_individuals <- final_aou_data_complete[final_aou_data_complete$id %in% individuals,]$id
weighted_case_df <- data.frame(id = aou_individuals,case=1)
weighted_control_df <- data.frame(id = setdiff(final_aou_data_complete$id,aou_individuals),case=0)
weighted_prev_df <- rbind(weighted_case_df,weighted_control_df)
weighted_prev_df <- left_join(weighted_prev_df,aou_weights_int_propensity,by="id")
paste0("Weighted cohort specific cases: ",sum(weighted_prev_df[weighted_prev_df$case==1,]$weight))
paste0("Weighted cohort specific prevalence: ",(sum(weighted_prev_df[weighted_prev_df$case==1,]$weight)/sum(weighted_prev_df$weight))*100)

# Skin
icd10_vector <- c("A46", "A46.0",
                  "A66", "A66.0", "A66.1", "A66.2", "A66.3", "A66.4", "A66.5", "A66.6", "A66.7", "A66.8", "A66.9",
                  "A67", "A67.0", "A67.1", "A67.2", "A67.3", "A67.9",
                  "B07", "B07.0", "B07.1", "B07.2", "B07.3", "B07.4", "B07.5", "B07.6", "B07.7", "B07.8", "B07.9",
                  "B08", "B08.0", "B08.1", "B08.2", "B08.3", "B08.4", "B08.5", "B08.6", "B08.7", "B08.8", "B08.9",
                  "B09",
                  "B35", "B35.0", "B35.1", "B35.2", "B35.3", "B35.4", "B35.5", "B35.6", "B35.7", "B35.8", "B35.9",
                  "B36", "B36.0", "B36.1", "B36.2", "B36.3", "B36.4", "B36.5", "B36.6", "B36.7", "B36.8", "B36.9",
                  "B85", "B85.0", "B85.1", "B85.2", "B85.3", "B85.4", "B85.8", "B85.9",
                  "B86",
                  "B87", "B87.0", "B87.1", "B87.2", "B87.3", "B87.4", "B87.5", "B87.6", "B87.7", "B87.8", "B87.9",
                  "B88", "B88.0", "B88.1", "B88.2", "B88.3", "B88.8", "B88.9",
                  "D86.3",
                  "E80.1", "E80.2", "E80.20", "E80.21", "E80.22", "E80.29",
                  "I89.1", "I89.2", "I89.3", "I89.8",
                  "L00", "L00.0", "L00.1", "L00.2", "L00.3", "L00.4", "L00.5", "L00.8", "L00.9",
                  "L01", "L01.0", "L01.1", "L01.2", "L01.3", "L01.4", "L01.5", "L01.8", "L01.9",
                  "L02", "L02.0", "L02.1", "L02.2", "L02.3", "L02.4", "L02.5", "L02.6", "L02.7", "L02.8", "L02.9",
                  "L03", "L03.0", "L03.1", "L03.2", "L03.3", "L03.4", "L03.5", "L03.6", "L03.7", "L03.8", "L03.9",
                  "L04", "L04.0", "L04.1", "L04.2", "L04.3", "L04.4", "L04.5", "L04.8", "L04.9",
                  "L05", "L05.0", "L05.1", "L05.2", "L05.3", "L05.4", "L05.5", "L05.8", "L05.9", "L05.90", "L05.91", "L05.92",
                  "L08", "L08.0", "L08.1", "L08.2", "L08.3", "L08.4", "L08.5", "L08.8", "L08.9",
                  "L10", "L10.0", "L10.1", "L10.2", "L10.3", "L10.4", "L10.5", "L10.8", "L10.9",
                  "L11", "L11.0", "L11.1", "L11.2", "L11.3", "L11.4", "L11.8", "L11.9",
                  "L12", "L12.0", "L12.1", "L12.2", "L12.3", "L12.4", "L12.5", "L12.8", "L12.9",
                  "L13", "L13.0", "L13.1", "L13.2", "L13.3", "L13.4", "L13.5", "L13.8", "L13.9",
                  "L14",
                  "L20", "L20.0", "L20.1", "L20.2", "L20.3", "L20.4", "L20.5", "L20.6", "L20.8", "L20.9",
                  "L21", "L21.0", "L21.1", "L21.2", "L21.8", "L21.9",
                  "L22",
                  "L23", "L23.0", "L23.1", "L23.2", "L23.4", "L23.5", "L23.6", "L23.7", "L23.8", "L23.9",
                  "L24", "L24.0", "L24.1", "L24.2", "L24.3", "L24.4", "L24.5", "L24.6", "L24.7", "L24.8", "L24.9",
                  "L25", "L25.0", "L25.1", "L25.2", "L25.3", "L25.4", "L25.5", "L25.8", "L25.9",
                  "L26",
                  "L27", "L27.0", "L27.1", "L27.2", "L27.3", "L27.4", "L27.5", "L27.8", "L27.9",
                  "L28", "L28.0", "L28.1", "L28.2", "L28.3", "L28.4", "L28.5", "L28.8", "L28.9",
                  "L29", "L29.0", "L29.1", "L29.2", "L29.3", "L29.4", "L29.5", "L29.6", "L29.8", "L29.9",
                  "L30", "L30.0", "L30.1", "L30.2", "L30.3", "L30.4", "L30.5", "L30.8", "L30.9",
                  "L40", "L40.0", "L40.1", "L40.2", "L40.3", "L40.4", "L40.5", "L40.8", "L40.9",
                  "L41", "L41.0", "L41.1", "L41.2", "L41.3", "L41.4", "L41.5", "L41.8", "L41.9",
                  "L42",
                  "L43", "L43.0", "L43.1", "L43.2", "L43.3", "L43.8", "L43.9",
                  "L44", "L44.0", "L44.1", "L44.2", "L44.3", "L44.4", "L44.5", "L44.8", "L44.9",
                  "L45",
                  "L49", "L49.0", "L49.1", "L49.2", "L49.3", "L49.4", "L49.5", "L49.6", "L49.8", "L49.9",
                  "L50", "L50.0", "L50.1", "L50.2", "L50.3", "L50.4", "L50.5", "L50.6", "L50.8", "L50.9",
                  "L51", "L51.0", "L51.1", "L51.2", "L51.3", "L51.4", "L51.5", "L51.6", "L51.7", "L51.8", "L51.9",
                  "L52",
                  "L53", "L53.0", "L53.1", "L53.2", "L53.3", "L53.8", "L53.9",
                  "L54", "L54.0",
                  "L56", "L56.0", "L56.1", "L56.2", "L56.3", "L56.4", "L56.5", "L56.8", "L56.9",
                  "L57", "L57.0", "L57.1", "L57.2", "L57.3", "L57.4", "L57.5", "L57.8", "L57.9",
                  "L59", "L59.0", "L59.1", "L59.2", "L59.3", "L59.4", "L59.5", "L59.8", "L59.9",
                  "L60", "L60.0", "L60.1", "L60.2", "L60.3", "L60.4", "L60.5", "L60.6", "L60.8", "L60.9",
                  "L62",
                  "L63",
                  "L64", "L64.0", "L64.8", "L64.9",
                  "L65", "L66", "L66.0", "L66.1", "L66.2", "L66.3", "L66.4", "L66.5", "L66.8", "L66.9",
                  "L67", "L67.0", "L67.1", "L67.2", "L67.3", "L67.4", "L67.8", "L67.9",
                  "L68", "L68.0", "L68.1", "L68.2", "L68.8", "L68.9",
                  "L69",
                  "L70", "L70.0", "L70.1", "L70.2", "L70.3", "L70.4", "L70.5", "L70.8", "L70.9",
                  "L71", "L71.0", "L71.1", "L71.8", "L71.9",
                  "L72", "L72.0", "L72.1", "L72.2", "L72.3", "L72.8", "L72.9",
                  "L73", "L73.0", "L73.1", "L73.2", "L73.8", "L73.9",
                  "L74", "L74.0", "L74.1", "L74.2", "L74.3", "L74.4", "L74.8", "L74.9",
                  "L75", "L75.0", "L75.1", "L75.2", "L75.8", "L75.9",
                  "L80", "L80.0", "L80.1", "L80.2", "L80.3", "L80.4", "L80.5", "L80.8", "L80.9",
                  "L81", "L81.0", "L81.1", "L81.2", "L81.3", "L81.4", "L81.5", "L81.6", "L81.7", "L81.8", "L81.9",
                  "L82", "L82.0", "L82.1", "L82.8", "L82.9",
                  "L83", "L83.0", "L83.1", "L83.8", "L83.9",
                  "L84", "L84.0", "L84.1", "L84.8", "L84.9",
                  "L85", "L85.0", "L85.1", "L85.2", "L85.3", "L85.4", "L85.5", "L85.6", "L85.8", "L85.9",
                  "L86",
                  "L87", "L87.0", "L87.1", "L87.2", "L87.3", "L87.4", "L87.8", "L87.9",
                  "L88",
                  "L89", "L89.0", "L89.1", "L89.2", "L89.3", "L89.4", "L89.5", "L89.6", "L89.8", "L89.9",
                  "L90", "L90.0", "L90.1", "L90.2", "L90.3", "L90.4", "L90.5", "L90.6", "L90.8", "L90.9",
                  "L91", "L91.0", "L91.1", "L91.2", "L91.3", "L91.8", "L91.9",
                  "L92", "L92.0", "L92.1", "L92.2", "L92.3", "L92.4", "L92.8", "L92.9",
                  "L94", "L94.0", "L94.1", "L94.2", "L94.3", "L94.4", "L94.5", "L94.8", "L94.9",
                  "L95", "L95.0", "L95.1", "L95.2", "L95.3", "L95.4", "L95.8", "L95.9",
                  "L97", "L97.0", "L97.1", "L97.2", "L97.3", "L97.4", "L97.5", "L97.8", "L97.9",
                  "L98", "L98.0", "L98.1", "L98.2", "L98.3", "L98.4",
                  "L99",
                  "M72", "M72.5", "M72.6",
                  "N49", "N49.2", "N49.3",
                  "R20", "R20.0", "R20.1", "R20.2", "R20.3", "R20.8", "R20.9",
                  "R21",
                  "R22", "R22.0", "R22.1", "R22.2", "R22.3", "R22.4", "R22.8", "R22.9",
                  "R23", "R23.0", "R23.1", "R23.2", "R23.3", "R23.4", "R23.8", "R23.9",
                  "R24", "R24.0",
                  "Z20.7",
                  "Z41.1",
                  "Z84.0",
                  "Z87.2",
                  "Z94.5")
icd10_vector <- paste(icd10_vector,collapse="|")
icd9_vector <- c("035", "035.0", "035.1", "035.2", "035.3", "035.4", "035.5", "035.6", "035.7", "035.8", "035.9",
                 "040.0",
                 "078.0", "078.1", "078.10", "078.11", "078.12", "078.19",
                 "102", "102.0", "102.1", "102.2", "102.3", "102.4", "102.5", "102.6", "102.7", "102.8", "102.9",
                 "103", "103.0", "103.1", "103.2", "103.3", "103.4", "103.5", "103.6", "103.7", "103.8", "103.9",
                 "110", "110.0", "110.1", "110.2", "110.3", "110.4", "110.5", "110.6", "110.7", "110.8", "110.9",
                 "111", "111.0", "111.1", "111.2", "111.3", "111.4", "111.5", "111.6", "111.7", "111.8", "111.9",
                 "132", "132.0", "132.1", "132.2", "132.3", "132.4", "132.5", "132.6", "132.7", "132.8", "132.9",
                 "133", "133.0", "133.1", "133.2", "133.3", "133.4", "133.5", "133.6",
                 "134", "134.0", "134.1", "134.2", "134.3", "134.4", "134.5", "134.6", "134.7", "134.8", "134.9",
                 "136.1",
                 "457.2", "457.3",
                 "680", "680.0", "680.1", "680.2", "680.3", "680.4", "680.5", "680.6", "680.7", "680.8", "680.9",
                 "681", "681.0", "681.1", "681.2", "681.3", "681.4", "681.5", "681.6", "681.7", "681.8", "681.9",
                 "682", "682.0", "682.1", "682.2", "682.3", "682.4", "682.5", "682.6", "682.7", "682.8", "682.9",
                 "683",
                 "684",
                 "685", "685.0", "685.1",
                 "686", "686.0", "686.1", "686.2", "686.3", "686.4", "686.8", "686.9",
                 "687", "687.0", "687.1", "687.2", "687.3", "687.4", "687.5", "687.6", "687.7", "687.8", "687.9",
                 "688", "688.0", "688.1", "688.2", "688.3", "688.4", "688.5", "688.6", "688.7", "688.8", "688.9",
                 "689", "689.0", "689.1", "689.2", "689.3", "689.4", "689.5", "689.6", "689.7", "689.8", "689.9",
                 "694", "694.0", "694.1", "694.2", "694.3", "694.4", "694.5", "694.6", "694.7", "694.8", "694.9",
                 "695", "695.0", "695.1", "695.2", "695.3",
                 "707", "707.0", "707.1", "707.2", "707.3", "707.4", "707.5", "707.6", "707.7", "707.8", "707.9",
                 "708", "708.0", "708.1", "708.2", "708.3", "708.4", "708.5", "708.6", "708.7", "708.8", "708.9",
                 "709", "709.0", "709.1", "709.2", "709.3", "709.8", "709.9",
                 "728.86",
                 "782", "782.0", "782.1", "782.2", "782.3", "782.4", "782.5", "782.6", "782.7", "782.8", "782.9",
                 "785.4",
                 "V13.3",
                 "V19.4",
                 "V42.3",
                 "V43.83",
                 "V58.77",
                 "V59.1",
                 "V82.0")
icd9_vector <- paste(icd9_vector,collapse="|")
# Look for ICD 10 prevalence
full_icd10_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD10CM" | full_icd_df$source_vocabulary == "ICD10PCS",]
individuals <- c()
matching_rows <- full_icd10_df[grep(icd10_vector,full_icd10_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(individuals)
# Look for ICD 9 prevalence
full_icd9_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD9CM",]
matching_rows <- full_icd9_df[grep(icd9_vector,full_icd9_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(unique(individuals))
paste0("Cohort specific cases: ",nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,]))
paste0("Cohort specific prev: ",(nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,])/nrow(final_aou_data_complete))*100 )
aou_individuals <- final_aou_data_complete[final_aou_data_complete$id %in% individuals,]$id
weighted_case_df <- data.frame(id = aou_individuals,case=1)
weighted_control_df <- data.frame(id = setdiff(final_aou_data_complete$id,aou_individuals),case=0)
weighted_prev_df <- rbind(weighted_case_df,weighted_control_df)
weighted_prev_df <- left_join(weighted_prev_df,aou_weights_int_propensity,by="id")
paste0("Weighted cohort specific cases: ",sum(weighted_prev_df[weighted_prev_df$case==1,]$weight))
paste0("Weighted cohort specific prevalence: ",(sum(weighted_prev_df[weighted_prev_df$case==1,]$weight)/sum(weighted_prev_df$weight))*100)

# Substance use
icd10_vector <- c("E24.4",
                  "F10", "F10.0", "F10.00", "F10.01", "F10.02", "F10.03", "F10.04", "F10.05", "F10.06", "F10.07", "F10.08", "F10.09",
                  "F10.1", "F10.10", "F10.11", "F10.12", "F10.13", "F10.14", "F10.15", "F10.16", "F10.17", "F10.18", "F10.19",
                  "F10.2", "F10.20", "F10.21", "F10.22", "F10.23", "F10.24", "F10.25", "F10.26", "F10.27", "F10.28", "F10.29",
                  "F10.3", "F10.30", "F10.31", "F10.32", "F10.33", "F10.34", "F10.35", "F10.36", "F10.37", "F10.38", "F10.39",
                  "F10.4", "F10.40", "F10.41", "F10.42", "F10.43", "F10.44", "F10.45", "F10.46", "F10.47", "F10.48", "F10.49",
                  "F10.5", "F10.50", "F10.51", "F10.52", "F10.53", "F10.54", "F10.55", "F10.56", "F10.57", "F10.58", "F10.59",
                  "F10.6", "F10.60", "F10.61", "F10.62", "F10.63", "F10.64", "F10.65", "F10.66", "F10.67", "F10.68", "F10.69",
                  "F10.7", "F10.70", "F10.71", "F10.72", "F10.73", "F10.74", "F10.75", "F10.76", "F10.77", "F10.78", "F10.79",
                  "F10.8", "F10.80", "F10.81", "F10.82", "F10.83", "F10.84", "F10.85", "F10.86", "F10.87", "F10.88", "F10.89",
                  "F10.9", "F10.90", "F10.91", "F10.92", "F10.93", "F10.94", "F10.95", "F10.96", "F10.97", "F10.98", "F10.99",
                  "F11", "F11.0", "F11.00", "F11.01", "F11.02", "F11.03", "F11.04", "F11.05", "F11.06", "F11.07", "F11.08", "F11.09",
                  "F11.1", "F11.10", "F11.11", "F11.12", "F11.13", "F11.14", "F11.15", "F11.16", "F11.17", "F11.18", "F11.19",
                  "F11.2", "F11.20", "F11.21", "F11.22", "F11.23", "F11.24", "F11.25", "F11.26", "F11.27", "F11.28", "F11.29",
                  "F11.3", "F11.30", "F11.31", "F11.32", "F11.33", "F11.34", "F11.35", "F11.36", "F11.37", "F11.38", "F11.39",
                  "F11.4", "F11.40", "F11.41", "F11.42", "F11.43", "F11.44", "F11.45", "F11.46", "F11.47", "F11.48", "F11.49",
                  "F11.5", "F11.50", "F11.51", "F11.52", "F11.53", "F11.54", "F11.55", "F11.56", "F11.57", "F11.58", "F11.59",
                  "F11.6", "F11.60", "F11.61", "F11.62", "F11.63", "F11.64", "F11.65", "F11.66", "F11.67", "F11.68", "F11.69",
                  "F11.7", "F11.70", "F11.71", "F11.72", "F11.73", "F11.74", "F11.75", "F11.76", "F11.77", "F11.78", "F11.79",
                  "F11.8", "F11.80", "F11.81", "F11.82", "F11.83", "F11.84", "F11.85", "F11.86", "F11.87", "F11.88", "F11.89",
                  "F11.9", "F11.90", "F11.91", "F11.92", "F11.93", "F11.94", "F11.95", "F11.96", "F11.97", "F11.98", "F11.99",
                  "F12", "F12.0", "F12.00", "F12.01", "F12.02", "F12.03", "F12.04", "F12.05", "F12.06", "F12.07", "F12.08", "F12.09",
                  "F12.1", "F12.10", "F12.11", "F12.12", "F12.13", "F12.14", "F12.15", "F12.16", "F12.17", "F12.18", "F12.19",
                  "F12.2", "F12.20", "F12.21", "F12.22", "F12.23", "F12.24", "F12.25", "F12.26", "F12.27", "F12.28", "F12.29",
                  "F12.3", "F12.30", "F12.31", "F12.32", "F12.33", "F12.34", "F12.35", "F12.36", "F12.37", "F12.38", "F12.39",
                  "F12.4", "F12.40", "F12.41", "F12.42", "F12.43", "F12.44", "F12.45", "F12.46", "F12.47", "F12.48", "F12.49",
                  "F12.5", "F12.50", "F12.51", "F12.52", "F12.53", "F12.54", "F12.55", "F12.56", "F12.57", "F12.58", "F12.59",
                  "F12.6", "F12.60", "F12.61", "F12.62", "F12.63", "F12.64", "F12.65", "F12.66", "F12.67", "F12.68", "F12.69",
                  "F12.7", "F12.70", "F12.71", "F12.72", "F12.73", "F12.74", "F12.75", "F12.76", "F12.77", "F12.78", "F12.79",
                  "F12.8", "F12.80", "F12.81", "F12.82", "F12.83", "F12.84", "F12.85", "F12.86", "F12.87", "F12.88", "F12.89",
                  "F12.9", "F12.90", "F12.91", "F12.92", "F12.93", "F12.94", "F12.95", "F12.96", "F12.97", "F12.98", "F12.99",
                  "F13", "F13.0", "F13.00", "F13.01", "F13.02", "F13.03", "F13.04", "F13.05", "F13.06", "F13.07", "F13.08", "F13.09",
                  "F13.1", "F13.10", "F13.11", "F13.12", "F13.13", "F13.14", "F13.15", "F13.16", "F13.17", "F13.18", "F13.19",
                  "F13.2", "F13.20", "F13.21", "F13.22", "F13.23", "F13.24", "F13.25", "F13.26", "F13.27", "F13.28", "F13.29",
                  "F13.3", "F13.30", "F13.31", "F13.32", "F13.33", "F13.34", "F13.35", "F13.36", "F13.37", "F13.38", "F13.39",
                  "F13.4", "F13.40", "F13.41", "F13.42", "F13.43", "F13.44", "F13.45", "F13.46", "F13.47", "F13.48", "F13.49",
                  "F13.5", "F13.50", "F13.51", "F13.52", "F13.53", "F13.54", "F13.55", "F13.56", "F13.57", "F13.58", "F13.59",
                  "F13.6", "F13.60", "F13.61", "F13.62", "F13.63", "F13.64", "F13.65", "F13.66", "F13.67", "F13.68", "F13.69",
                  "F13.7", "F13.70", "F13.71", "F13.72", "F13.73", "F13.74", "F13.75", "F13.76", "F13.77", "F13.78", "F13.79",
                  "F13.8", "F13.80", "F13.81", "F13.82", "F13.83", "F13.84", "F13.85", "F13.86", "F13.87", "F13.88", "F13.89",
                  "F13.9", "F13.90", "F13.91", "F13.92", "F13.93", "F13.94", "F13.95", "F13.96", "F13.97", "F13.98", "F13.99",
                  "F14", "F14.0", "F14.00", "F14.01", "F14.02", "F14.03", "F14.04", "F14.05", "F14.06", "F14.07", "F14.08", "F14.09",
                  "F14.1", "F14.10", "F14.11", "F14.12", "F14.13", "F14.14", "F14.15", "F14.16", "F14.17", "F14.18", "F14.19",
                  "F14.2", "F14.20", "F14.21", "F14.22", "F14.23", "F14.24", "F14.25", "F14.26", "F14.27", "F14.28", "F14.29",
                  "F14.3", "F14.30", "F14.31", "F14.32", "F14.33", "F14.34", "F14.35", "F14.36", "F14.37", "F14.38", "F14.39",
                  "F14.4", "F14.40", "F14.41", "F14.42", "F14.43", "F14.44", "F14.45", "F14.46", "F14.47", "F14.48", "F14.49",
                  "F14.5", "F14.50", "F14.51", "F14.52", "F14.53", "F14.54", "F14.55", "F14.56", "F14.57", "F14.58", "F14.59",
                  "F14.6", "F14.60", "F14.61", "F14.62", "F14.63", "F14.64", "F14.65", "F14.66", "F14.67", "F14.68", "F14.69",
                  "F14.7", "F14.70", "F14.71", "F14.72", "F14.73", "F14.74", "F14.75", "F14.76", "F14.77", "F14.78", "F14.79",
                  "F14.8", "F14.80", "F14.81", "F14.82", "F14.83", "F14.84", "F14.85", "F14.86", "F14.87", "F14.88", "F14.89",
                  "F14.9", "F14.90", "F14.91", "F14.92", "F14.93", "F14.94", "F14.95", "F14.96", "F14.97", "F14.98", "F14.99",
                  "F15", "F15.0", "F15.00", "F15.01", "F15.02", "F15.03", "F15.04", "F15.05", "F15.06", "F15.07", "F15.08", "F15.09",
                  "F15.1", "F15.10", "F15.11", "F15.12", "F15.13", "F15.14", "F15.15", "F15.16", "F15.17", "F15.18", "F15.19",
                  "F15.2", "F15.20", "F15.21", "F15.22", "F15.23", "F15.24", "F15.25", "F15.26", "F15.27", "F15.28", "F15.29",
                  "F15.3", "F15.30", "F15.31", "F15.32", "F15.33", "F15.34", "F15.35", "F15.36", "F15.37", "F15.38", "F15.39",
                  "F15.4", "F15.40", "F15.41", "F15.42", "F15.43", "F15.44", "F15.45", "F15.46", "F15.47", "F15.48", "F15.49",
                  "F15.5", "F15.50", "F15.51", "F15.52", "F15.53", "F15.54", "F15.55", "F15.56", "F15.57", "F15.58", "F15.59",
                  "F15.6", "F15.60", "F15.61", "F15.62", "F15.63", "F15.64", "F15.65", "F15.66", "F15.67", "F15.68", "F15.69",
                  "F15.7", "F15.70", "F15.71", "F15.72", "F15.73", "F15.74", "F15.75", "F15.76", "F15.77", "F15.78", "F15.79",
                  "F15.8", "F15.80", "F15.81", "F15.82", "F15.83", "F15.84", "F15.85", "F15.86", "F15.87", "F15.88", "F15.89",
                  "F15.9", "F15.90", "F15.91", "F15.92", "F15.93", "F15.94", "F15.95", "F15.96", "F15.97", "F15.98", "F15.99",
                  "F16", "F16.0", "F16.00", "F16.01", "F16.02", "F16.03", "F16.04", "F16.05", "F16.06", "F16.07", "F16.08", "F16.09",
                  "F16.1", "F16.10", "F16.11", "F16.12", "F16.13", "F16.14", "F16.15", "F16.16", "F16.17", "F16.18", "F16.19",
                  "F16.2", "F16.20", "F16.21", "F16.22", "F16.23", "F16.24", "F16.25", "F16.26", "F16.27", "F16.28", "F16.29",
                  "F16.3", "F16.30", "F16.31", "F16.32", "F16.33", "F16.34", "F16.35", "F16.36", "F16.37", "F16.38", "F16.39",
                  "F16.4", "F16.40", "F16.41", "F16.42", "F16.43", "F16.44", "F16.45", "F16.46", "F16.47", "F16.48", "F16.49",
                  "F16.5", "F16.50", "F16.51", "F16.52", "F16.53", "F16.54", "F16.55", "F16.56", "F16.57", "F16.58", "F16.59",
                  "F16.6", "F16.60", "F16.61", "F16.62", "F16.63", "F16.64", "F16.65", "F16.66", "F16.67", "F16.68", "F16.69",
                  "F16.7", "F16.70", "F16.71", "F16.72", "F16.73", "F16.74", "F16.75", "F16.76", "F16.77", "F16.78", "F16.79",
                  "F16.8", "F16.80", "F16.81", "F16.82", "F16.83", "F16.84", "F16.85", "F16.86", "F16.87", "F16.88", "F16.89",
                  "F16.9", "F16.90", "F16.91", "F16.92", "F16.93", "F16.94", "F16.95", "F16.96", "F16.97", "F16.98", "F16.99",
                  "F18", "F18.0", "F18.00", "F18.01", "F18.02", "F18.03", "F18.04", "F18.05", "F18.06", "F18.07", "F18.08", "F18.09",
                  "F18.1", "F18.10", "F18.11", "F18.12", "F18.13", "F18.14", "F18.15", "F18.16", "F18.17", "F18.18", "F18.19",
                  "F18.2", "F18.20", "F18.21", "F18.22", "F18.23", "F18.24", "F18.25", "F18.26", "F18.27", "F18.28", "F18.29",
                  "F18.3", "F18.30", "F18.31", "F18.32", "F18.33", "F18.34", "F18.35", "F18.36", "F18.37", "F18.38", "F18.39",
                  "F18.4", "F18.40", "F18.41", "F18.42", "F18.43", "F18.44", "F18.45", "F18.46", "F18.47", "F18.48", "F18.49",
                  "F18.5", "F18.50", "F18.51", "F18.52", "F18.53", "F18.54", "F18.55", "F18.56", "F18.57", "F18.58", "F18.59",
                  "F18.6", "F18.60", "F18.61", "F18.62", "F18.63", "F18.64", "F18.65", "F18.66", "F18.67", "F18.68", "F18.69",
                  "F18.7", "F18.70", "F18.71", "F18.72", "F18.73", "F18.74", "F18.75", "F18.76", "F18.77", "F18.78", "F18.79",
                  "F18.8", "F18.80", "F18.81", "F18.82", "F18.83", "F18.84", "F18.85", "F18.86", "F18.87", "F18.88", "F18.89",
                  "F18.9", "F18.90", "F18.91", "F18.92", "F18.93", "F18.94", "F18.95", "F18.96", "F18.97", "F18.98", "F18.99",
                  "F19", "F19.0", "F19.00", "F19.01", "F19.02", "F19.03", "F19.04", "F19.05", "F19.06", "F19.07", "F19.08", "F19.09",
                  "F19.1", "F19.10", "F19.11", "F19.12", "F19.13", "F19.14", "F19.15", "F19.16", "F19.17", "F19.18", "F19.19",
                  "F19.2", "F19.20", "F19.21", "F19.22", "F19.23", "F19.24", "F19.25", "F19.26", "F19.27", "F19.28", "F19.29",
                  "F19.3", "F19.30", "F19.31", "F19.32", "F19.33", "F19.34", "F19.35", "F19.36", "F19.37", "F19.38", "F19.39",
                  "F19.4", "F19.40", "F19.41", "F19.42", "F19.43", "F19.44", "F19.45", "F19.46", "F19.47", "F19.48", "F19.49",
                  "F19.5", "F19.50", "F19.51", "F19.52", "F19.53", "F19.54", "F19.55", "F19.56", "F19.57", "F19.58", "F19.59",
                  "F19.6", "F19.60", "F19.61", "F19.62", "F19.63", "F19.64", "F19.65", "F19.66", "F19.67", "F19.68", "F19.69",
                  "F19.7", "F19.70", "F19.71", "F19.72", "F19.73", "F19.74", "F19.75", "F19.76", "F19.77", "F19.78", "F19.79",
                  "F19.8", "F19.80", "F19.81", "F19.82", "F19.83", "F19.84", "F19.85", "F19.86", "F19.87", "F19.88", "F19.89",
                  "F19.9", "F19.90", "F19.91", "F19.92", "F19.93", "F19.94", "F19.95", "F19.96", "F19.97", "F19.98", "F19.99",
                  "G31.2",
                  "G62.1",
                  "P04.3", "P04.4",
                  "P96.1",
                  "Q86.0",
                  "R78.0", "R78.1", "R78.2", "R78.3", "R78.4", "R78.5", "R78.6", "R78.7", "R78.8", "R78.9",
                  "X45", "X45.0", "X45.1", "X45.2", "X45.3", "X45.4", "X45.5", "X45.6", "X45.7", "X45.8", "X45.9",
                  "X65", "X65.0", "X65.1", "X65.2", "X65.3", "X65.4", "X65.5", "X65.6", "X65.7", "X65.8", "X65.9",
                  "Y15", "Y15.0", "Y15.1", "Y15.2", "Y15.3", "Y15.4", "Y15.5", "Y15.6", "Y15.7", "Y15.8", "Y15.9",
                  "Z81.1", "Z81.2", "Z81.3", "Z81.4")
icd10_vector <- paste(icd10_vector,collapse="|")
icd9_vector <- c("291", "291.0", "291.1", "291.2", "291.3", "291.4", "291.5", "291.8", "291.9",
                 "292", "292.0", "292.1", "292.2", "292.8", "292.9",
                 "303", "303.0", "303.1", "303.2", "303.9",
                 "304", "304.0", "304.1", "304.2", "304.3", "304.4", "304.5", "304.6", "304.7", "304.8",
                 "305", "305.0", "305.2", "305.3", "305.4", "305.5", "305.6", "305.7", "305.8", "305.9", "305.91", "305.92", "305.93",
                 "357.5",
                 "760.7",
                 "790.3",
                 "E850", "E850.0", "E850.1", "E850.2", "E850.20", "E850.21", "E850.22", "E850.23", "E850.24", "E850.25", "E850.26", "E850.27", "E850.28", "E850.29",
                 "E860", "E860.0", "E860.1", "E860.10", "E860.11", "E860.12", "E860.13", "E860.14", "E860.15", "E860.16", "E860.17", "E860.18", "E860.19",
                 "V11.3",
                 "V15.8", "V15.81", "V15.82", "V15.83", "V15.85", "V15.86")
icd9_vector <- paste(icd9_vector,collapse="|")
# Look for ICD 10 prevalence
full_icd10_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD10CM" | full_icd_df$source_vocabulary == "ICD10PCS",]
individuals <- c()
matching_rows <- full_icd10_df[grep(icd10_vector,full_icd10_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(individuals)
# Look for ICD 9 prevalence
full_icd9_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD9CM",]
matching_rows <- full_icd9_df[grep(icd9_vector,full_icd9_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(unique(individuals))
paste0("Cohort specific cases: ",nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,]))
paste0("Cohort specific prev: ",(nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,])/nrow(final_aou_data_complete))*100 )
aou_individuals <- final_aou_data_complete[final_aou_data_complete$id %in% individuals,]$id
weighted_case_df <- data.frame(id = aou_individuals,case=1)
weighted_control_df <- data.frame(id = setdiff(final_aou_data_complete$id,aou_individuals),case=0)
weighted_prev_df <- rbind(weighted_case_df,weighted_control_df)
weighted_prev_df <- left_join(weighted_prev_df,aou_weights_int_propensity,by="id")
paste0("Weighted cohort specific cases: ",sum(weighted_prev_df[weighted_prev_df$case==1,]$weight))
paste0("Weighted cohort specific prevalence: ",(sum(weighted_prev_df[weighted_prev_df$case==1,]$weight)/sum(weighted_prev_df$weight))*100)

# Neurological disorders
icd10_vector <- c("F00", "F01", "F02", "F02.0", "F02.2", "F02.3", "F02.8", "F03", "F03.0", "F03.1", "F03.2", "F03.3", "F03.4", "F03.5", "F03.6", "F03.7", "F03.8", "F03.9", "F06.2", 
"G10", "G11", "G12", "G13", "G13.1", "G13.2", "G13.3", "G13.4", "G13.5", "G13.6", "G13.7", "G13.8", "G20", "G20.0", "G20.1", "G20.2", "G20.3", "G20.4", "G20.5", "G20.6", "G20.7", "G20.8", "G20.9", 
"G21", "G21.2", "G22", "G23", "G24", "G24.1", "G25", "G25.0", "G25.2", "G25.3", "G25.5", "G25.8", "G26", "G30", "G31", "G31.1", "G31.8", "G31.9", "G32", "G32.1", "G32.2", "G32.3", "G32.4", "G32.5", "G32.6", "G32.7", "G32.8", "G32.89",
"G35", "G35.0", "G36", "G37", "G37.1", "G37.2", "G37.3", "G37.4", "G37.5", "G37.6", "G37.7", "G37.8", "G37.9", 
"G40", "G41", "G41.1", "G41.2", "G41.3", "G41.4", "G41.5", "G41.6", "G41.7", "G41.8", "G41.9", 
"G43", "G44", "G44.1", "G44.2", "G44.3", "G44.4", "G44.5", "G44.6", "G44.7", "G44.8", "G44.89", 
"G50", "G51", "G52", "G53", "G54", "G54.1", "G54.5", "G55", "G56", "G57", "G58", "G59", "G60", "G61", "G61.1", "G61.2", "G61.3", "G61.4", "G61.5", "G61.6", "G61.7", "G61.8", "G61.9", "G62", "G62.1", "G62.2", "G63", "G64", "G65", "G65.1", "G65.2", 
"G70", "G71", "G71.1", "G71.19", "G71.3", "G72", "G72.1", "G72.2", "G73", "G73.1", "G73.2", "G73.3", "G73.4", "G73.5", "G73.6", "G73.7", 
"G80", "G81", "G82", "G83", "G83.1", "G83.2", "G83.3", "G83.4", "G83.5", "G83.6", "G83.7", "G83.8", "G83.9", 
"G89", "G90", "G90.1", "G90.2", "G90.3", "G90.4", "G90.5", "G90.6", "G90.7", "G90.8", "G90.9", "G91", "G92", "G93", "G93.1", "G93.2", "G93.3", "G93.4", "G93.5", "G93.6", "G93.8", "G94", "G95", "G95.1", "G95.2", "G95.3", "G95.4", "G95.5", "G95.6", "G95.7", "G95.8", "G95.9", 
"G96", "G96.1", "G96.12", "G96.2", "G96.3", "G96.4", "G96.5", "G96.6", "G96.7", "G96.8", "G96.9", "G98", "G99", "G99.1", "G99.2", "G99.3", "G99.4", "G99.5", "G99.6", "G99.7", "G99.8", 
"M33", "M33.1", "M33.2", "M33.3", "M33.4", "M33.5", "M33.6", "M33.7", "M33.8", "M33.9", "M60", "M60.1", "M60.19", "M60.8", "M60.9", 
"M79.7", 
"R25", "R26", "R26.1", "R26.2", "R26.3", "R26.4", "R26.5", "R26.6", "R26.7", "R26.8", "R26.9", "R27", "R27.1", "R27.2", "R27.3", "R27.4", "R27.5", "R27.6", "R27.7", "R27.8", "R27.9", 
"R29", "R29.1", "R29.2", "R29.3", "R29.4", "R29.5", "R29.6", "R29.7", "R29.8", "R29.9", "R29.91", 
"R41", "R42", "R42.0", 
"R56", "R56.1", "R56.2", "R56.3", "R56.4", "R56.5", "R56.6", "R56.7", "R56.8", "R56.9", 
"R90", "R90.1", "R90.2", "R90.3", "R90.4", "R90.5", "R90.6", "R90.7", "R90.8", "R90.89", 
"Z03.3", "Z13.85", "Z13.858", "Z82.0", 
"Z86.6", "Z86.61", "Z86.62", "Z86.63", "Z86.64", "Z86.65", "Z86.66", "Z86.67", "Z86.68", "Z86.69")
icd10_vector <- paste(icd10_vector,collapse="|")
icd9_vector <- c(
  "290", "290.0", "290.1", "290.2", "290.3", "290.4", "290.5", "290.6", "290.7", "290.8", "290.9",
  "294.0", "294.1", "294.2", "294.3", "294.4", "294.5", "294.6", "294.7", "294.8", "294.9",
  "307.8", "307.81", "307.82", "307.83", "307.84", "307.85", "307.86", "307.87", "307.88", "307.89",
  "315", "315.0", "315.1", "315.2", "315.3", "315.4", "315.5", "315.6", "315.7", "315.8", "315.9",
  "330", "330.0", "330.1", "330.2", "330.3", "330.4", "330.5", "330.6", "330.7", "330.8", "330.9",
  "331", "331.0", "331.1", "331.2", "331.3", "331.4", "331.5", "331.6", "331.7", "331.8", "331.82", "331.9",
  "332", "332.0",
  "333", "333.0", "333.1", "333.2", "333.3", "333.4", "333.5", "333.6", "333.7", "333.8", "333.9", "333.91", "333.93",
  "334", "334.0", "334.1", "334.2", "334.3", "334.4", "334.5", "334.6", "334.7", "334.8", "334.9",
  "335", "335.0", "335.1", "335.2", "335.3", "335.4", "335.5", "335.6", "335.7", "335.8", "335.9",
  "336", "336.0", "336.1", "336.2", "336.3", "336.4", "336.5", "336.6", "336.7", "336.8", "336.9",
  "337", "337.0", "337.1", "337.2", "337.3", "337.4", "337.5", "337.6", "337.7", "337.8", "337.9",
  "340", "340.0", "340.1", "340.2", "340.3", "340.4", "340.5", "340.6", "340.7", "340.8", "340.9",
  "341", "341.0", "341.1", "341.2", "341.3", "341.4", "341.5", "341.6", "341.7", "341.8", "341.9",
  "345", "345.0", "345.1", "345.2", "345.3", "345.4", "345.5", "345.6", "345.7", "345.8", "345.9",
  "346", "346.0", "346.1", "346.2", "346.3", "346.4", "346.5", "346.6", "346.7", "346.8", "346.9", "346.90", "346.91", "346.92", "346.93",
  "348", "348.0", "348.1", "348.2", "348.3", "348.4", "348.5", "348.6", "348.7", "348.8", "348.9",
  "349", "349.0", "349.1", "349.2", "349.3", "349.4", "349.5", "349.6", "349.7", "349.8",
  "350", "350.0", "350.1", "350.2", "350.3", "350.4", "350.5", "350.6", "350.7", "350.8", "350.9",
  "351", "351.0", "351.1", "351.2", "351.3", "351.4", "351.5", "351.6", "351.7", "351.8", "351.9",
  "352", "352.0", "352.1", "352.2", "352.3", "352.4", "352.5", "352.6", "352.7", "352.8", "352.9",
  "353", "353.0", "353.1", "353.2", "353.3", "353.4", "353.5", "353.6", "353.7", "353.8", "353.9",
  "354", "354.0", "354.1", "354.2", "354.3", "354.4", "354.5", "354.6", "354.7", "354.8", "354.9",
  "355", "355.0", "355.1", "355.2", "355.3", "355.4", "355.5", "355.6", "355.7", "355.8", "355.9",
  "356", "356.0", "356.1", "356.2", "356.3", "356.4", "356.5", "356.6", "356.7", "356.8", "356.9",
  "357", "357.0", "357.1", "357.3", "357.4", "357.5", "357.7",
  "358", "358.0", "358.1", "358.2", "358.3", "358.4", "358.5", "358.6", "358.7", "358.8", "358.9",
  "359", "359.0", "359.1", "359.2", "359.21", "359.22", "359.23", "359.29", "359.3", "359.4", "359.5", "359.6", "359.7", "359.8", "359.9",
  "710.3", "710.4",
  "725", "725.0", "725.1", "725.2", "725.3", "725.4", "725.5", "725.6", "725.7", "725.8", "725.9",
  "728", "728.0", "728.1", "728.2", "728.3", "728.4", "728.5", "728.6", "728.7", "728.8", "728.81", "728.82", "728.83", "728.84", "728.85", "728.87", "728.88", "728.89",
  "775.2",
  "780.3", "780.31", "780.32", "780.33", "780.34", "780.35", "780.36", "780.37", "780.38", "780.39", "780.4", "780.5", "780.50", "780.51", "780.52", "780.53", "780.54", "780.55", "780.56", "780.57", "780.58", "780.59",
  "780.7", "780.71", "780.72",
  "780.96",
  "781", "781.0", "781.1", "781.2", "781.3", "781.4", "781.5", "781.6", "781.7", "781.8", "781.9", "781.91", "781.92", "781.93", "781.94", "781.95", "781.96", "781.97", "781.98", "781.99",
  "793.0",
  "799.3", "799.4", "799.5", "799.6", "799.7",
  "V17.2",
  "V58.72"
)
icd9_vector <- paste(icd9_vector,collapse="|")
# Look for ICD 10 prevalence
full_icd10_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD10CM" | full_icd_df$source_vocabulary == "ICD10PCS",]
individuals <- c()
matching_rows <- full_icd10_df[grep(icd10_vector,full_icd10_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(individuals)
# Look for ICD 9 prevalence
full_icd9_df <- full_icd_df[full_icd_df$source_vocabulary == "ICD9CM",]
matching_rows <- full_icd9_df[grep(icd9_vector,full_icd9_df$source_concept_code),]
individuals <- append(individuals,unique(matching_rows$person_id))
length(unique(individuals))
paste0("Cohort specific cases: ",nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,]))
paste0("Cohort specific prev: ",(nrow(final_aou_data_complete[final_aou_data_complete$id %in% individuals,])/nrow(final_aou_data_complete))*100 )
aou_individuals <- final_aou_data_complete[final_aou_data_complete$id %in% individuals,]$id
weighted_case_df <- data.frame(id = aou_individuals,case=1)
weighted_control_df <- data.frame(id = setdiff(final_aou_data_complete$id,aou_individuals),case=0)
weighted_prev_df <- rbind(weighted_case_df,weighted_control_df)
weighted_prev_df <- left_join(weighted_prev_df,aou_weights_int_propensity,by="id")
paste0("Weighted cohort specific cases: ",sum(weighted_prev_df[weighted_prev_df$case==1,]$weight))
paste0("Weighted cohort specific prevalence: ",(sum(weighted_prev_df[weighted_prev_df$case==1,]$weight)/sum(weighted_prev_df$weight))*100)

# Graphing
# Read in data
prevalence_df <- read_csv("/home/jupyter/workspaces/allofusweightingstudy/Prevalence for AoU.csv")
head(prevalence_df)
library(tidyr)
library(dplyr)
library(ggplot2)
prevalence_df$`AoU CPM` <-  prevalence_df$`AoU CPM` / 10000
prevalence_df$`wAoU CPM` <-  prevalence_df$`wAoU CPM` / 10000
prevalence_df$`US CPM` <-  prevalence_df$`US CPM` / 10000
# Transpose the data
colnames(prevalence_df)[c(5,6,7)] <- c("Unweighted","Weighted","US")
prevalence_df_long <- prevalence_df[,c(1,5,6,7)] %>%
                        pivot_longer(cols=-Disease,
                                     names_to = "Source",
                                     values_to = "Value")
head(prevalence_df_long)
colnames(prevalence_df_long)[2] <- "Prevalence Estimate Source"
prev_plot <- ggplot(data=prevalence_df_long,aes(x=Disease,y=Value,color=`Prevalence Estimate Source`,shape=`Prevalence Estimate Source`)) +
                geom_point(size=4,position=position_jitter(0)) +
                coord_flip() +
#                 geom_hline(yintercept=0, linetype='dotted', col = 'red') +
                xlab("") + ylab("Prevalence (%)") + 
#                 scale_y_continuous(limits=c(-12.5,30)) +
                theme_classic(base_size=24) +
                scale_shape_manual(values=c(8,19,19),breaks=c("US","Unweighted","Weighted"),labels=c("US 2019 Global Burden of Disease Study","All of Us Unweighted","All of Us Weighted")) +
                #scale_color_discrete(breaks=c("Full","Male","Female")) +
                scale_color_manual(values=c("darkgreen","darkblue","darkorange"),breaks=c("US","Unweighted","Weighted"),labels=c("US 2019 Global Burden of Disease Study","All of Us Unweighted","All of Us Weighted")) +
                theme(legend.position = "top") + theme(legend.text=element_text(hjust=0.5),legend.position = "top",legend.title=element_blank(),legend.direction="vertical",legend.text.align = 0)

prev_plot

ggsave("/home/jupyter/workspaces/allofusweightingstudy/figures/final/f2_r1_c1.jpg",prev_plot,width=13.6,height=10,unit="in",dpi=600)
